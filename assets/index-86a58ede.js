import{M as le}from"./Modal-19eb68c4.js";import{B as ne}from"./index-441935dc.js";import{T as oe}from"./index-31d1a8ca.js";import{I as re}from"./index-72ee420c.js";import{C as ie}from"./index-8994827d.js";import{g as de,_ as ce,a as ue}from"./index-e058a960.js";import{l as me,a as _e,n as fe,r as ve,u as be}from"./tabs-aa384b53.js";import{aA as c,be as k,al as xe,aF as y,as as d,o as f,m as M,bj as p,p as l,x as r,F as z,aD as U,ac as pe,aT as T,n as P}from"./preload-helper-9e0646ca.js";const ye={name:"ModalOrganizeIn",components:{Modal:le,Button:ne,Icon:re,TabGroup:me,TabList:_e,Tab:fe,TabPanels:ve,TabPanel:be,Checkbox:ie,TextInput:oe},props:["tabIndex","title","isOpen","organizeList","userList","customList","email","attnInsideUser","attnInsideOrg"],computed:{isMobile(){return de().isMobile}},setup(m,{emit:n,expose:F}){const s=c([]),L=c([]),V=c([]),I=c(""),O=c(m.title||""),g=c(m.isOpen||!1),x=c(m.organizeList||[]),_=c(m.customList||[]),b=c(m.userList||[]),u=c([]),h=c([]),A=c({}),E=c(m.email===void 0||m.email),t=c([{title:"หน่วยงานภายใน"},{title:"บุคคล"},{title:"กำหนดเอง"}]),v=c(0),o=c(m.tabIndex);let C=c([]),w=c([]);const S=c(""),j=c({});k(()=>m.attnInsideOrg,e=>{w.value=e||[]}),k(()=>m.attnInsideUser,e=>{C.value=e||[]}),k(()=>m.tabIndex,e=>{o.value=e||""}),k(()=>m.title,e=>{O.value=e||""}),k(()=>m.isOpen,e=>{g.value=e||!1}),k(()=>m.organizeList,e=>{x.value=e,s.value=e}),k(()=>m.userList,e=>{b.value=e,L.value=e}),k(()=>m.customList,e=>{_.value=e,V.value=e}),xe(async()=>{o.value=0});const N=e=>{o.value=e,e!=2&&(h.value=[]),I.value=""},D=e=>{e.data_type=="users"?B(e):G(e)},R=e=>{const a=u.value.find(i=>i.data_id===e.id&&i.data_type=="users");a?B(a):q(e)},q=e=>{C.value.push(e),u.value.push({icon:"mingcute:user-4-fill",data_id:e.id,name:e.full_name,email:e.email,data_type:"users"}),C.value.sort((a,i)=>a-i)},B=e=>{C.value=C.value.filter(i=>i.id!=e.data_id);let a=u.value.findIndex(i=>i.data_id===e.data_id&&i.data_type==="users");a!==-1&&u.value.splice(a,1)},H=e=>{const a=u.value.find(i=>i.data_id===e.id&&i.data_type=="organizations");a?G(a):J(e)},J=e=>{w.value.push(e),E.value?u.value.push({icon:"grommet-icons:tree",data_id:e.id,name:(e==null?void 0:e.level1_name)==null?e==null?void 0:e.organization_name:(e==null?void 0:e.organization_name)+" ("+(e==null?void 0:e.level1_name)+")",emails:e.organization_emails.map(a=>({email:a.email})),email:"",data_type:"organizations"}):u.value.push({icon:"grommet-icons:tree",data_id:e.id,name:(e==null?void 0:e.level1_name)==null?e==null?void 0:e.organization_name:(e==null?void 0:e.organization_name)+" ("+(e==null?void 0:e.level1_name)+")",emails:e.emails.map(a=>({email:a.email})),email:"",data_type:"organizations"}),w.value.sort((a,i)=>a-i)},G=e=>{w.value=w.value.filter(i=>i.id!=e.data_id);let a=u.value.findIndex(i=>i.data_id===e.data_id&&i.data_type==="organizations");a!==-1&&u.value.splice(a,1)},K=e=>{},Q=(e,a)=>{a?X(e):W(e)},W=e=>{h.value=h.value.filter(a=>a.id!=e.id)},X=e=>{e.group_data.forEach(a=>{h.value.push({id:e.id,icon:a.icon,data_id:a.id,name:a.name,emails:a.emails?a.emails:[],email:a.email?a.email:"",data_type:a.data_type})})},Y=e=>!!w.value.find(i=>i.id===e.id),Z=e=>!!C.value.find(i=>i.id===e.id),$=async()=>{j.value={name:S.value,group_data:u.value};const{data:e,status:a}=await ue("customGroupStore","store",{payload:j.value});a==200&&_.value.push(e.result)},ee=()=>{S.value="",w.value=[],C.value=[],u.value=[],g.value=!1},te=()=>{if(console.log("tab",o.value),o.value==0){x.value=s.value;const e=x.value.filter(a=>a.organization_name.includes(I.value));x.value=e}else if(o.value===1){console.log("test",b.value),b.value=L.value;const e=b.value.filter(a=>a.full_name.includes(I.value));console.log("test2",e),b.value=e,console.log("user",b.value)}else if(o.value===2){_.value=V.value;const e=_.value.filter(a=>a.name.includes(I.value));_.value=e}},se=async()=>{n("event:accept",u.value=[...u.value,...h.value]),h.value=[]},ae=()=>{ee(),n("event:close")};return F({removeItemGroupArray:D}),k(()=>I.value,e=>{e==""&&(b.value=L.value,_.value=V.value,x.value=s.value)}),{title:O,isOpen:g,search:I,buttons:t,selected:v,organizeList:x,userList:b,customList:_,organizations:w,groupItems:j,group_name:S,selectedTab:o,groupArray:u,users:C,customArray:h,onSearch:te,changeTab:N,selectedItems:H,removeItem:G,selectedItemUser:R,removeItemUser:B,checkedItem:Y,onSave:$,onAcceptSwitch:se,closeModal:ae,removeItemGroupArray:D,checkedItemUser:Z,checkedItemCustom:K,selectedItemsCustom:Q,objectTest:A}}},ge={class:"min-h-[200px]"},he={class:"flex overflow-scroll"},ke={class:"basis-2/3 border-r"},Ie={key:0,class:"basis-1/3"},Ce=l("div",{class:"text-center border-b",style:{"margin-top":"6px"}}," หน่วยงาน/บุคคล ที่เลือก ",-1),we=[Ce],Te={class:"flex md:flex-nowrap flex-wrap"},ze={class:"md:basis-2/3 basis-full md:border-r border-r-0 py-3"},Ue={class:"md:basis-1/3 basis-full py-3"},Ve={key:0,class:"border-b mb-3",style:{"margin-top":"6px"}},Me={class:"md:pl-3 pl-0"},Le={class:"flex text-sm"},Oe={class:"ell-1 px-2"},Ae={class:"border-2 p-2 rounded flex items-center gap-2"},Ee={class:"basis-4/5"},Se={class:"basis-1/5"},je={class:"flex md:flex-nowrap flex-wrap"},Be={class:"basis-full md:basis-2/3 border-r py-3"},Ge={class:"flex justify-between items-center"},Pe={class:"flex items-center gap-3"},Fe={class:"text-2xl"},De={class:"text-slate-900 dark:text-slate-200"},Ne={class:"flex justify-between items-center"},Re={class:"flex items-center gap-3"},qe={class:"text-2xl"},He={class:"text-slate-900 dark:text-slate-200"},Je={class:"basis-full md:basis-1/3 py-3"},Ke={class:"md:pl-3 pl-0"},Qe={class:"flex text-sm"},We={class:"ell-1 px-2"},Xe={class:"border-2 p-2 rounded flex items-center gap-2"},Ye={class:"basis-4/5"},Ze={class:"basis-1/5"},$e={class:"flex md:flex-nowrap flex-wrap"},et={class:"basis-full md:basis-2/3 border-r py-3"},tt={class:"basis-full md:basis-1/3 py-3"},st={class:"md:pl-3 pl-0"},at={class:"flex text-sm"},lt={class:"ell-1 px-2"},nt={class:"text-center my-4 flex justify-center w-full"};function ot(m,n,F,s,L,V){const I=y("Tab"),O=y("TabList"),g=y("TextInput"),x=y("Checkbox"),_=y("Icon"),b=y("Button"),u=y("TabPanel"),h=y("TabPanels"),A=y("TabGroup"),E=y("Modal");return d(),f("div",null,[s.isOpen?(d(),M(E,{key:0,title:s.title,label:"",labelClass:"btn-outline-dark",sizeClass:"lg:w-3/5 md:w-4/5 sm:w-4/5 w-full",centered:"",ref:"modalDialog",activeModal:s.isOpen,"onEvent:closeModal":n[12]||(n[12]=t=>s.closeModal())},{footer:p(()=>[l("div",nt,[r(b,{text:"ยืนยัน",btnClass:"btn-primary w-32 mx-2",onOnClick:n[10]||(n[10]=t=>s.onAcceptSwitch())}),r(b,{text:"ยกเลิก",btnClass:"btn-outline-dark w-32 mx-2",onOnClick:n[11]||(n[11]=t=>s.closeModal())})])]),default:p(()=>[l("div",ge,[r(A,{selectedIndex:s.selectedTab,onChange:s.changeTab},{default:p(()=>[l("div",he,[l("div",ke,[r(O,{class:"flex border-b"},{default:p(()=>[(d(!0),f(z,null,U(s.buttons,(t,v)=>(d(),M(I,{as:"template",key:v,class:"px-3"},{default:p(({selected:o})=>[l("button",{class:pe([[o?"text-primary-500 before:w-full border-b-2 pb-1 border-primary-500":"text-slate-500 before:w-0 dark:text-slate-300"],"w-[150px]"])},T(t.title),3)]),_:2},1024))),128))]),_:1})]),V.isMobile?P("",!0):(d(),f("div",Ie,we))]),r(h,null,{default:p(()=>[r(u,null,{default:p(()=>[l("div",Te,[l("div",ze,[r(g,{type:"text",classInput:"border border-gray-300 w-full mt-3 w-[375px]",keyupEnter:"",modelValue:s.search,"onUpdate:modelValue":n[0]||(n[0]=t=>s.search=t),placeholder:"พิมพ์ชื่อหน่วยงานแล้วกดปุ่ม Enter","onEvent:enter":n[1]||(n[1]=t=>s.onSearch())},null,8,["modelValue"]),(d(!0),f(z,null,U(s.organizeList,(t,v)=>(d(),f("div",{class:"text-slate-600 dark:text-slate-400 text-sm font-normal my-2",key:v},[s.checkedItem(t)?(d(),M(x,{key:0,checked:"",label:(t==null?void 0:t.level1_name)==null?t==null?void 0:t.organization_name:(t==null?void 0:t.organization_name)+" ("+(t==null?void 0:t.level1_name)+")",activeClass:"bg-primary-500",onClick:o=>s.selectedItems(t)},null,8,["label","onClick"])):(d(),M(x,{key:1,label:(t==null?void 0:t.level1_name)==null?t==null?void 0:t.organization_name:(t==null?void 0:t.organization_name)+" ("+(t==null?void 0:t.level1_name)+")",activeClass:"bg-primary-500",onClick:o=>s.selectedItems(t)},null,8,["label","onClick"]))]))),128))]),l("div",Ue,[V.isMobile?(d(),f("div",Ve," หน่วยงาน/บุคคล ที่เลือก ")):P("",!0),l("div",Me,[(d(!0),f(z,null,U(s.groupArray,(t,v)=>(d(),f("div",{key:v,class:"flex justify-between items-center border bg-gray-100 p-2 my-3 rounded"},[l("div",Le,[r(_,{icon:t.icon},null,8,["icon"]),l("div",Oe,T(t.name),1)]),r(_,{onClick:o=>s.removeItemGroupArray(t),icon:"fa6-solid:trash-can",class:"text-red-500"},null,8,["onClick"])]))),128)),l("div",Ae,[l("div",Ee,[r(g,{placeholder:"บันทึกรายการที่เลือกไว้ใช้เอง",class:"w-full",modelValue:s.group_name,"onUpdate:modelValue":n[2]||(n[2]=t=>s.group_name=t)},null,8,["modelValue"])]),l("div",Se,[r(b,{text:"บันทึก",btnClass:"btn-primary w-full h-[40px] flex items-center",onOnClick:n[3]||(n[3]=t=>s.onSave())})])])])])])]),_:1}),r(u,null,{default:p(()=>[l("div",je,[l("div",Be,[r(g,{type:"text",classInput:"border border-gray-300 w-full mt-3 w-[375px]",keyupEnter:"",modelValue:s.search,"onUpdate:modelValue":n[4]||(n[4]=t=>s.search=t),placeholder:"พิมพ์ชื่อบุคคลแล้วกดปุ่ม Enter","onEvent:enter":n[5]||(n[5]=t=>s.onSearch())},null,8,["modelValue"]),(d(!0),f(z,null,U(s.userList,(t,v)=>(d(),f("div",{class:"text-slate-600 dark:text-slate-400 text-sm font-normal my-2",key:v},[s.checkedItemUser(t)?(d(),M(x,{key:0,checked:"",activeClass:"bg-primary-500",onClick:o=>s.selectedItemUser(t)},{default:p(()=>{var o;return[l("div",Ge,[l("div",Pe,[l("div",Fe,[r(_,{icon:"mingcute:user-4-fill"})]),l("div",null,[l("div",De,T(t.full_name),1),l("div",null,T((o=t.organization)==null?void 0:o.organization_name),1)])])])]}),_:2},1032,["onClick"])):(d(),M(x,{key:1,activeClass:"bg-primary-500",onClick:o=>s.selectedItemUser(t)},{default:p(()=>{var o;return[l("div",Ne,[l("div",Re,[l("div",qe,[r(_,{icon:"mingcute:user-4-fill"})]),l("div",null,[l("div",He,T(t.full_name),1),l("div",null,T((o=t.organization)==null?void 0:o.organization_name),1)])])])]}),_:2},1032,["onClick"]))]))),128))]),l("div",Je,[l("div",Ke,[(d(!0),f(z,null,U(s.groupArray,(t,v)=>(d(),f("div",{key:v,class:"flex justify-between items-center border bg-gray-100 p-2 my-3 rounded"},[l("div",Qe,[r(_,{icon:t.icon},null,8,["icon"]),l("div",We,T(t.name),1)]),r(_,{onClick:o=>s.removeItemGroupArray(t),icon:"fa6-solid:trash-can",class:"text-red-500"},null,8,["onClick"])]))),128)),l("div",Xe,[l("div",Ye,[r(g,{placeholder:"บันทึกรายการที่เลือกไว้ใช้เอง",class:"w-full",modelValue:s.group_name,"onUpdate:modelValue":n[6]||(n[6]=t=>s.group_name=t)},null,8,["modelValue"])]),l("div",Ze,[r(b,{text:"บันทึก",btnClass:"btn-primary w-full h-[40px] flex items-center",onOnClick:n[7]||(n[7]=t=>s.onSave())})])])])])])]),_:1}),r(u,null,{default:p(()=>[l("div",$e,[l("div",et,[r(g,{type:"text",classInput:"border border-gray-300 w-full mt-3 w-[375px]",keyupEnter:"",modelValue:s.search,"onUpdate:modelValue":n[8]||(n[8]=t=>s.search=t),placeholder:"พิมพ์ชื่อกำหนดเองแล้วกดปุ่ม Enter","onEvent:enter":n[9]||(n[9]=t=>s.onSearch())},null,8,["modelValue"]),(d(!0),f(z,null,U(s.customList,(t,v)=>(d(),f("div",{class:"flex justify-between text-slate-600 dark:text-slate-400 text-sm font-normal my-2",key:v},[r(x,{label:t.name,activeClass:"bg-primary-500","onUpdate:modelValue":o=>s.selectedItemsCustom(t,o)},null,8,["label","onUpdate:modelValue"]),r(_,{icon:"fa6-solid:trash-can",class:"text-red-500 px-4"})]))),128))]),l("div",tt,[l("div",st,[(d(!0),f(z,null,U(s.customArray,(t,v)=>(d(),f("div",{key:v,class:"flex justify-between items-center border bg-gray-100 p-2 my-3 rounded"},[l("div",at,[r(_,{icon:t.icon},null,8,["icon"]),l("div",lt,T(t.name),1)])]))),128))])])])]),_:1})]),_:1})]),_:1},8,["selectedIndex","onChange"])])]),_:1},8,["title","activeModal"])):P("",!0)])}const vt=ce(ye,[["render",ot]]);export{vt as M};
