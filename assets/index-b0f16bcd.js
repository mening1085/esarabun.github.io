import{M as A}from"./Modal-19eb68c4.js";import{R as H}from"./index-3069c0b6.js";import{u as J,a as E}from"./vee-validate.esm-0c282d04.js";import{c as K,a as B}from"./array-e684e252.js";import{aA as u,k as F,be as N,aF as l,as as i,o as r,m as S,bj as m,p as t,x as a,n as j,F as Q,aD as W,ac as X,aT as z,bo as Y}from"./preload-helper-9e0646ca.js";import{B as Z}from"./index-441935dc.js";import{T as $}from"./TextValid-100be459.js";import{T as ee}from"./index-ce9a51c5.js";import{T as te}from"./index-31d1a8ca.js";import{P as se}from"./index-3e810d59.js";import{B as ae,_ as oe,g as ne,c as v,t as le}from"./index-e058a960.js";import{I as ie}from"./index-72ee420c.js";import{l as re,a as ce,n as de,r as ue,u as me}from"./tabs-aa384b53.js";const _e={components:{Modal:A,Radio:H,Button:Z,TextValid:$,Textarea:ee,Textinput:te,PinInput:se,TabGroup:re,TabList:ce,Tab:de,TabPanels:ue,TabPanel:me,VueSignaturePad:ae,Icon:ie},props:{isOpen:{type:Boolean,default:!1},item:{type:Object,default:()=>{}}},emits:["event:close","event:submit"],setup(L,{emit:c}){const h=u(le),e=u(!1),y=u(!1),x=u(null),V=u([{title:"ใบรับรองอิเล็กทรอนิกส์"},{title:"วาดลายมือชื่อ"}]),_=u(0),P=u(""),T=K({position:B().required().nullable(),signature:B().required("กรุณาใส่ลายเซ็น"),pincode:B().required("กรุณากรอกรหัส PIN Code ของใบอนุญาติอิเล็กทรอนิกส์")}),{handleSubmit:p,resetForm:U}=J({validationSchema:T}),{value:f,errorMessage:w}=E("position"),{value:n,errorMessage:I}=E("signature"),{value:d,errorMessage:C}=E("pincode"),M=F(()=>ne().isMobile),k=F(()=>{var s,o;return f.value=(o=(s=v().userInfo)==null?void 0:s.organization)==null?void 0:o.organization_name,v().userInfo}),b=F(()=>{var s;return(s=v().userInfo)==null?void 0:s.signature_path});N(()=>C.value,s=>{P.value=s}),N(()=>_.value,s=>{var o;s==0&&(n.value=(o=v().userInfo)==null?void 0:o.signature_path)},{immediate:!0});const g=()=>{x.value.undoSignature()},O=()=>{y.value=!0,setTimeout(()=>{const{isEmpty:s,data:o}=x.value.saveSignature();n.value=o,y.value=!1},1e3)},q=()=>{n.value="",x.value.clearSignature()},G=s=>{var o;_.value=s,n.value="",s==0&&(n.value=(o=v().userInfo)==null?void 0:o.signature_path),console.log("tabtab",s)},D=s=>{console.log("updatePin",s),d.value=s},R=p(async s=>{const o={pincode:d.value,position:f.value,signature:n.value};console.log("payload",o),c("event:submit",o)});return{imageUrl:h,userInfo:k,tabMenu:V,selected:_,signaturePad:x,saveSignature:y,clearPin:e,position:f,positionError:w,signature:n,signatureError:I,pincode:d,pincodeError:C,pinError:P,isMobile:M,submitModal:R,updatePin:D,signaturePathImage:b,changeTab:G,save:O,undo:g,remove:q,onClose:()=>{var s;n.value=(s=v().userInfo)==null?void 0:s.signature_path,d.value="",e.value=!0,_.value=0,c("event:close")}}}},pe={class:"md:px-24"},be={key:0},ve=t("div",{class:"text-gray-500 text-[16px]"},"ตำแหน่ง",-1),xe={class:"mt-6"},fe={key:0,class:"text-gray-500 text-[16px] mb-2"},ge={key:1,class:"text-gray-500 text-[20px] mb-2"},he={class:"flex items-center gap-3"},ye=["src"],Pe=t("div",{class:"text-gray-500 text-[12px]"}," วาดลายมือชื่อ (ภาษาไทย) ",-1),Te={class:"text-slate-600 text-sm font-normal"},Ie={class:"border-2"},Ce={class:"container p-2 space-y-2"},Me={class:"flex justify-between items-center gap-3"},ke=t("div",{class:"md:text-[12px] text-[12px]"}," วาดลายมือชื่อ ",-1),Se={class:"flex gap-2"},Ve={class:"p-2 h-[200px]"},we={class:"text-[16px] basis-1/4"},Ee={class:"mt-3 md:flex md:gap-10 md:mt-10"},Be=t("div",{class:"text-gray-500 text-[16px] md:basis-1/4 md:text-start"}," รหัส PIN Code ",-1),Fe={key:0,class:"basis-3/4 mb-5"},je={class:""},ze={key:1},Ue={class:""},Ne={key:1,class:"space-y-5 px-32"},Le={class:"flex space-x-5"},Oe=t("div",{class:"text-end basis-1/3 font-bold"},"ผู้ลงนาม:",-1),qe={class:"basis-2/3 justify-start"},Ge={class:"flex space-x-5"},De=t("div",{class:"text-end basis-1/3 font-bold"},"ตำแหน่ง:",-1),Re={class:"basis-2/3 justify-start"},Ae=t("hr",{class:"my-5"},null,-1),He={class:"flex justify-center w-full mt-6"};function Je(L,c,h,e,y,x){const V=l("Textinput"),_=l("Tab"),P=l("TabList"),T=l("TabPanel"),p=l("Icon"),U=l("VueSignaturePad"),f=l("TabPanels"),w=l("TabGroup"),n=l("TextValid"),I=l("PinInput"),d=l("Button"),C=l("Modal");return i(),r("div",null,[h.isOpen?(i(),S(C,{key:0,title:"ลงนามเอกสารอิเล็กทรอนิกส์",activeModal:h.isOpen,"onEvent:closeModal":e.onClose,label:"",labelClass:"btn-outline-dark",sizeClass:"w-full md:w-2/5",centered:""},{default:m(()=>{var M,k;return[t("form",{onSubmit:c[1]||(c[1]=Y((...b)=>e.submitModal&&e.submitModal(...b),["prevent"])),class:"-m-3 modal__submit-order"},[t("div",pe,[e.isMobile?(i(),r("div",be,[ve,a(V,{modelValue:(k=(M=e.userInfo)==null?void 0:M.organization)==null?void 0:k.organization_name,classInput:"border border-gray-400",disabled:""},null,8,["modelValue"])])):j("",!0),t("div",xe,[e.isMobile?(i(),r("div",fe," ลงนามคำสั่งการ ")):(i(),r("div",ge," ลงนามในหนังสือ ")),a(w,{selectedIndex:e.selected,onChange:e.changeTab},{default:m(()=>[a(P,{class:"flex"},{default:m(()=>[(i(!0),r(Q,null,W(e.tabMenu,(b,g)=>(i(),S(_,{as:"template",disabled:!e.signaturePathImage&&g==0,key:g,class:"basis-1/2"},{default:m(()=>[t("button",{class:X([[e.selected==g?"text-primary-500 before:w-full border-b-2 border-primary-500":"text-slate-500 before:w-0 dark:text-slate-300 border-b-2 border-gray-200"],"text-sm font-medium mb-2 capitalize bg-gray-200 py-2"])},z(b.title),3)]),_:2},1032,["disabled"]))),128))]),_:1}),a(f,null,{default:m(()=>[a(T,null,{default:m(()=>[t("div",he,[t("img",{src:e.imageUrl+e.signaturePathImage,class:"h-[80px] w-[150px] object-cover border"},null,8,ye),Pe])]),_:1}),a(T,null,{default:m(()=>[t("div",Te,[t("div",Ie,[t("div",Ce,[t("div",Me,[ke,t("div",Se,[e.saveSignature?(i(),S(p,{key:0,icon:"eos-icons:bubble-loading",class:"text-green-500 text-2xl animate-spin"})):(i(),S(p,{key:1,icon:"material-symbols:save",class:"text-green-500 text-2xl",onClick:e.save},null,8,["onClick"])),a(p,{icon:"dashicons:undo",class:"text-gray-500 text-2xl border-l pl-2",onClick:e.undo},null,8,["onClick"]),a(p,{icon:"material-symbols:delete",class:"text-red-500 text-2xl",onClick:e.remove},null,8,["onClick"])])]),t("div",Ve,[a(U,{id:"signature",ref:"signaturePad"},null,512)])])])])]),_:1})]),_:1})]),_:1},8,["selectedIndex","onChange"]),t("div",we,[a(n,{valid:e.signatureError},null,8,["valid"])])]),t("div",Ee,[Be,e.isMobile?(i(),r("div",ze,[a(I,{classInput:"border border-gray-400",placeholder:"กรอกรหัส Pin Code","onUpdate:modelValue":e.updatePin,clearForm:e.clearPin},null,8,["onUpdate:modelValue","clearForm"]),t("div",Ue,[a(n,{valid:e.pinError},null,8,["valid"])])])):(i(),r("div",Fe,[a(I,{classInput:"border border-gray-400",placeholder:"กรอกรหัส Pin Code","onUpdate:modelValue":e.updatePin,clearForm:e.clearPin},null,8,["onUpdate:modelValue","clearForm"]),t("div",je,[a(n,{valid:e.pinError},null,8,["valid"])])]))]),e.isMobile?j("",!0):(i(),r("div",Ne,[t("div",Le,[Oe,t("div",qe,z(e.userInfo.full_name),1)]),t("div",Ge,[De,t("div",Re,z(e.userInfo.position),1)])]))]),Ae,t("div",He,[a(d,{text:"บันทึก",type:"submit",btnClass:"btn-primary w-32 mx-2"}),a(d,{text:"ยกเลิก",btnClass:"btn-outline-dark w-32 mx-2",onClick:c[0]||(c[0]=b=>e.onClose())})])],32)]}),_:1},8,["activeModal","onEvent:closeModal"])):j("",!0)])}const it=oe(_e,[["render",Je]]);export{it as M};
