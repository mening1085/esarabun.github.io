import{D as Y,S as Z}from"./index-090a8953.js";import{C as A}from"./index-263882d1.js";import{I as L}from"./index-72ee420c.js";import{B as G}from"./index-441935dc.js";import{I as q}from"./index-a60d9262.js";import{P as Q}from"./index-bb139ada.js";import{V as $,C as ee}from"./VueSelect-4c8519b3.js";import{S as te}from"./index-a15147cf.js";import{M as H}from"./Modal-19eb68c4.js";import{T as J}from"./index-31d1a8ca.js";import{_ as K,a as v}from"./index-e058a960.js";import{C as se}from"./index-559355a7.js";import{C as N}from"./index-8994827d.js";import{I as ae}from"./index-2f433009.js";import{M as oe}from"./index-0fe0dceb.js";import{T as W}from"./index-9078ba5b.js";import{e as le}from"./vue3-tree-vue.esm-b89ac387.js";import{R as ne}from"./index-3069c0b6.js";import{E as ie}from"./index-1c6333b5.js";import{E as re}from"./index-97f1d9eb.js";import{N as X}from"./index-cc7a2b4b.js";import{aA as R,aF as n,as as c,o as m,x as o,bj as r,p as t,aT as w,w as p,n as h,F as U,aD as F,ac as ce,m as y}from"./preload-helper-9e0646ca.js";import{C as de}from"./index-3f3a6812.js";import{M as me}from"./index-7dc8252b.js";import{M as ue}from"./index-2a7f4259.js";import"./dom-891ac6c3.js";import"./focus-management-e6c5d1fd.js";import"./open-closed-486d85f0.js";import"./use-resolve-button-type-38f1f99a.js";import"./use-outside-click-a758fdce.js";import"./iconify-4e42c13d.js";import"./vue-cleave.min-9e1201c2.js";import"./index-7e9b1d19.js";import"./transition-39b574f4.js";import"./hidden-11a9ab9d.js";import"./micro-task-89dcd6af.js";import"./ck-white-7280cd79.js";import"./index-1b218db3.js";const pe={name:"adduser-role",components:{Image:ae,Card:A,Textinput:J,Checkbox:N,Pagination:Q,Button:G,Modal:H,Icon:L,ModalOrganize:oe,Tooltip:W,tree:le,InputGroup:q,Radio:ne,Checkbox:N,Expansion:ie,ExpansionTableRow:re,NavigationPath:X},props:{item:{type:Object,default:""}},emits:["event:close"],setup(){const l=R([{label:"รายละเอียดบทบาท(ส่วนผู้ใช้งาน)"},{label:"หนังสือลับ",thClass:"w-[100px] text-center"},{label:"ภายใน",thClass:"w-[80px] text-center"},{label:"ภายนอก",thClass:"w-[80px] text-center"},{label:"แสดง",thClass:"w-[80px] text-center"},{label:"เพิ่ม",thClass:"w-[80px] text-center"},{label:"แก้ไข",thClass:"w-[80px] text-center"},{label:"ลบ",thClass:"w-[80px] text-center"},{label:"ส่งออก",thClass:"w-[80px] text-center"},{label:"ลงนาม",thClass:"w-[80px] text-center"}]),e=R([{label:"รายละเอียดบทบาท(ส่วนผู้ใช้งาน)"},{label:"แสดง",thClass:"w-[120px] text-center"},{label:"เพิ่ม",thClass:"w-[80px] text-center"},{label:"แก้ไข",thClass:"w-[80px] text-center"},{label:"ส่งออก",thClass:"w-[80px] text-center"}]);return{column_user:l,column_admin:e}}},_e=t("div",{class:"flex-1 pb-8"},[t("span",{class:"block text-xl text-slate-900 font-medium dark:text-[#eee]"}," รายละเอียดบทบาท ")],-1),he={class:"bg-gray-100 py-3 px-3 sm:px-0"},ge={class:"flex flex-wrapp"},fe=t("div",{class:"sm:basis-1/3 basis-full font-semibold pr-4 flex sm:justify-end justify-start mb-1 sm:mb-0"}," อยู่ภายใต้หน่วยงาน ",-1),xe={class:"ell-11 truncate text-left pl-3"},be={class:"py-5 px-3 sm:px-0"},we={class:"flex flex-wrap"},ve=t("div",{class:"sm:basis-1/3 basis-full pr-4 font-semibold flex sm:justify-end justify-start mb-1 sm:mb-0"}," ชื่อบทบาท ",-1),ye={class:"sm:basis-1/3 basis-full"},Se={class:"bg-gray-100 py-5 px-3 sm:px-0"},Ce={class:"flex flex-wrap"},Me=t("div",{class:"sm:basis-1/3 basis-full pr-4 font-semibold flex sm:justify-end justify-start mb-1 sm:mb-0"}," การใช้งาน ",-1),De={class:"sm:basis-1/3 basis-full"},Ee={class:"w-full"},Ie={key:0,class:"flex items-center"},ke={key:1,class:"flex items-center"},ze={key:2,class:"flex items-center"},Ve={key:3,class:"flex items-center"},Te={key:4,class:"flex items-center"},Oe={key:5,class:"flex items-center"},Pe={class:"mt-6"},je={class:"table_expand"},Be=t("hr",{class:"mt-5 border"},null,-1),Ne={class:"text-center mt-10 flex justify-center mb-16"};function Re(l,e,i,S,s,d){const C=n("NavigationPath"),M=n("Tooltip"),f=n("Icon"),j=n("ExpansionTableRow"),B=n("Expansion"),D=n("Button"),E=n("Card");return c(),m("div",null,[o(E,null,{default:r(()=>{var x,I,k,z,V,T,O,P;return[_e,t("div",he,[t("div",ge,[fe,o(M,{placement:"top",arrow:"",theme:"light"},{base:r(()=>{var u,_;return[t("div",xe,[o(C,{arrayItems:(u=i.item)==null?void 0:u.parent_organization_list,targetId:(_=i.item)==null?void 0:_.data.organization_id,targetName:"organization_name",typePath:"organization"},null,8,["arrayItems","targetId"])])]}),default:r(()=>{var u,_;return[o(C,{arrayItems:(u=i.item)==null?void 0:u.parent_organization_list,targetId:(_=i.item)==null?void 0:_.data.organization_id,targetName:"organization_name",typePath:"organization"},null,8,["arrayItems","targetId"])]}),_:1})])]),t("div",be,[t("div",we,[ve,t("div",ye,w((x=i.item)==null?void 0:x.data.name),1)])]),t("div",Se,[t("div",Ce,[Me,t("div",De,[t("ul",Ee,[(I=i.item)!=null&&I.data.can_attach_file?(c(),m("li",Ie,[o(f,{class:"mr-1",icon:"radix-icons:dot-filled"}),p(" เลือกไฟล์ ")])):h("",!0),(k=i.item)!=null&&k.data.can_scan_file?(c(),m("li",ke,[o(f,{class:"mr-1",icon:"radix-icons:dot-filled"}),p("สแกนไฟล์ ")])):h("",!0),(z=i.item)!=null&&z.data.can_finish_job?(c(),m("li",ze,[o(f,{class:"mr-1",icon:"radix-icons:dot-filled"}),p("ปิดงาน ")])):h("",!0),(V=i.item)!=null&&V.data.can_pull_back?(c(),m("li",Ve,[o(f,{class:"mr-1",icon:"radix-icons:dot-filled"}),p("ดึงกลับ ")])):h("",!0),(T=i.item)!=null&&T.data.can_return?(c(),m("li",Te,[o(f,{class:"mr-1",icon:"radix-icons:dot-filled"}),p("คืนเรื่อง ")])):h("",!0),(O=i.item)!=null&&O.data.can_cancel?(c(),m("li",Oe,[o(f,{class:"mr-1",icon:"radix-icons:dot-filled"}),p("ยกเลิกหนังสือ ")])):h("",!0)])])])]),t("div",Pe,[o(B,{parentClass:"space-y-5",title:"รายละเอียดบทบาท (ส่วนผู้ใช้งาน)"},{default:r(()=>{var u,_;return[t("div",je,[t("table",null,[t("tr",null,[(c(!0),m(U,null,F((u=i.item)==null?void 0:u.menu_list_user,(b,a)=>(c(),m("th",{key:a,class:ce(b.thClass)},w(b.label),3))),128))]),(c(!0),m(U,null,F((_=i.item)==null?void 0:_.menu_list_user,b=>(c(),y(j,{key:b.id,showColumns:["secret","inside","outside","index","store","update","destroy","export","sign"],item:b,isView:""},null,8,["item"]))),128))])])]}),_:1})]),Be,t("div",Ne,[o(D,{link:"/app/user-role/role-management/edit/"+((P=i.item)==null?void 0:P.data.id),text:"แก้ไขบทบาท",btnClass:"btn-primary w-32 font-medium mx-2"},null,8,["link"]),o(D,{text:"ปิด",btnClass:"btn-outline-dark w-32 mx-2",onOnClick:e[0]||(e[0]=u=>l.$emit("event:close"))})])]}),_:1})])}const Ue=K(pe,[["render",Re]]);const Fe={components:{Tooltip:W,NavigationPath:X,Pagination:Q,InputGroup:q,Dropdown:Y,Icon:L,Button:G,Card:A,MenuItem:Z,VueSelect:$,vSelect:ee,Switch:te,Modal:H,Textinput:J,ChangeStatus:se,ConfirmDelete:de,ViewFormData:Ue,ModalSuccess:me,ModalError:ue},data(){return{modalId:null,modalStatus:!1,isSuccess:!1,isShowModalDetail:!1,dataDetail:{},isShowDialogSwitch:!1,isShowModalDelete:!1,isModalDeleteSuccess:!1,isModalDeleteError:!1,errorMessage:"",isModalSwitchError:!1,switchErrorMessage:"",paginate:{total:50,current_page:1,perpage:10,pageRange:5},searchTerm:"",organizeList:[],organization_id:"",keyword:"",actions:[{name:"view",icon:"heroicons-outline:eye"},{name:"edit",icon:"heroicons:pencil-square"},{name:"delete",icon:"heroicons-outline:trash"}],columns:[{label:"บทบาทผู้ใช้งาน",field:"name",width:"100px",tdClass:"text_left",thClass:"text_left"},{label:"จำนวนผู้ใช้งาน",field:"user_count",width:"100px",tdClass:"text_center",thClass:"text_center"},{label:"หน่วยงาน",field:"organization",width:"150px",tdClass:"text_left",thClass:"text_left"},{label:"สถานะการใช้งาน",field:"enabled",width:"100px",tdClass:"text_left",thClass:"text_left"},{label:"จัดการ",field:"action",width:"50px"}],advancedTable:[]}},watch:{password:{handler(){this.password&&(this.passwordError=0)}},organization_id:{handler(){this.organization_id||this.getData(1)}}},created(){this.getData(1)},methods:{async getData(l){var i;const e=await v("roleSettingStore","get",{payload:{page:l,organization_id:this.organization_id,keyword:this.keyword}});e.status===200&&(this.advancedTable=e.data.result.data,this.paginate.total=e.data.result.total_page*e.data.result.per_page,this.paginate.current_page=e.data.result.current_page,this.paginate.perpage=e.data.result.per_page,this.organizeList=(i=e.data.result)==null?void 0:i.organization_list.map(S=>({id:S.id,title:S.organization_name})))},onUpdateSwitch(l,e){this.isShowDialogSwitch=!0,this.modalId=l,this.modalStatus=e},async onAcceptSwitch(l){console.log("payload",l);const e=await v("roleSettingStore","sarabunRoleChangStatus",{payload:{id:l.id,status:l.status}});e.status==200?(this.clearModal(),setTimeout(()=>{this.isSuccess=!0},10)):(e.data.message=="ไม่สามารถเปลี่ยนแปลงสถานะบทบาทได้"?(this.isModalSwitchError=!0,this.switchErrorMessage=e.data.message,this.advancedTable=this.advancedTable.map(i=>(i.id===this.modalId&&(i.status=!!i.status),i))):this.passwordError=e.data.message,this.clearModal())},getOrganization(l){if(!l)return"";let e="";return l.parent_organization&&(e+=this.getOrganization(l.parent_organization)),e+(e?" > ":"")+l.organization_name},onCloseSwitch(){this.advancedTable=this.advancedTable.map(l=>(l.id===this.modalId&&(l.status=!!l.status),l)),this.clearModal()},async openModalDelete(l){this.isShowModalDelete=!0,this.modalId=l},async onDelete(l){this.isShowModalDelete=!1;const e=await v("roleSettingStore","delete",{payload:l});console.log("res",e),e.status==200?(this.isModalDeleteSuccess=!0,this.getData(1)):(console.log("error: ",e),this.isModalDeleteError=!0,this.errorMessage=e.data.message)},clearModal(){this.isShowDialogSwitch=!1,this.isShowModalDelete=!1,this.isModalDeleteSuccess=!1,this.isModalDeleteError=!1,this.errorMessage="",this.modalId=null},async changePage(l){this.paginate.current_page=l,await this.getData(l)},async showDetail(l){const e=await v("roleSettingStore","show",{payload:l});e.status===200&&(this.dataDetail=e.data.result,this.modalId=l,this.isShowModalDetail=!0)},async onCopy(l){(await v("roleSettingStore","copy",{payload:{id:l}})).status===200&&this.getData(1)}}},Ae={class:"role_managment"},Le={class:"flex gap-5 pt-4 px-4 pb-8"},Ge={class:"basis-1/2"},qe={class:"basis-1/2 flex gap-3"},Qe={class:"basis-1/2"},He={class:"basis-1/2"},Je=t("div",{class:"text-center"},[t("div",{class:"text-gray-400"},"ไม่พบข้อมูล")],-1),Ke={key:0},We={class:"w-full ell-1"},Xe={key:1},Ye={key:2},Ze={class:"w-full"},$e=["onClick"],et=["onClick"],tt=["onClick"],st={class:"py-4 px-3"},at=t("h4",{class:"text-lg text-slate-900"},[p(" เปิด/ปิดใช้งานบทบาทผู้ใช้งาน"),t("span",{class:"text-green-500"},"สำเร็จ")],-1),ot={class:"text-lg text-slate-900"},lt=t("h4",{class:"text-lg text-slate-900"},[p(" ลบข้อมูลบทบาท "),t("span",{class:"text-green-500"},"สำเร็จ")],-1),nt={class:"text-lg text-slate-900"};function it(l,e,i,S,s,d){const C=n("Button"),M=n("router-link"),f=n("vSelect"),j=n("VueSelect"),B=n("InputGroup"),D=n("Tooltip"),E=n("Switch"),x=n("Icon"),I=n("Dropdown"),k=n("Pagination"),z=n("vue-good-table"),V=n("Card"),T=n("ViewFormData"),O=n("Modal"),P=n("ChangeStatus"),u=n("ModalSuccess"),_=n("ModalError"),b=n("ConfirmDelete");return c(),m("div",Ae,[o(V,{noborder:""},{default:r(()=>[t("div",Le,[t("div",Ge,[o(M,{to:"role-management/create"},{default:r(()=>[o(C,{icon:"ic:baseline-plus",text:"เพิ่มบทบาทผู้ใช้งาน",btnClass:"btn-primary rounded-md"})]),_:1})]),t("div",qe,[t("div",Qe,[o(j,null,{default:r(()=>[o(f,{placeholder:"เลือกหน่วยงาน",modelValue:s.organization_id,"onUpdate:modelValue":e[0]||(e[0]=a=>s.organization_id=a),label:"title",class:"border rounded border-gray-400",reduce:a=>a.id,options:s.organizeList,"onOption:selected":e[1]||(e[1]=a=>d.getData(1))},null,8,["modelValue","reduce","options"])]),_:1})]),t("div",He,[o(B,{modelValue:s.keyword,"onUpdate:modelValue":e[2]||(e[2]=a=>s.keyword=a),placeholder:"Search",classInput:"h-[40px]  border-2 border-gray-200",type:"text",prependIcon:"heroicons-outline:search",merged:"",inputEnter:"","onEvent:inputEnter":e[3]||(e[3]=a=>d.getData(1))},null,8,["modelValue"])])])]),o(z,{columns:s.columns,styleClass:" vgt-table bordered centered",rows:s.advancedTable,"pagination-options":{enabled:!0,perPage:s.paginate.perpage},"search-options":{enabled:!0,externalQuery:s.searchTerm},"sort-options":{enabled:!1}},{emptystate:r(()=>[Je]),"table-row":r(a=>[a.column.field=="organization"?(c(),m("span",Ke,[o(D,null,{base:r(()=>[t("div",We,w(d.getOrganization(a.row.organization)),1)]),default:r(()=>[t("div",null,w(d.getOrganization(a.row.organization)),1)]),_:2},1024)])):h("",!0),a.column.field=="enabled"?(c(),m("span",Xe,[a.row.enabled?(c(),y(E,{key:0,label:"เปิดใช้งาน",activeClass:"bg-primary-500",active:!0,modelValue:a.row.enabled,"onUpdate:modelValue":g=>{a.row.enabled=g,s.modalId=a.row.id,d.onUpdateSwitch(a.row.id,g)}},null,8,["modelValue","onUpdate:modelValue"])):(c(),y(E,{key:1,label:"ปิดใช้งาน",activeClass:"bg-primary-500",active:!1,modelValue:a.row.enabled,"onUpdate:modelValue":g=>{a.row.enabled=g,s.modalId=a.row.id,d.onUpdateSwitch(a.row.id,g)}},null,8,["modelValue","onUpdate:modelValue"]))])):h("",!0),a.column.field=="action"?(c(),m("span",Ye,[o(I,{classMenuItems:"right-full  w-[220px] top-[110%] "},{menus:r(()=>[t("ul",Ze,[t("li",null,[o(M,{class:"p-2 flex items-center hover:bg-gray-50",to:`role-management/edit/${a.row.id}`},{default:r(()=>[o(x,{icon:"bx:edit",class:"text-xl mr-2"}),p(" แก้ไข ")]),_:2},1032,["to"])]),t("li",null,[t("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer",onClick:g=>d.showDetail(a.row.id)},[o(x,{icon:"grommet-icons:document-text",class:"text-xl mr-2"}),p(" ดูรายละเอียด ")],8,$e)]),t("li",null,[t("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer border-t",onClick:g=>d.onCopy(a.row.id)},[o(x,{icon:"tdesign:file-copy",class:"text-xl mr-2"}),p(" คัดลอกบทบาท ")],8,et)]),t("li",null,[t("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer border-t text-red-500",onClick:g=>d.openModalDelete(a.row.id)},[o(x,{icon:"material-symbols:delete",class:"text-xl mr-2"}),p(" ลบ ")],8,tt)])])]),default:r(()=>[o(x,{icon:"pepicons-pencil:dots-x",class:"text-gray-400 text-4xl"})]),_:2},1024)])):h("",!0)]),"pagination-bottom":r(a=>[t("div",st,[o(k,{total:s.paginate.total,current:s.paginate.current_page,"per-page":s.paginate.perpage,pageRange:s.paginate.pageRange,onPageChanged:e[4]||(e[4]=g=>d.changePage(g)),pageChanged:a.pageChanged,perPageChanged:a.perPageChanged,textAfterInput:"ไปที่หน้า",enableSearch:"",enableInput:""},null,8,["total","current","per-page","pageRange","pageChanged","perPageChanged"])])]),_:1},8,["columns","rows","pagination-options","search-options"])]),_:1}),s.isShowModalDetail?(c(),y(O,{key:0,title:"รายละเอียดบทบาท",activeModal:s.isShowModalDetail,"onEvent:closeModal":e[6]||(e[6]=a=>s.isShowModalDetail=!1),label:"",labelClass:"btn-outline-dark",sizeClass:"w-3/4",centered:""},{default:r(()=>[o(T,{item:s.dataDetail,"onEvent:close":e[5]||(e[5]=a=>s.isShowModalDetail=!1)},null,8,["item"])]),_:1},8,["activeModal"])):h("",!0),o(P,{title:"ยืนยันการเปิด/ปิดใช้งานบทบาทผู้ใช้งาน",isOpen:s.isShowDialogSwitch,modalId:s.modalId,status:s.modalStatus,"onEvent:close":d.onCloseSwitch,"onEvent:success":d.onAcceptSwitch},null,8,["isOpen","modalId","status","onEvent:close","onEvent:success"]),s.isSuccess?(c(),y(u,{key:1,title:"เปิด/ปิดใช้งานบทบาทผู้ใช้งาน",isOpen:s.isSuccess,"onEvent:closeModal":e[7]||(e[7]=a=>s.isSuccess=!1)},{default:r(()=>[at]),_:1},8,["isOpen"])):h("",!0),o(_,{title:"เปิด/ปิดใช้งานบทบาทผู้ใช้งาน",isOpen:s.isModalSwitchError,"onEvent:closeModal":e[8]||(e[8]=a=>s.isModalSwitchError=!1)},{default:r(()=>[t("h4",ot,w(s.switchErrorMessage),1)]),_:1},8,["isOpen"]),o(b,{title:"ยืนยันการลบข้อมูล",isOpen:s.isShowModalDelete,modalId:s.modalId,errorMessage:s.errorMessage,"onEvent:delete":d.onDelete,"onEvent:close":d.clearModal,"onEvent:success":d.clearModal},null,8,["isOpen","modalId","errorMessage","onEvent:delete","onEvent:close","onEvent:success"]),o(u,{title:"ยืนยันการลบข้อมูล",isOpen:s.isModalDeleteSuccess,"onEvent:closeModal":e[9]||(e[9]=a=>s.isModalDeleteSuccess=!1)},{default:r(()=>[lt]),_:1},8,["isOpen"]),o(_,{title:"ลบข้อมูล",isOpen:s.isModalDeleteError,"onEvent:closeModal":e[10]||(e[10]=a=>s.isModalDeleteError=!1)},{default:r(()=>[t("h4",nt,w(s.errorMessage),1)]),_:1},8,["isOpen"])])}const Ht=K(Fe,[["render",it]]);export{Ht as default};
