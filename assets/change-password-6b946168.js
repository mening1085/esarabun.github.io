import{T as E}from"./index-3e8503e7.js";import{u as M,a as h}from"./vee-validate.esm-bf91438b.js";import{c as A,a as b,b as B}from"./array-6ac4c54d.js";import{aF as m,as as u,o as x,x as c,bo as C,p as e,aA as w,al as O,aT as q,bj as I,m as D,n as N,ae as R,F as U,v as z,w as g}from"./preload-helper-f37a9bec.js";import{_ as F,a as T,u as G}from"./index-f91482a0.js";import{M as H}from"./Modal-b54f1b5f.js";import{B as W}from"./index-c2d6eb9c.js";import{I as Y}from"./index-8d30ace7.js";import{T as J}from"./index-b52aeb81.js";import{C as K}from"./index-cb5a08aa.js";import{T as L}from"./index-c09571ef.js";import{p as Q}from"./e-office-bg-8bf4c977.js";import{_ as X,a as Z}from"./logo-c4723144.js";import{A as $}from"./index-6ecf5774.js";import{_ as oo}from"./header-logo-d21824f9.js";import"./vue-cleave.min-df5c8cc9.js";import"./transition-be7c09bc.js";import"./dom-b10fc197.js";import"./hidden-800255f5.js";import"./focus-management-94a631f4.js";import"./micro-task-89dcd6af.js";import"./open-closed-75edfb8a.js";import"./use-outside-click-156e41c1.js";import"./iconify-2baafea4.js";const eo={components:{Textinput:E},data(){return{checkbox:!1}},setup(){const n=A({password:b().required("กรุณากรอกรหัสผ่าน").min(8,"รหัสผ่านควรมีความยาว 8 ตัวอย่างต่ำ"),confirmpassword:b().required("กรุณากรอกยืนยันรหัสผ่าน").oneOf([B("password"),null],"รหัสผ่านไม่ตรงกัน")}),{handleSubmit:t}=M({validationSchema:n}),{value:d,errorMessage:o}=h("password"),{value:l,errorMessage:p}=h("confirmpassword"),i=t(()=>{});return{password:d,confirmpassword:l,confirmpasswordError:p,passwordError:o,onSubmit:i}}},to=e("div",{class:"text-center"},[e("button",{type:"submit",class:"btn btn-primary w-5/12 text-center mr-7 mt-7"}," ตกลง "),e("button",{type:"button",onclick:"window.location.href='/'",class:"btn btn-white w-5/12 text-center border",style:{color:"rgb(177, 177, 182)"}}," ยกเลิก ")],-1);function so(n,t,d,o,l,p){const i=m("Textinput");return u(),x("form",{onSubmit:t[2]||(t[2]=C((...r)=>o.onSubmit&&o.onSubmit(...r),["prevent"])),class:"space-y-4"},[c(i,{label:"รหัสผ่านใหม่",placeholder:"",type:"password",name:"password",hasicon:"",modelValue:o.password,"onUpdate:modelValue":t[0]||(t[0]=r=>o.password=r),error:o.passwordError,classInput:"h-[48px]"},null,8,["modelValue","error"]),c(i,{label:"ยืนยันรหัสผ่านใหม่",placeholder:"",type:"password",name:"confirmpassword",hasicon:"",modelValue:o.confirmpassword,"onUpdate:modelValue":t[1]||(t[1]=r=>o.confirmpassword=r),error:o.confirmpasswordError,classInput:"h-[48px]"},null,8,["modelValue","error"]),to],32)}const ro=F(eo,[["render",so]]);const ao={data(){return{checkbox:!1,logoWhite:X,logo:Z,pageBg:Q}},components:{Modal:H,Button:W,Icon:Y,Textinput:E,ChangePassword:ro,Tooltip:J,Card:K,TooltipPassword:L,Avatar:$},setup(){const n=w(!1),t=w(!1),d=w({}),o=w(!1),l=G(),p=A({password:b().required("กรุณากรอกรหัสผ่าน").min(6,"รหัสผ่านต้องมีอย่างน้อย 6 ตัวอักษร"),confirmpassword:b().required("กรุณากรอกยืนยันรหัสผ่าน").oneOf([B("password"),null],"รหัสผ่านไม่ตรงกัน")}),{handleSubmit:i}=M({validationSchema:p}),{value:r,errorMessage:v}=h("password"),{value:f,errorMessage:_}=h("confirmpassword");O(async()=>{console.log(l.currentRoute.value.query.token);const{data:s,status:a}=await T("authStore","getUserInfo",{payload:l.currentRoute.value.query.token});a==200&&(console.log("get ค่าได้แล้ว"),console.log(s),d.value=s.result)});const y=i(async()=>{var s,a;if(console.log("checkValid",n.value),!n.value&&r.value==f.value){let P={id:(a=(s=d.value)==null?void 0:s.user)==null?void 0:a.id,newPassword:r.value};console.log("payload",P);const{data:Io,status:j}=await T("authStore","changePassword",{payload:P});j==200&&(o.value=!0,console.log("both password is the same"))}});return{password:r,confirmpassword:f,confirmpasswordError:_,passwordError:v,onSubmit:y,isShowDialog:o,onAccept:()=>{o.value=!1,l.push("/")},showValidPassword:t,onFocusInput:s=>{t.value=s},validPassword:s=>{console.log("validPassword",s),n.value=s},userInfo:d,checkValid:n}}},no=z('<nav class="flex items-center justify-between shadow-lg shadow-black-300/50 flex-wrap relative" style="background-color:white;z-index:1;"><div class="flex items-center flex-shrink-0 text-white mr-6"><img class="content-center" src="'+oo+'" alt="" width="80" height="80"><div class="flex flex-col ml-2"><span class="text-l font-bold text-slate-900 dark:text-white" style="color:rgba(6, 0, 215, 1);"> สำนักงานเศรษฐกิจการเกษตร </span><span class="text-xs text-slate-900 dark:text-white" style="color:rgba(6, 0, 215, 1);"> e-Office Automation </span></div></div></nav>',1),lo={class:"lg-inner-column",style:{"margin-top":"140px"}},io={class:"lg:w-1/2 w-full flex flex-col items-center justify-center mac",style:{"margin-left":"auto","margin-right":"auto"}},co={style:{"margin-top":"-250px"}},mo=e("div",{class:"text-center 2xl:mb-10 mb-5"},[e("h4",{class:"font-medium mb-4",style:{color:"rgba(6, 0, 215, 1)"}}," ตั้งค่ารหัสผ่านใหม่ "),e("div",{class:"text-slate-500 dark:text-slate-400 text-base"}," กรุณาตั้งรหัสผ่านใหม่ เนื่องจากเพิ่งทำการรีเซ็ตรหัสผ่านใหม่ ")],-1),po={class:"author-bio flex text-center mb-8",style:{"margin-top":"50px"}},uo={class:"h-14 w-14 mx-auto rounded-full mr-5"},fo={class:"text-slate-900 dark:text-white text-base font-medium mt-4",style:{"margin-right":"auto"}},wo=e("div",{class:"text-center"},[e("button",{type:"submit",class:"btn btn-primary w-5/12 text-center mr-7 mt-7"}," ตกลง "),e("button",{type:"button",onclick:"window.location.href='/'",class:"btn btn-white w-5/12 text-center border",style:{color:"rgb(142, 142, 150)","border-color":"rgb(142, 142, 150)"}}," ยกเลิก ")],-1),xo=e("div",{class:"auth-footer3 py-5 px-5 text-l w-full",style:{color:"rgba(105, 105, 116, 1)"}},[g(" COPYRIGHT © 2023 "),e("b",null,"e-Office"),g(", All rights Reserved ")],-1),ho={class:"h-36 flex items-center justify-center"},bo={class:"text-center flex flex-row flex-wrap justify-center"},go={class:"basis-full flex justify-center mb-5"},vo={key:0,class:"text-lg text-slate-900"},_o=e("span",{class:"text-green-500"},"สำเร็จ",-1),yo={key:1,class:"text-lg text-slate-900"},ko=e("span",{class:"text-green-500"},"สำเร็จ",-1),So={class:"flex justify-center w-full"};function Vo(n,t,d,o,l,p){var k,S,V,s;const i=m("Avatar"),r=m("Textinput"),v=m("TooltipPassword"),f=m("Icon"),_=m("Button"),y=m("Modal");return u(),x(U,null,[no,e("div",{class:"loginwrapper bg-cover bg-no-repeat bg-center",style:R([{backgroundImage:"url("+l.pageBg+")"},{height:"calc(100vh - 71px)","min-height":"500px","background-color":"white"}])},[e("div",lo,[e("div",io,[e("div",co,[mo,e("div",po,[e("div",uo,[c(i,{image:(S=(k=o.userInfo)==null?void 0:k.user)==null?void 0:S.profile_image},null,8,["image"])]),e("div",fo,q((s=(V=o.userInfo)==null?void 0:V.user)==null?void 0:s.full_name),1)]),e("form",{onSubmit:t[2]||(t[2]=C((...a)=>o.onSubmit&&o.onSubmit(...a),["prevent"])),class:"space-y-4"},[c(v,{isOpen:o.showValidPassword&&o.password!="",password:o.password,"onEvent:validPassword":o.validPassword},{default:I(()=>[c(r,{label:"รหัสผ่านใหม่",placeholder:"",type:"password",name:"password",hasicon:"",modelValue:o.password,"onUpdate:modelValue":t[0]||(t[0]=a=>o.password=a),focus:"",blur:"","onEvent:focus":o.onFocusInput,classInput:"h-[48px]"},null,8,["modelValue","onEvent:focus"])]),_:1},8,["isOpen","password","onEvent:validPassword"]),c(r,{label:"ยืนยันรหัสผ่านใหม่",placeholder:"",type:"password",name:"confirmpassword",hasicon:"",modelValue:o.confirmpassword,"onUpdate:modelValue":t[1]||(t[1]=a=>o.confirmpassword=a),error:o.confirmpasswordError,classInput:"h-[48px]"},null,8,["modelValue","error"]),wo],32)])]),xo]),o.isShowDialog?(u(),D(y,{key:0,title:"เปลี่ยนรหัสผ่านสำเร็จ",label:"",labelClass:"btn-outline-dark",ref:"modalDialog",centered:"",activeModal:o.isShowDialog,"onEvent:closeModal":t[4]||(t[4]=a=>o.onAccept())},{footer:I(()=>[e("div",So,[c(_,{text:"ปิด",btnClass:"btn-white w-36 border",style:{"border-color":"#e7e7e7","border-radius":"5px"},onClick:t[3]||(t[3]=a=>o.onAccept())})])]),default:I(()=>[e("div",ho,[e("div",bo,[e("div",go,[c(f,{icon:"icon-park-solid:protect",class:"text-5xl text-green-500"})]),n.$route.params.id?(u(),x("h4",vo,[g(" เปลี่ยนรหัสผ่าน "),_o])):(u(),x("h4",yo,[g(" เปลี่ยนรหัสผ่าน "),ko]))])])]),_:1},8,["activeModal"])):N("",!0)],4)],64)}const Xo=F(ao,[["render",Vo]]);export{Xo as default};
