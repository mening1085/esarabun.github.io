import{C as I}from"./index-cb5a08aa.js";import{I as G}from"./index-8d30ace7.js";import{B as F}from"./index-c2d6eb9c.js";import{V as M,C as S}from"./VueSelect-403231fd.js";import{M as V}from"./Modal-b54f1b5f.js";import{M as P}from"./index-8e7d66d6.js";import{R as B}from"./index-e163c14d.js";import{D as j}from"./index-43a31f90.js";import{D as T}from"./index-976a2577.js";import{M as A}from"./index-28033082.js";import{_ as O,a as C}from"./index-f91482a0.js";import{c as z}from"./appex-chart-e4d84b07.js";import E from"./colors-b4acbf58.js";import{I as R}from"./index-2198f2cf.js";import{T as L}from"./index-3e8503e7.js";import{C as N}from"./index-325a54cb.js";import{C as U}from"./index-8ecfca6d.js";import{C as Y}from"./index-multiple-c799ba8f.js";import{o as y,x as r,bj as _,aF as d,as as v,p as o,F as J,aD as X,aT as q,w}from"./preload-helper-f37a9bec.js";import"./iconify-2baafea4.js";import"./transition-be7c09bc.js";import"./dom-b10fc197.js";import"./hidden-800255f5.js";import"./focus-management-94a631f4.js";import"./micro-task-89dcd6af.js";import"./open-closed-75edfb8a.js";import"./use-outside-click-156e41c1.js";import"./index-b704274e.js";import"./index-f2da45ff.js";import"./use-resolve-button-type-d7bee841.js";import"./vue-cleave.min-df5c8cc9.js";import"./ck-white-3501111f.js";const W={computed:{columnChart(){return z}},components:{CFlatPickrMulti:Y,CFlatPickr:U,Checkbox:N,Textinput:L,InputGroup:R,ModalGraph:A,Dropdown:T,DatePickerRange:j,Radio:B,Icon:G,Button:F,Card:I,VueSelect:M,vSelect:S,Modal:V,ModalSuccess:P},data(){return{filter:{date:"",agency:null},item:{},dataGraph:[],dateMulti:[],agencyItem:[{id:1,title:"asdq"}],pie_rev_letter:[],pie_send_letter:[],bar_book_category:[],bar_reduce_paper:[],isOpen:!1,chartId:0}},watch:{filter:{handler:function(e,a){if(e.date&&e.date.length>10){let i=e.date.split(" to ");console.log(i),this.filter.start_date=i[0],this.filter.end_date=i[1]}else this.filter.start_date=e.date;this.getData()},deep:!0},dateMulti:{handler:function(e){typeof e=="object"&&this.getData()},deep:!0}},async created(){await this.getData()},methods:{openModalGraph(e){this.isOpen=!0,this.item=this.dataGraph[e],this.chartId=e},async getData(){var i,p,t,s;this.dateMulti.length>0&&(this.filter.date_start=this.dateMulti[0],this.filter.date_end=this.dateMulti[1]);const e=await C("reportFixStore","summaryPaper",{payload:this.filter}),a=await C("reportDashboardStore","getCommonData");this.dataGraph=[],(i=a==null?void 0:a.data.result)!=null&&i.dropdown&&(this.agencyItem=(p=a==null?void 0:a.data.result)==null?void 0:p.dropdown),(t=e.data)!=null&&t.result&&((s=e.data)==null||s.result.data.forEach((u,f)=>{this.dataGraph.push(this.generateGraph(u.dataGraph,f))}))},async downloadSVG(e="custom_chart_0",a){const p=await window.Apex._chartInstances.find(s=>s.id===e).chart.dataURI(),t=document.createElement("a");t.href=p.imgURI,t.download="image."+a,document.body.appendChild(t),t.click(),document.body.removeChild(t)},generateGraph(e,a){const i=e.id,p=e.name,t=e.chartType;let s;e.chartType==="donut"?s=e.data:s=[{data:e.data}];const u=["#FFB822","#716ACA","#0ABB87","#F4743B","#3E3C4F","#007AD9","#FD397A","#959CB6","#00C5DC","#F33E5C"],f={chart:{id:"custom_chart_"+a,type:e.chartType,toolbar:{show:!1}},dataLabels:{enabled:e.showLabel},stroke:{curve:"straight"},markers:{size:e.markers?4:0,colors:"#fff",strokeColors:E.primary,strokeWidth:2,shape:"circle",radius:2,hover:{sizeOffset:1}},labels:e.dataLabel,colors:e.colors,legend:{itemMargin:{vertical:5},width:200,offsetX:10,offsetY:60,formatter:function(l,m){let c=parseFloat(m.w.globals.series[m.seriesIndex]/m.w.globals.series.reduce((g,x)=>g+x,0)*100).toFixed(2)+"%";return l+" "+c}},yaxis:[{min:0,tickAmount:10}],xaxis:{labels:{rotate:300}},plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!1},value:{show:!0,fontSize:"40px",offsetY:15,formatter:function(l){return l}},total:{show:!0,label:"",color:"#373d3f",formatter:function(l){return l.globals.series.reduce((m,c)=>m+c,0)}}}}}},noData:{text:"No data",align:"center",verticalAlign:"middle",offsetX:0,offsetY:0,style:{fontSize:"40px"}}};return t=="bar"&&(f.colors=[function({dataPointIndex:l}){return u[l%u.length]}]),{id:i,name:p,series:s,options:f,chartType:t}},onFilter(){console.log("this.filter",this.filter)}}},H={class:"report-management"},K=o("div",{class:"md:flex justify-between p-6 md:space-y-0 space-y-3 items-center border-b-2"},[o("div",null,[o("span",null,"รายงานสถิติการลดใช้กระดาษ")])],-1),Q={class:"flex flex-row-between p-6"},Z=o("div",{class:"flex basis-1/5"},null,-1),$={class:"flex basis-4/5 gap-5"},ee={class:"basis-4/5"},te={class:"basis-2/5"},oe={class:"main-layout flex flex-wrap justify-between p-6"},ae={class:"w-full pt-2 pl-7 flex"},se={class:"basis-6/12"},re={class:"basis-6/12 flex justify-end pr-7"},ne={class:"border rounded-md flex align-items-center px-2 max-h-10"},ie={class:"w-full"},le=["onClick"],ce=["onClick"],de=["onClick"],pe={class:"basis-1/1 px-3 w-full"};function me(e,a,i,p,t,s){const u=d("CFlatPickr"),f=d("DatePickerRange"),l=d("vSelect"),m=d("VueSelect"),c=d("Icon"),g=d("Dropdown"),x=d("apexchart"),k=d("Card"),D=d("modal-graph");return v(),y("div",H,[r(k,{noborder:"",bodyClass:"two-side-card"},{default:_(()=>[K,o("div",Q,[Z,o("div",$,[o("div",ee,[r(f,null,{default:_(()=>[r(u,{config:{mode:"range"},onOnChange:a[0]||(a[0]=n=>t.dateMulti=n)})]),_:1})]),o("div",te,[r(m,{classInput:"input_color"},{default:_(()=>[r(l,{modelValue:t.filter.agency,"onUpdate:modelValue":a[1]||(a[1]=n=>t.filter.agency=n),placeholder:"หน่วยงานทั้งหมด",label:"organization_name",class:"input_color border rounded",reduce:n=>n.id,options:t.agencyItem,"onOption:selected":a[2]||(a[2]=n=>s.getData(1))},null,8,["modelValue","reduce","options"])]),_:1})])])]),o("div",oe,[(v(!0),y(J,null,X(t.dataGraph,(n,h)=>(v(),y("div",{key:h,class:"w-[49%] flex flex-wrap border-layout mt-5"},[o("div",ae,[o("div",se,q(n.name),1),o("div",re,[o("div",ne,[r(c,{style:{fontSize:"24px"},class:"text-gray-500 cursor-pointer mr-2 hover:bg-gray-100 rounded-md",onClick:b=>s.openModalGraph(h),icon:"material-symbols:pan-zoom"},null,8,["onClick"]),r(g,{classMenuItems:"right-full w-[220px] top-[110%]"},{menus:_(()=>[o("ul",ie,[o("li",null,[o("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer",onClick:b=>s.downloadSVG("custom_chart_"+h,"png")},[r(c,{icon:"bxs:file-png",class:"text-xl mr-2 text-blue-500"}),w(" ดาวน์โหลด (.PNG) ")],8,le)]),o("li",null,[o("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer",onClick:b=>s.downloadSVG("custom_chart_"+h,"jpg")},[r(c,{icon:"bxs:file-jpg",class:"text-xl mr-2 text-blue-500"}),w(" ดาวน์โหลด (.JPG) ")],8,ce)]),o("li",null,[o("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer",onClick:b=>s.downloadSVG("custom_chart_"+h,"jpeg")},[r(c,{icon:"simple-icons:jpeg",class:"text-xl mr-2 text-blue-500"}),w(" ดาวน์โหลด (.JPEG) ")],8,de)])])]),default:_(()=>[r(c,{icon:"pepicons-pencil:dots-x",class:"text-gray-400 text-4xl"})]),_:2},1024)])])]),o("div",pe,[r(x,{type:n.chartType,height:"300",width:"100%",options:n.options,series:n.series},null,8,["type","options","series"])])]))),128))])]),_:1}),r(D,{"is-open":t.isOpen,title:"",graph:t.item,"chart-id":t.chartId,"onEvent:close":a[3]||(a[3]=n=>t.isOpen=!1)},null,8,["is-open","graph","chart-id"])])}const Je=O(W,[["render",me]]);export{Je as default};
