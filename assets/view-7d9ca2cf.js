import{C as R}from"./index-cb5a08aa.js";import{I as V}from"./index-8d30ace7.js";import{B as F}from"./index-c2d6eb9c.js";import{E as O}from"./index-360221be.js";import{D as j}from"./index-976a2577.js";import{C as A,B as I,A as N,a as Y,b as z,R as H}from"./RouteDetail-d06baee9.js";import{M as U}from"./index-8e7d66d6.js";import{M as q}from"./index-31547449.js";import{M as G}from"./index-b704274e.js";import{_ as J,t as S,a as f,g as K,E as L}from"./index-f91482a0.js";import{d as Q}from"./dayjs.min-472eb357.js";import{M as W}from"./index-3891a0e1.js";import{T as X}from"./ThreeForm-c5dff615.js";import{T as Z}from"./TextValid-d1c607fc.js";import{T as $}from"./index-78f015fc.js";import{o as h,x as i,bj as d,m as u,n as c,aF as n,as as a,p as s,aT as v,w as ee}from"./preload-helper-f37a9bec.js";import"./iconify-2baafea4.js";import"./dom-b10fc197.js";import"./focus-management-94a631f4.js";import"./open-closed-75edfb8a.js";import"./use-resolve-button-type-d7bee841.js";import"./use-outside-click-156e41c1.js";import"./index-f32159fc.js";import"./Modal-b54f1b5f.js";import"./transition-be7c09bc.js";import"./hidden-800255f5.js";import"./micro-task-89dcd6af.js";import"./index-3e8503e7.js";import"./vue-cleave.min-df5c8cc9.js";import"./index-e68945de.js";import"./vee-validate.esm-bf91438b.js";import"./array-6ac4c54d.js";import"./tabs-cf3e0d3b.js";import"./VueSelect-403231fd.js";import"./index-fdd62298.js";import"./index-325a54cb.js";import"./ck-white-3501111f.js";import"./index-60fb4808.js";import"./vue3-tree-vue.esm-0dbd4492.js";import"./index-e163c14d.js";import"./index-8ecfca6d.js";const te={name:"ReceiveView",components:{Card:R,Icon:V,Button:F,Expansion:O,Dropdown:j,CoverSheet:A,BookDetail:I,AttachedFile:N,BookReference:Y,Activity:z,RouteDetail:H,ModalSuccess:U,ModalError:W,ModalCircular:q,Modal:G,ThreeForm:X,TextValid:Z,Textarea:$},data(){return{checkStatus:!1,checkPermission:!1,isOpen:!1,pdfPath:"",returnDelete:"",isShowDelete:!1,urlSarabun:S,item:null,isSuccess:!1,isError:!1,isSigned:!1,pinError:""}},created(){var p;this.fetchData();const{data:o,status:e}=f("circularStore","read",{payload:this.$route.params.id});e==200&&(console.log(o.message),this.checkStatus=(p=o==null?void 0:o.result)==null?void 0:p.acknowlege_status)},computed:{isMobile(){return K().isMobile}},methods:{async pdfHistory(){const{data:o,status:e}=await f("documentStore","PDFHistory",{payload:this.$route.params.id});e==200&&(console.log("data pdf",o.result),this.pdfPath=o.result,this.isOpen=!0)},async deleteBook(){console.log("1");const o=await f("circularStore","delete",{payload:{id:this.$route.params.id,delete_reason:this.returnDelete}});console.log("res",o),o.status==200&&this.closeModal()},onCancel(){this.isShowDelete=!0},async handleSigned(){this.isSigned=!0},async signedSubmit(o){var p;const e=await f("circularStore","store",{payload:o});console.log("data",e),e.status===200?(this.isSuccess=!0,this.isSigned=!1,L().clearSignature):e.status===403&&(this.pinError=(p=e.data)==null?void 0:p.message)},closeModal(){this.isShowDelete=!1,this.isSuccess=!1,this.isSigned=!1,this.isShowModalReturn=!1},async fetchData(){console.log("fetchData");const{data:o,status:e}=await f("circularStore","show",{payload:this.$route.params.id});e===200&&(this.checkPermission=o.result.permission.index,this.item=await o.result,console.log("item",this.item))},convertDate(o){return o?Q(o).locale("th").add(543,"year").format("DD/MM/YYYY"):"-"},async handleReceiveBook(){console.log("handleReceiveBook");const{data:o,status:e}=await f("documentStore","acceptDocument",{payload:this.$route.params.id});e===200&&(this.isSuccess=!0,this.fetchData())},onPrinter(){console.log("onPrinter")},downloadFileDocument(o){console.log(o)},downloadFile(o){const e=S+o;window.open(e,"_blank")},reloadPage(){location.reload()}}},oe={key:0,class:"flex items-center gap-3"},se=s("div",null,"กลับไปหน้ารายการ",-1),ie={key:1,class:"pt-4"},le={class:"md:text-2xl text-[16px] font-medium my-6"},re={key:6},ne={class:"h-[250px] flex items-center justify-center"},ae={class:"text-center flex flex-row flex-wrap justify-center"},ce={class:"basis-full flex justify-center mb-5"},me=s("div",null,[s("h4",{class:"text-lg text-slate-900"},[ee(" ลงนามเอกสารอิเล็กทรอนิกส์ "),s("span",{class:"text-green-500"},"สำเร็จ")])],-1),de=s("hr",null,null,-1),ue={class:"flex justify-center mt-4"},pe={class:"list space-y-1"},fe=s("div",{class:"text-sm font-medium text-slate-500 dark:text-slate-200"}," เหตุผลในการยกเลิกหนังสือ ",-1),he={class:"text-slate-600 dark:text-slate-400 mb-1"},xe={class:"text-center mt-4 flex justify-center w-full"},_e=["src"];function ve(o,e,p,ke,t,l){const k=n("Icon"),m=n("Button"),x=n("Card"),g=n("CoverSheet"),C=n("BookDetail"),w=n("AttachedFile"),M=n("BookReference"),D=n("Activity"),E=n("RouteDetail"),B=n("ModalCircular"),_=n("Modal"),P=n("Textarea"),T=n("TextValid");return a(),h("div",null,[i(x,null,{default:d(()=>{var r,y,b;return[l.isMobile?c("",!0):(a(),h("div",oe,[s("div",{onClick:e[0]||(e[0]=ye=>o.$router.back()),class:"flex items-center text-primary-600 cursor-pointer"},[i(k,{icon:"mdi:chevron-left",class:"text-xl"}),se]),i(m,{onClick:l.onCancel,text:"ยกเลิกหนังสือ",btnClass:"btn-danger h-[40px] flex items-center"},null,8,["onClick"])])),!t.checkStatus&&t.checkPermission?(a(),h("div",ie,[i(x,{bodyClass:"bg-gray-100 h-[95px] flex items-center space-y-10 py-6"},{default:d(()=>[s("div",null,[i(m,{onClick:l.handleSigned,text:"ลงนามเอกสารอิเล็กทรอนิกส์"},null,8,["onClick"])])]),_:1})])):c("",!0),s("div",le," วันที่ "+v(l.convertDate((r=t.item)==null?void 0:r.document_date))+" "+v((y=t.item)==null?void 0:y.subject)+" พ.ศ. "+v((b=t.item)==null?void 0:b.year),1),i(g,{item:t.item},null,8,["item"]),i(C,{item:t.item},null,8,["item"]),l.isMobile?c("",!0):(a(),u(w,{key:2,item:t.item},null,8,["item"])),l.isMobile?c("",!0):(a(),u(M,{key:3,item:t.item},null,8,["item"])),l.isMobile?c("",!0):(a(),u(D,{key:4,item:t.item,"onEvent:onClick":l.pdfHistory},null,8,["item","onEvent:onClick"])),l.isMobile?c("",!0):(a(),u(E,{key:5,item:t.item},null,8,["item"])),!t.checkStatus&&t.checkPermission?(a(),h("div",re,[i(x,{bodyClass:"bg-gray-100 h-[95px] flex items-center space-y-10 py-6"},{default:d(()=>[s("div",null,[i(m,{onClick:l.handleSigned,text:"ลงนามเอกสารอิเล็กทรอนิกส์"},null,8,["onClick"])])]),_:1})])):c("",!0)]}),_:1}),i(B,{item:t.item,title:"ลงนามเอกสารอิเล็กทรอนิกส์",isOpen:t.isSigned,pinError:t.pinError,"onEvent:closeModal":e[1]||(e[1]=r=>t.isSigned=!1),"onEvent:submit":l.signedSubmit,"onEvent:pincode":e[2]||(e[2]=r=>t.pinError="")},null,8,["item","isOpen","pinError","onEvent:submit"]),t.isSuccess?(a(),u(_,{key:0,title:"",activeModal:t.isSuccess,"onEvent:closeModal":e[5]||(e[5]=r=>t.isSuccess=!1),label:"",labelClass:"btn-outline-dark",sizeClass:"w-full max-w-[700px]",centered:""},{default:d(()=>[s("div",ne,[s("div",ae,[s("div",ce,[i(k,{icon:"icon-park-solid:protect",class:"text-6xl text-green-500"})]),me])]),de,s("div",ue,[i(m,{text:"ปิด",btnClass:"btn-primary w-32 mx-2",onClick:e[3]||(e[3]=r=>l.reloadPage())}),i(m,{text:"ไปหน้ารายการ",btnClass:"btn-outline-dark w-32 mx-2",onClick:e[4]||(e[4]=r=>o.$router.push("/app/central/rotate-book"))})])]),_:1},8,["activeModal"])):c("",!0),t.isShowDelete?(a(),u(_,{key:1,title:"ยกเลิกหนังสือ",activeModal:t.isShowDelete,"onEvent:closeModal":e[9]||(e[9]=r=>t.isShowDelete=!1),label:"",labelClass:"btn-outline-dark",sizeClass:"w-full max-w-[700px]",centered:""},{footer:d(()=>[s("div",xe,[i(m,{text:"บันทึก",btnClass:"btn-primary w-32 mx-2",onOnClick:e[7]||(e[7]=r=>l.deleteBook())}),i(m,{text:"ยกเลิก",btnClass:"btn-outline-dark w-32 mx-2",onOnClick:e[8]||(e[8]=r=>l.closeModal())})])]),default:d(()=>[s("div",pe,[fe,s("div",he,[i(P,{placeholder:"",name:"detail",classInput:t.returnDelete?"border border-gray-400 text_area_bg p-3":"border border-red-500 text_area_bg p-3",rows:4,modelValue:t.returnDelete,"onUpdate:modelValue":e[6]||(e[6]=r=>t.returnDelete=r)},null,8,["classInput","modelValue"]),i(T,{valid:t.returnDelete?"":"กรุณากรอกเหตุผลการยกเลิกหนังสือ"},null,8,["valid"])])])]),_:1},8,["activeModal"])):c("",!0),t.isOpen?(a(),u(_,{key:2,title:"ดูรายละเอียดเอกสาร",labelClass:"btn-outline-dark",sizeClass:"w-3/4",label:"",centered:"",activeModal:t.isOpen,"onEvent:closeModal":e[10]||(e[10]=r=>t.isOpen=!1)},{default:d(()=>[s("div",null,[s("iframe",{class:"w-full h-[1000px] mt-4",src:"data:application/pdf;base64, "+t.pdfPath,frameborder:"0"},null,8,_e)])]),_:1},8,["activeModal"])):c("",!0)])}const at=J(te,[["render",ve]]);export{at as default};
