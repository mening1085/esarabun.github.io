import{C as Y}from"./index-263882d1.js";import{I as H}from"./index-72ee420c.js";import{B as z}from"./index-441935dc.js";import{E as T}from"./index-1c6333b5.js";import{D as q}from"./index-090a8953.js";import{C as G,B as J,A as K,a as L,b as Q,R as U}from"./RouteDetail-b3469ae3.js";import{M as W}from"./index-7dc8252b.js";import{M as X}from"./index-2a7f4259.js";import{M as Z}from"./index-1b218db3.js";import{A as $}from"./AttachedFileStamp-b7cdd757.js";import{_ as ee,t as S,a as p}from"./index-e058a960.js";import{d as te}from"./dayjs.min-72c81edc.js";import{o as _,x as i,bj as d,m as f,n as a,aF as n,as as r,p as o,aT as u,w as B}from"./preload-helper-9e0646ca.js";import"./iconify-4e42c13d.js";import"./dom-891ac6c3.js";import"./focus-management-e6c5d1fd.js";import"./open-closed-486d85f0.js";import"./use-resolve-button-type-38f1f99a.js";import"./use-outside-click-a758fdce.js";import"./index-cc7a2b4b.js";import"./transition-39b574f4.js";import"./hidden-11a9ab9d.js";import"./micro-task-89dcd6af.js";const se={name:"ReceiveView",components:{Modal:Z,Card:Y,Icon:H,Button:z,Expansion:T,Dropdown:q,CoverSheet:G,BookDetail:J,AttachedFile:K,BookReference:L,Activity:Q,RouteDetail:U,ModalSuccess:W,ModalError:X,AttachedFileStamp:$},data(){return{next_step_id:null,isOpen:!1,pdfPath:"",titleModal:"",urlSarabun:S,item:null,isSuccess:!1,isError:!1,isSendBook:!1,errorMessage:""}},created(){this.fetchData()},methods:{async pdfHistory(){const{data:t,status:s}=await p("documentStore","PDFHistory",{payload:this.$route.params.id});s==200&&(console.log("data pdf",t.result),this.pdfPath=t.result,this.isOpen=!0)},async fetchData(){console.log("fetchData");const{data:t,status:s}=await p("documentStore","show",{payload:this.$route.params.id});s===200&&(this.item=t.result)},convertDate(t){return t?te(t).locale("th").add(543,"year").format("DD/MM/YYYY"):"-"},async handleReceiveBook(){var h;const{data:t,status:s}=await p("documentStore","acceptDocument",{payload:this.$route.params.id});s===200?(this.next_step_id=(h=t==null?void 0:t.result)==null?void 0:h.next_step_id,this.isSendBook=!0):(this.isError=!0,this.errorMessage=t.message)},closeModal(){isSendBook=!1},async onReturn(){console.log("onReturn");const{status:t,data:s}=await p("documentStore","return",{payload:this.$route.params.id});console.log("data",s),t===200?(this.titleModal="ดึงกลับ",this.isSuccess=!0,this.fetchData()):(this.isError=!0,this.errorMessage=s.message)},async onCancel(){console.log("onCancel");const t=await p("documentStore","delete",{payload:[{id:this.$route.params.id}]});console.log("data",t),t.status===200?this.$router.push("/app/receive-list/wait-to-receive"):(this.isError=!0,this.errorMessage=t.data.message)},onPrinter(){console.log("onPrinter")},downloadFileDocument(t){console.log(t)},downloadFile(t){const s=S+t;window.open(s,"_blank")}}},oe={class:"flex justify-between items-center"},ie={class:"basis-1/2"},ne={class:"flex items-center gap-3"},re={class:"shrink w-[145px]"},le=o("div",null,"กลับไปหน้ารายการ",-1),ae={key:0,class:"flex items-center border-x gap-3 border-gray-300 px-4"},ce=o("div",{class:"basis-1/2 flex justify-end items-center"},null,-1),me={key:0,class:"flex justify-center mt-4 py-4 bg-gray-100"},de={class:"text-2xl font-medium my-6"},ue={key:1,class:"flex justify-center mt-4 py-4 bg-gray-100"},pe={class:"text-lg text-slate-900"},fe=o("span",{class:"text-green-500"},"สำเร็จ",-1),_e={class:"text-lg text-slate-900"},he={class:"h-36 flex items-center justify-center"},xe={class:"text-center flex flex-row flex-wrap justify-center"},ve={class:"basis-full flex justify-center mb-5"},ke=o("h4",{class:"text-lg text-slate-900"},[B(u("ยืนยันการรับหนังสือ")+" "),o("span",{class:"text-green-500"},"สำเร็จ")],-1),ye=o("hr",{class:"mt-5 border"},null,-1),be={class:"text-center mt-4 flex justify-center"},Ce=["src"];function ge(t,s,h,we,e,c){const x=n("Icon"),m=n("Button"),D=n("router-link"),E=n("CoverSheet"),R=n("BookDetail"),j=n("AttachedFileStamp"),A=n("AttachedFile"),F=n("BookReference"),O=n("Activity"),P=n("RouteDetail"),V=n("Card"),I=n("ModalSuccess"),N=n("ModalError"),v=n("Modal");return r(),_("div",null,[i(V,null,{default:d(()=>{var l,k,y,b,C,g,w,M;return[o("div",oe,[o("div",ie,[o("div",ne,[o("div",re,[o("div",{onClick:s[0]||(s[0]=Me=>t.$router.back()),class:"flex items-center text-primary-600 cursor-pointer"},[i(x,{icon:"mdi:chevron-left",class:"text-xl"}),le])]),e.item?(r(),_("div",ae,[((l=e.item)==null?void 0:l.status)=="บันทึกฉบับร่าง"?(r(),f(D,{key:0,to:"/app/receive-list/wait-to-receive/edit-book/"+((k=e.item)==null?void 0:k.id)},{default:d(()=>[i(m,{text:"แก้ไข",btnClass:"btn-primary h-[40px] flex items-center"})]),_:1},8,["to"])):a("",!0),((y=e.item)==null?void 0:y.status)=="บันทึกฉบับร่าง"?(r(),f(m,{key:1,onClick:c.onReturn,text:"ดึงกลับ",btnClass:"btn-warning h-[40px] flex items-center"},null,8,["onClick"])):a("",!0),i(m,{onClick:c.onCancel,text:"ยกเลิกหนังสือ",btnClass:"btn-danger h-[40px] flex items-center"},null,8,["onClick"])])):a("",!0),i(x,{onClick:c.onPrinter,icon:"mdi:printer",class:"text-3xl cursor-pointer"},null,8,["onClick"])])]),ce]),((b=e.item)==null?void 0:b.status)=="รอรับ"?(r(),_("div",me,[i(m,{onClick:c.handleReceiveBook,text:"รับหนังสือ",btnClass:"btn-primary h-[40px] flex items-center"},null,8,["onClick"])])):a("",!0),o("div",de," วันที่ "+u(c.convertDate((C=e.item)==null?void 0:C.document_date))+" "+u((g=e.item)==null?void 0:g.subject)+" พ.ศ. "+u((w=e.item)==null?void 0:w.year),1),i(E,{item:e.item},null,8,["item"]),i(R,{item:e.item},null,8,["item"]),i(j,{item:e.item},null,8,["item"]),i(A,{item:e.item},null,8,["item"]),i(F,{item:e.item},null,8,["item"]),i(O,{item:e.item,"onEvent:onClick":c.pdfHistory},null,8,["item","onEvent:onClick"]),i(P,{item:e.item},null,8,["item"]),((M=e.item)==null?void 0:M.status)=="รอรับ"?(r(),_("div",ue,[i(m,{onClick:c.handleReceiveBook,text:"รับหนังสือ",btnClass:"btn-primary h-[40px] flex items-center"},null,8,["onClick"])])):a("",!0)]}),_:1}),i(I,{title:"",isOpen:e.isSuccess,"onEvent:closeModal":s[1]||(s[1]=l=>e.isSuccess=!1)},{default:d(()=>[o("h4",pe,[B(u(e.titleModal)+" ",1),fe])]),_:1},8,["isOpen"]),i(N,{title:"",isOpen:e.isError,"onEvent:closeModal":s[2]||(s[2]=l=>e.isError=!1)},{default:d(()=>[o("h4",_e,u(e.errorMessage),1)]),_:1},8,["isOpen"]),e.isSendBook?(r(),f(v,{key:0,title:"",labelClass:"btn-outline-dark",sizeClass:"w-full max-w-[550px]",centered:"",activeModal:e.isSendBook,"onEvent:closeModal":s[5]||(s[5]=l=>e.isSendBook=!1)},{default:d(()=>[o("div",he,[o("div",xe,[o("div",ve,[i(x,{icon:"icon-park-solid:protect",class:"text-5xl text-green-500"})]),ke])]),ye,o("div",be,[i(m,{text:"ดำเนินการต่อ",btnClass:"btn-primary w-32 font-medium mx-2",onClick:s[3]||(s[3]=l=>e.next_step_id?t.$router.push("/app/issue/wait-to-send/edit/"+e.next_step_id):t.$router.push("/app/receive-list/wait-to-receive/edit-book/"+t.$route.params.id))}),e.next_step_id?a("",!0):(r(),f(m,{key:0,text:"บันทึกฉบับร่าง",btnClass:"btn-outline-dark w-32 mx-2",onClick:s[4]||(s[4]=l=>t.$router.back())}))])]),_:1},8,["activeModal"])):a("",!0),e.isOpen?(r(),f(v,{key:1,title:"ดูรายละเอียดเอกสาร",labelClass:"btn-outline-dark",sizeClass:"w-3/4",label:"",centered:"",activeModal:e.isOpen,"onEvent:closeModal":s[6]||(s[6]=l=>e.isOpen=!1)},{default:d(()=>[o("div",null,[o("iframe",{class:"w-full h-[1000px] mt-4",src:"data:application/pdf;base64, "+e.pdfPath,frameborder:"0"},null,8,Ce)])]),_:1},8,["activeModal"])):a("",!0)])}const Ue=ee(se,[["render",ge]]);export{Ue as default};
