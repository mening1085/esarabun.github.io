import{C as F}from"./index-cb5a08aa.js";import{I as N}from"./index-8d30ace7.js";import{D as Z}from"./index-976a2577.js";import{V as L,C as z}from"./VueSelect-403231fd.js";import{M as A}from"./Modal-b54f1b5f.js";import{T as G}from"./index-b52aeb81.js";import{I as q}from"./index-2198f2cf.js";import{P as H}from"./index-5ddbaceb.js";import{B as J}from"./index-c2d6eb9c.js";import{S as K}from"./index-ca598517.js";import{C as Q}from"./index-4d060206.js";import{M as W}from"./index-8e7d66d6.js";import{M as X}from"./index-3891a0e1.js";import{d as Y}from"./vuedraggable.umd-ab5b0e72.js";import{C as $}from"./index-1653d012.js";import{_ as ee}from"./index-f91482a0.js";import{o as m,x as a,bj as i,m as g,n as f,aF as n,as as u,p as e,w as h,aT as _,F as te,aD as se,aE as le}from"./preload-helper-f37a9bec.js";import"./iconify-2baafea4.js";import"./dom-b10fc197.js";import"./focus-management-94a631f4.js";import"./open-closed-75edfb8a.js";import"./use-resolve-button-type-d7bee841.js";import"./use-outside-click-156e41c1.js";import"./transition-be7c09bc.js";import"./hidden-800255f5.js";import"./micro-task-89dcd6af.js";import"./vue-cleave.min-df5c8cc9.js";import"./index-a56f86b1.js";import"./index-3e8503e7.js";import"./index-b704274e.js";const oe={components:{draggable:Y,Card:F,Icon:N,Dropdown:Z,VueSelect:L,vSelect:z,Modal:A,Tooltip:G,InputGroup:q,Pagination:H,Button:J,Switch:K,ChangeStatus:Q,ModalSuccess:W,ModalError:X,ConfirmDelete:$},data(){return{status:"",keyword:"",statusList:[{value:"",title:"สถานะทั้งหมด"},{value:!0,title:"เปิดใช้งาน"},{value:!1,title:"ปิดใช้งาน"}],isShowModalDelete:!1,isModalDeleteSuccess:!1,isModalDeleteError:!1,errorMessage:"",isShowDialog:!1,modalStatus:!1,modalId:"",isSuccess:!1,isShowDialogSwitch:!1,paginate:{total:50,current:1,perpage:10,pageRange:5},columns:[{label:"เส้นทางหนังสือ",field:"flow_name",tdClass:"text_left",thClass:"text_left"},{label:"ขั้นความลับ",field:"secret_level",width:"15%",tdClass:"text_left",thClass:"text_left"},{label:"สถานะใช้งาน",field:"enabled",width:"15%",tdClass:"text_left",thClass:"text_left"},{label:"จัดการ",field:"action",width:"5%"}],exampleData:[{id:7141,menu:{id:1,title:"หน้าแรก"},userRole:[{type:"role",id:6,name:"บทบาททดสอบ2",enabled:!0,organization_id:1,can_attach_file:!1,can_scan_file:!1,can_finish_job:!1,can_pull_back:!1,can_return:!1,can_cancel:!1,user_count:0,created_at:"2023-09-25T07:48:10.091Z",updated_at:"2023-09-25T10:51:00.734Z",deleted_at:null,selected:!0}],detailList:[{id:8646,name:"test"}]},{id:7027,menu:{id:3,title:"รอรับ"},userRole:[{type:"role",id:9,name:"บทบาททดสอบ2",enabled:!0,organization_id:1,can_attach_file:!1,can_scan_file:!1,can_finish_job:!1,can_pull_back:!1,can_return:!1,can_cancel:!1,user_count:1,created_at:"2023-09-26T04:35:19.976Z",updated_at:"2023-09-27T04:18:23.899Z",deleted_at:null,selected:!0},{type:"role",id:11,name:"eiei",enabled:!0,organization_id:10,can_attach_file:!0,can_scan_file:!1,can_finish_job:!1,can_pull_back:!1,can_return:!1,can_cancel:!1,user_count:1,created_at:"2023-09-27T04:02:51.682Z",updated_at:"2023-09-28T07:14:14.157Z",deleted_at:null,selected:!0}],detailList:[{id:5505,name:"test2"},{id:5459,name:"test3"}]}],advancedTable:[],formDetail:null}},created(){this.getData(1)},methods:{async getData(o){let{data:t,status:c}=await this.$apiFire("bookRouteStore","get",{payload:{page:o,status:this.status,keyword:this.keyword}});c===200&&(this.advancedTable=t.result.data,this.paginate.total=t.result.total_page*t.result.per_page,this.paginate.current_page=t.result.current_page,this.paginate.perpage=t.result.per_page)},changePage(o){this.paginate.current_page=o,this.getData(o)},async showDetail(o){this.modalId=o,this.isShowDialog=!0;let{data:t,status:c}=await this.$apiFire("bookRouteStore","show",{payload:o});console.log("data",t),console.log("status",c),c===200&&(this.formDetail=t.result)},onUpdateSwitch(o,t){this.isShowDialogSwitch=!0,this.modalId=o,this.modalStatus=t,console.log("check modalStatus",t)},onCloseSwitch(){this.clearModal(),this.isShowDialogSwitch=!1,this.modalId=null,this.advancedTable=this.advancedTable.map(o=>(console.log(this.modalId),o.id===this.modalId&&(o.enabled=!!o.enabled),o))},async onAcceptSwitch(o){console.log("payload",o);const t=await this.$apiFire("bookRouteStore","changStatus",{payload:{id:o.id,status:o.status}});t.status==200?(this.isSuccess=!0,this.clearModal()):(console.log("error: ",t),this.passwordError=t.data.message,this.clearModal())},clearModal(){this.isShowDialogSwitch=!1,this.isShowModalDelete=!1,this.isModalDeleteSuccess=!1,this.isModalDeleteError=!1,this.errorMessage="",this.modalId=null},onClose(){this.isShowDialog=!1},allRole(o){let t=[];return o.userRole.forEach((c,b)=>{t.push(c.name)}),t.join(", ")},getRoleName(o){let t=[];return o.document_flow_order_roles.forEach((c,b)=>{var s;t.push((s=c.sarabun_roles)==null?void 0:s.name)}),t.join(", ")},async openModalDelete(o){this.isShowModalDelete=!0,this.modalId=o},async onDelete(o){this.isShowModalDelete=!1;const t=await this.$apiFire("bookRouteStore","delete",{payload:o});console.log("res",t),this.isShowModalDelete=!1,t.status==200?(this.isModalDeleteSuccess=!0,this.getData(1)):(console.log("error: ",t),this.isModalDeleteError=!0,this.errorMessage=t.data.message)}}},ae={class:"book-route"},ne={class:"md:flex justify-between pb-6 md:space-y-0 space-y-3 items-center"},ie={class:"basis-2/5"},re={class:"flex flex-wrap sm:flex-nowrap gap-3 basis-2/5"},de={class:"basis-full"},ce={class:"basis-full"},ue=e("div",{class:"text-center"},[e("div",{class:"text-gray-400"},"ไม่พบข้อมูล")],-1),_e={key:0},me={key:1},pe={class:"w-full"},he=["onClick"],fe=["onClick"],ge={class:"py-4 px-3"},be=e("h4",{class:"text-lg text-slate-900"},[h(" เปิด/ปิดใช้งานบทบาทผู้ใช้งาน"),e("span",{class:"text-green-500"},"สำเร็จ")],-1),ve={key:0},xe=e("div",{class:"text-xl"},"ข้อมูลทั่วไป",-1),we=e("br",null,null,-1),Se={class:"bg-gray-100 py-3 px-3 sm:px-0"},De={class:"flex flex-wrap items-center"},ye=e("div",{class:"sm:basis-1/3 basis-full pr-4 text-right"}," ชื่อเส้นทาง : ",-1),Ce={class:"sm:basis-1/3 basis-full"},Me={class:"py-3 px-3 sm:px-0"},ke={class:"flex flex-wrap items-center"},Ee=e("div",{class:"sm:basis-1/3 basis-full pr-4 text-right"}," ชั้นความลับ : ",-1),Ie={class:"sm:basis-1/3 basis-full"},Ve={class:"bg-gray-100 py-3 px-3 sm:px-0"},Te={class:"flex flex-wrap items-center"},Re=e("div",{class:"sm:basis-1/3 basis-full pr-4 text-right"}," ประเภทหนังสือรับ - ส่ง : ",-1),Oe={class:"sm:basis-1/3 basis-full"},Pe={class:"py-3 px-3 sm:px-0"},Ue={class:"flex flex-wrap items-center"},je=e("div",{class:"sm:basis-1/3 basis-full pr-4 text-right"}," ประเภทหนังสือ : ",-1),Be={class:"sm:basis-1/3 basis-full"},Fe=e("div",{class:"text-xl"},"ข้อมูลเส้นทางหนังสือ",-1),Ne=e("br",null,null,-1),Ze={class:"title-slot"},Le={class:"md:flex items-center md:space-x-6 rtl:space-x-reverse"},ze={class:"text-slate-900 dark:text-slate-200"},Ae={class:"text-center mt-4 flex justify-center w-full"},Ge=e("h4",{class:"text-lg text-slate-900"},[h(" ลบข้อมูลบทบาท "),e("span",{class:"text-green-500"},"สำเร็จ")],-1),qe={class:"text-lg text-slate-900"};function He(o,t,c,b,s,r){const v=n("Button"),x=n("router-link"),C=n("vSelect"),M=n("VueSelect"),k=n("InputGroup"),w=n("Switch"),p=n("Icon"),E=n("Dropdown"),I=n("Pagination"),V=n("vue-good-table"),S=n("Card"),T=n("ChangeStatus"),D=n("ModalSuccess"),R=n("draggable"),O=n("Modal"),P=n("ConfirmDelete"),U=n("ModalError");return u(),m("div",ae,[a(S,{noborder:""},{default:i(()=>[e("div",ne,[e("div",ie,[a(x,{to:"book-route/create"},{default:i(()=>[a(v,{icon:"ic:baseline-plus",text:"เพิ่มเส้นทางหนังสือ",btnClass:"btn-primary rounded-md"})]),_:1})]),e("div",re,[e("div",de,[a(M,{classInput:"input_color"},{default:i(()=>[a(C,{modelValue:s.status,"onUpdate:modelValue":t[0]||(t[0]=l=>s.status=l),label:"title",class:"input_color border rounded",reduce:l=>l.value,options:s.statusList,"onOption:selected":t[1]||(t[1]=l=>r.getData(1))},null,8,["modelValue","reduce","options"])]),_:1})]),e("div",ce,[a(k,{type:"text",placeholder:"ค้นหา",prependIcon:"material-symbols:search",classInput:"h-[40px] input_color border",merged:"",modelValue:s.keyword,"onUpdate:modelValue":t[2]||(t[2]=l=>s.keyword=l),inputEnter:"","onEvent:inputEnter":t[3]||(t[3]=l=>r.getData(1))},null,8,["modelValue"])])])]),a(V,{columns:s.columns,styleClass:" vgt-table bordered centered",rows:s.advancedTable,"pagination-options":{enabled:!0,perPage:s.paginate.perpage},"sort-options":{enabled:!1}},{emptystate:i(()=>[ue]),"table-row":i(l=>[l.column.field=="enabled"?(u(),m("span",_e,[l.row.enabled?(u(),g(w,{key:0,label:"เปิดใช้งาน",activeClass:"bg-primary-500",active:!0,modelValue:l.row.enabled,"onUpdate:modelValue":d=>{l.row.enabled=d,s.modalId=l.row.id,r.onUpdateSwitch(l.row.id,d)}},null,8,["modelValue","onUpdate:modelValue"])):(u(),g(w,{key:1,label:"ปิดใช้งาน",activeClass:"bg-primary-500",active:!1,modelValue:l.row.enabled,"onUpdate:modelValue":d=>{l.row.enabled=d,s.modalId=l.row.id,r.onUpdateSwitch(l.row.id,d)}},null,8,["modelValue","onUpdate:modelValue"]))])):f("",!0),l.column.field=="action"?(u(),m("span",me,[a(E,{classMenuItems:"right-full  w-[220px] top-[110%] "},{menus:i(()=>[e("ul",pe,[e("li",null,[a(x,{class:"p-2 flex items-center hover:bg-gray-50",to:`book-route/edit/${l.row.id}`},{default:i(()=>[a(p,{icon:"bx:edit",class:"text-xl mr-2"}),h(" แก้ไข ")]),_:2},1032,["to"])]),e("li",null,[e("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer",onClick:d=>r.showDetail(l.row.id)},[a(p,{icon:"grommet-icons:document-text",class:"text-xl mr-2"}),h(" ดูรายละเอียด ")],8,he)]),e("li",null,[e("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer border-t text-red-500",onClick:d=>r.openModalDelete(l.row.id)},[a(p,{icon:"material-symbols:delete",class:"text-xl mr-2"}),h(" ลบ ")],8,fe)])])]),default:i(()=>[a(p,{icon:"pepicons-pencil:dots-x",class:"text-gray-400 text-4xl"})]),_:2},1024)])):f("",!0)]),"pagination-bottom":i(l=>[e("div",ge,[a(I,{total:s.paginate.total,current:s.paginate.current_page,"per-page":s.paginate.perpage,pageRange:s.paginate.pageRange,onPageChanged:t[4]||(t[4]=d=>r.changePage(d)),pageChanged:l.pageChanged,perPageChanged:l.perPageChanged,textAfterInput:"ไปที่หน้า",enableSearch:"",enableInput:""},null,8,["total","current","per-page","pageRange","pageChanged","perPageChanged"])])]),_:1},8,["columns","rows","pagination-options"])]),_:1}),a(T,{title:"ยืนยันการเปิด/ปิดผู้ใช้งาน",isOpen:s.isShowDialogSwitch,modalId:s.modalId,status:s.modalStatus,"onEvent:close":r.onCloseSwitch,"onEvent:success":r.onAcceptSwitch},null,8,["isOpen","modalId","status","onEvent:close","onEvent:success"]),a(D,{title:"ยืนยันการเปิด/ปิดผู้ใช้งาน",isOpen:s.isSuccess,"onEvent:closeModal":t[5]||(t[5]=l=>s.isSuccess=!1)},{default:i(()=>[be]),_:1},8,["isOpen"]),s.isShowDialog?(u(),g(O,{key:0,title:"รายละเอียดเส้นทางหนังสือรับ/ส่ง",label:"",labelClass:"btn-outline-dark",sizeClass:"max-w-[900px]",ref:"modalDialog",centered:"",activeModal:s.isShowDialog,"onEvent:closeModal":t[7]||(t[7]=l=>r.onClose())},{footer:i(()=>[e("div",Ae,[a(v,{text:"ยกเลิก",btnClass:"btn-outline-dark w-32 mx-2",onOnClick:t[6]||(t[6]=l=>r.onClose())})])]),default:i(()=>[s.formDetail?(u(),m("div",ve,[xe,we,e("div",null,[e("div",Se,[e("div",De,[ye,e("div",Ce,_(s.formDetail.flow_name),1)])]),e("div",Me,[e("div",ke,[Ee,e("div",Ie,_(s.formDetail.secret_level),1)])])]),e("div",null,[e("div",Ve,[e("div",Te,[Re,e("div",Oe,_(s.formDetail.doc_pickup_type=="receive"?"หนังสือรับ":"หนังสือส่ง"),1)])]),e("div",Pe,[e("div",Ue,[je,e("div",Be,_(s.formDetail.doc_type=="inside"?"ภายใน":"ภายนอก"),1)])])]),Fe,Ne,a(S,null,{default:i(()=>{var l;return[a(R,{class:"dragArea",tag:"ul",list:(l=s.formDetail)==null?void 0:l.document_flow_orders,group:{name:"g1"},"item-key":"name",handle:".handle"},{item:i(({element:d})=>{var y;return[e("li",null,[e("div",Ze,[a(p,{icon:"clarity:drag-handle-line",class:"handle text-[32px]"}),e("div",Le,[e("div",null,[e("div",ze,_(((y=d.sub_menu)==null?void 0:y.name)+" - "+r.getRoleName(d)),1),(u(!0),m(te,null,se(d.document_flow_order_action,(j,B)=>(u(),m("div",{key:B},_("• "+j.action_name),1))),128))])]),e("div",null,[le(o.$slots,"default")])])])]}),_:3},8,["list"])]}),_:3})])):f("",!0)]),_:3},8,["activeModal"])):f("",!0),a(P,{title:"ยืนยันการลบข้อมูล",isOpen:s.isShowModalDelete,modalId:s.modalId,"onEvent:delete":r.onDelete,"onEvent:close":r.clearModal,"onEvent:success":r.clearModal},null,8,["isOpen","modalId","onEvent:delete","onEvent:close","onEvent:success"]),a(D,{title:"ยืนยันการลบข้อมูล",isOpen:s.isModalDeleteSuccess,"onEvent:closeModal":t[8]||(t[8]=l=>s.isModalDeleteSuccess=!1)},{default:i(()=>[Ge]),_:1},8,["isOpen"]),a(U,{title:"",isOpen:s.isModalDeleteError,"onEvent:closeModal":t[9]||(t[9]=l=>s.isModalDeleteError=!1)},{default:i(()=>[e("h4",qe,_(s.errorMessage),1)]),_:1},8,["isOpen"])])}const Dt=ee(oe,[["render",He]]);export{Dt as default};
