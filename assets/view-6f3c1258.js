import{C as V}from"./index-cb5a08aa.js";import{I}from"./index-8d30ace7.js";import{B as N}from"./index-c2d6eb9c.js";import{E as Y}from"./index-360221be.js";import{D as H}from"./index-976a2577.js";import{C as T,B as z,A as q,a as G,b as J,R as K}from"./RouteDetail-d06baee9.js";import{M as L}from"./index-8e7d66d6.js";import{M as Q}from"./index-b704274e.js";import{M as U}from"./index-3891a0e1.js";import{B as W}from"./BookDraftRef-086a5656.js";import{_ as X,t as b,a as c}from"./index-f91482a0.js";import{d as Z}from"./dayjs.min-472eb357.js";import{o as f,x as s,bj as m,m as _,n as p,aF as n,as as a,p as i,aT as d,w as $}from"./preload-helper-f37a9bec.js";import"./iconify-2baafea4.js";import"./dom-b10fc197.js";import"./focus-management-94a631f4.js";import"./open-closed-75edfb8a.js";import"./use-resolve-button-type-d7bee841.js";import"./use-outside-click-156e41c1.js";import"./index-f32159fc.js";import"./transition-be7c09bc.js";import"./hidden-800255f5.js";import"./micro-task-89dcd6af.js";const ee={name:"ReceiveView",components:{Modal:Q,Card:V,Icon:I,Button:N,Expansion:Y,Dropdown:H,CoverSheet:T,BookDetail:z,AttachedFile:q,BookReference:G,Activity:J,RouteDetail:K,BookDraftRef:W,ModalSuccess:L,ModalError:U},data(){return{isOpen:!1,pdfPath:"",urlSarabun:b,item:null,isSuccess:!1,isSuccess:!1,isError:!1,isSendBook:!1,errorMessage:""}},created(){this.fetchData()},methods:{async pdfHistory(){const{data:t,status:o}=await c("documentStore","PDFHistory",{payload:this.$route.params.id});o==200&&(console.log("data pdf",t.result),this.pdfPath=t.result,this.isOpen=!0)},async fetchData(){console.log("fetchData");const{data:t,status:o}=await c("documentSendStore","show",{payload:this.$route.params.id});o===200&&(this.item=t.result)},convertDate(t){return t?Z(t).locale("th").add(543,"year").format("DD/MM/YYYY"):"-"},async handleReceiveBook(){console.log("handleReceiveBook");const{data:t,status:o}=await c("documentStore","acceptDocument",{payload:this.$route.params.id});o===200&&(this.isSuccess=!0,this.fetchData())},async onReturn(){console.log("onReturn");const{status:t,data:o}=await c("documentSendStore","return",{payload:this.$route.params.id});console.log("data",o),t===200?(this.isSuccess=!0,this.fetchData()):(this.isError=!0,this.errorMessage=o.message)},async onCancel(){console.log("onCancel"),console.log("onCancel");const t=await c("documentSendStore","delete",{payload:[{id:this.$route.params.id}]});t.status===200?this.$router.push("/app/issue/wait-to-send"):(this.isError=!0,this.errorMessage=t.data.message)},onPrinter(){console.log("onPrinter")},downloadFileDocument(t){console.log(t)},downloadFile(t){const o=b+t;window.open(o,"_blank")}}},te={class:"flex justify-between items-center"},oe={class:"basis-1/2"},se={class:"flex items-center gap-3"},ne={class:"shrink w-[145px]"},ie=i("div",null,"กลับไปหน้ารายการ",-1),re={key:0,class:"flex items-center border-x gap-3 border-gray-300 px-4"},ae={key:0,class:"flex justify-center mt-4 py-4 bg-gray-100"},le={class:"text-2xl font-medium my-6"},ce=i("h4",{class:"text-lg text-slate-900"},[$(" ดึงกลับ "),i("span",{class:"text-green-500"},"สำเร็จ")],-1),me=["src"],pe={class:"text-lg text-slate-900"};function ue(t,o,de,fe,e,r){const h=n("Icon"),u=n("Button"),D=n("router-link"),w=n("CoverSheet"),B=n("BookDetail"),M=n("AttachedFile"),S=n("BookDraftRef"),R=n("BookReference"),E=n("Activity"),O=n("RouteDetail"),F=n("Card"),A=n("ModalSuccess"),P=n("Modal"),j=n("ModalError");return a(),f("div",null,[s(F,null,{default:m(()=>{var l,v,x,k,y,C,g;return[i("div",te,[i("div",oe,[i("div",se,[i("div",ne,[i("div",{onClick:o[0]||(o[0]=_e=>t.$router.back()),class:"flex items-center text-primary-600 cursor-pointer"},[s(h,{icon:"mdi:chevron-left",class:"text-xl"}),ie])]),e.item?(a(),f("div",re,[((l=e.item)==null?void 0:l.status)=="บันทึกฉบับร่าง"?(a(),_(D,{key:0,to:"/app/issue/wait-to-send/edit/"+((v=e.item)==null?void 0:v.id)},{default:m(()=>[s(u,{text:"แก้ไข",btnClass:"btn-primary h-[40px] flex items-center"})]),_:1},8,["to"])):p("",!0),((x=e.item)==null?void 0:x.status)=="บันทึกฉบับร่าง"?(a(),_(u,{key:1,onClick:r.onReturn,text:"ดึงกลับ",btnClass:"btn-warning h-[40px] flex items-center"},null,8,["onClick"])):p("",!0),s(u,{onClick:r.onCancel,text:"ยกเลิกหนังสือ",btnClass:"btn-danger h-[40px] flex items-center"},null,8,["onClick"])])):p("",!0),s(h,{onClick:r.onPrinter,icon:"mdi:printer",class:"text-3xl cursor-pointer"},null,8,["onClick"])])])]),((k=e.item)==null?void 0:k.status)=="รอรับ"?(a(),f("div",ae,[s(u,{onClick:r.handleReceiveBook,text:"รับหนังสือ",btnClass:"btn-primary h-[40px] flex items-center"},null,8,["onClick"])])):p("",!0),i("div",le," วันที่ "+d(r.convertDate((y=e.item)==null?void 0:y.document_date))+" "+d((C=e.item)==null?void 0:C.subject)+" พ.ศ. "+d((g=e.item)==null?void 0:g.year),1),s(w,{item:e.item},null,8,["item"]),s(B,{item:e.item},null,8,["item"]),s(M,{item:e.item},null,8,["item"]),s(S,{item:e.item},null,8,["item"]),s(R,{item:e.item},null,8,["item"]),s(E,{item:e.item,"onEvent:onClick":r.pdfHistory},null,8,["item","onEvent:onClick"]),s(O,{item:e.item},null,8,["item"])]}),_:1}),s(A,{title:"ดึงกลับ",isOpen:e.isSuccess,"onEvent:closeModal":o[1]||(o[1]=l=>e.isSuccess=!1)},{default:m(()=>[ce]),_:1},8,["isOpen"]),e.isOpen?(a(),_(P,{key:0,title:"ดูรายละเอียดเอกสาร",labelClass:"btn-outline-dark",sizeClass:"w-3/4",label:"",centered:"",activeModal:e.isOpen,"onEvent:closeModal":o[2]||(o[2]=l=>e.isOpen=!1)},{default:m(()=>[i("div",null,[i("iframe",{class:"w-full h-[1000px] mt-4",src:"data:application/pdf;base64, "+e.pdfPath,frameborder:"0"},null,8,me)])]),_:1},8,["activeModal"])):p("",!0),s(j,{title:"",isOpen:e.isError,"onEvent:closeModal":o[3]||(o[3]=l=>e.isError=!1)},{default:m(()=>[i("h4",pe,d(e.errorMessage),1)]),_:1},8,["isOpen"])])}const Ye=X(ee,[["render",ue]]);export{Ye as default};
