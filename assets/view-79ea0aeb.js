import{C as N}from"./index-263882d1.js";import{I as P}from"./index-72ee420c.js";import{B as Y}from"./index-441935dc.js";import{E as z}from"./index-1c6333b5.js";import{D as H}from"./index-090a8953.js";import{T as U}from"./index-ce9a51c5.js";import{C as q,B as G,A as J,a as K,b as L,R as Q}from"./RouteDetail-b3469ae3.js";import{B as W}from"./BookDraftRef-746d0155.js";import{M as X}from"./index-7dc8252b.js";import{M as Z}from"./index-2a7f4259.js";import{M as $}from"./Modal-19eb68c4.js";import{A as ee}from"./AttachedFileStamp-b7cdd757.js";import{_ as te,t as se,a as _}from"./index-e058a960.js";import{d as oe}from"./dayjs.min-72c81edc.js";import{T as re}from"./TextValid-100be459.js";import{o as M,x as o,bj as l,m as p,n as d,aF as n,as as a,p as s,aT as m,w as g}from"./preload-helper-9e0646ca.js";import"./iconify-4e42c13d.js";import"./dom-891ac6c3.js";import"./focus-management-e6c5d1fd.js";import"./open-closed-486d85f0.js";import"./use-resolve-button-type-38f1f99a.js";import"./use-outside-click-a758fdce.js";import"./index-1b218db3.js";import"./transition-39b574f4.js";import"./hidden-11a9ab9d.js";import"./micro-task-89dcd6af.js";import"./index-cc7a2b4b.js";const ne={name:"ExamineView",components:{Card:N,Icon:P,Button:Y,Expansion:z,Dropdown:H,CoverSheet:q,BookDetail:G,AttachedFile:J,BookReference:K,Activity:L,RouteDetail:Q,AttachedFileStamp:ee,BookDraftRef:W,ModalSuccess:X,ModalError:Z,Modal:$,Textarea:U,TextValid:re},data(){return{isOpen:!1,pdfPath:"",urlSarabun:se,item:null,isSuccess:!1,isError:!1,examineError:!1,errorMessage:"",successMessage:"",modalExamine:!1,modalReturn:!1,returned_reason:"",returned_reason_error:""}},watch:{returned_reason(){console.log("returned_reason",this.returned_reason),this.returned_reason_error=""}},created(){this.fetchData()},methods:{async pdfHistory(){const{data:r,status:t}=await _("documentStore","PDFHistory",{payload:this.$route.params.id});t==200&&(console.log("data pdf",r.result),this.pdfPath=r.result,this.isOpen=!0)},async fetchData(){const{data:r,status:t}=await _("examineStore","show",{payload:this.$route.params.id});t===200?this.item=r.result:(this.isError=!0,this.errorMessage=r.message)},convertDate(r){return r?oe(r).locale("th").add(543,"year").format("DD/MM/YYYY"):"-"},async onReturn(){if(console.log("onReturn"),this.returned_reason===""){this.returned_reason_error="กรุณากรอกเหตุผลในการคืนเรื่อง";return}this.modalReturn=!1;const{data:r,status:t}=await _("examineStore","return",{payload:{id:this.$route.params.id,returned_reason:this.returned_reason}});console.log("data",r),t===200?(this.successMessage="คืนเรื่องสำเร็จ",this.isSuccess=!0,this.$router.push("/app/issue/examine")):(this.examineError=!0,this.errorMessage=r.message)},async onSubmit(){console.log("onSubmit");const{data:r,status:t}=await _("examineStore","store",{payload:this.$route.params.id});t===200?this.modalExamine=!0:(this.examineError=!0,this.errorMessage=r.message)},onClose(){this.modalExamine=!1,this.fetchData()}}},ie={class:"flex justify-between items-center"},le={class:"basis-1/2"},ae={class:"flex items-center gap-3"},me={class:"shrink w-[145px]"},ce=s("div",null,"กลับไปหน้ารายการ",-1),de={key:0,class:"flex justify-center mt-4 py-4 bg-gray-100 gap-3"},ue={class:"text-2xl font-medium my-6"},pe={class:"text-lg text-slate-900"},_e=s("span",{class:"text-green-500"},"สำเร็จ",-1),fe={class:"text-lg text-slate-900"},xe={class:"text-lg text-slate-900"},ve={class:"h-[250px] text-center"},he={class:"mb-5 flex justify-center"},be=s("h4",{class:"text-lg text-slate-900"}," ส่งหนังสือเพื่อคำสั่งการ/คำเสนอ/การปฏิบัติ ",-1),ye=s("div",{class:"text-green-500 text-2xl mb-8 mt-3"},"สำเร็จ",-1),ke=s("hr",null,null,-1),Ce={class:"flex justify-center mt-6"},Me={class:"h-[250px]"},ge=s("div",{class:"mb-1"},"เหตุผลในการคืนเรื่อง",-1),Ee={class:"text-slate-600 dark:text-slate-400 mb-1"},we=s("hr",{class:"my-8"},null,-1),Se={class:"text-center mt-4 flex justify-center w-full"},De=["src"];function Re(r,t,Be,Oe,e,u){const x=n("Icon"),c=n("Button"),E=n("CoverSheet"),w=n("BookDetail"),S=n("AttachedFileStamp"),D=n("BookDraftRef"),R=n("AttachedFile"),B=n("BookReference"),O=n("Activity"),A=n("RouteDetail"),V=n("Card"),T=n("ModalSuccess"),v=n("ModalError"),f=n("Modal"),F=n("Textarea"),j=n("TextValid");return a(),M("div",null,[o(V,null,{default:l(()=>{var i,h,b,y,k,C;return[s("div",ie,[s("div",le,[s("div",ae,[s("div",me,[s("div",{onClick:t[0]||(t[0]=I=>r.$router.back()),class:"flex items-center text-primary-600 cursor-pointer"},[o(x,{icon:"mdi:chevron-left",class:"text-xl"}),ce])])])])]),((i=e.item)==null?void 0:i.status)==="รอตรวจสอบ"?(a(),M("div",de,[o(c,{onClick:u.onSubmit,text:"ส่งบันทึกคำสั่งการ/คำเสนอ/การปฏิบัติ",btnClass:"btn-primary h-[40px] flex items-center"},null,8,["onClick"]),o(c,{onClick:t[1]||(t[1]=I=>e.modalReturn=!0),text:"คืนเรื่อง",btnClass:"border border-gray-400 h-[40px] flex items-center"})])):d("",!0),s("div",ue," วันที่ "+m(u.convertDate((h=e.item)==null?void 0:h.document_date))+" "+m((b=e.item)==null?void 0:b.subject)+" พ.ศ. "+m((y=e.item)==null?void 0:y.year),1),o(E,{item:e.item},null,8,["item"]),o(w,{item:e.item},null,8,["item"]),g(" "+m()+" ",1),((k=e.item)==null?void 0:k.doc_pickup_type)=="หนังสือรับ"?(a(),p(S,{key:1,item:e.item},null,8,["item"])):d("",!0),((C=e.item)==null?void 0:C.doc_pickup_type)=="หนังสือส่ง"?(a(),p(D,{key:2,item:e.item},null,8,["item"])):d("",!0),o(R,{item:e.item},null,8,["item"]),o(B,{item:e.item},null,8,["item"]),o(O,{item:e.item,"onEvent:onClick":u.pdfHistory},null,8,["item","onEvent:onClick"]),o(A,{item:e.item},null,8,["item"])]}),_:1}),o(T,{title:"",isOpen:e.isSuccess,"onEvent:closeModal":t[2]||(t[2]=i=>e.isSuccess=!1)},{default:l(()=>[s("h4",pe,[g(m(e.successMessage)+" ",1),_e])]),_:1},8,["isOpen"]),o(v,{title:"",isOpen:e.examineError,"onEvent:closeModal":t[3]||(t[3]=i=>e.examineError=!1)},{default:l(()=>[s("div",fe,m(e.errorMessage),1)]),_:1},8,["isOpen"]),o(v,{title:"",isOpen:e.isError,"onEvent:closeModal":t[4]||(t[4]=i=>r.$router.back())},{default:l(()=>[s("div",xe,m(e.errorMessage),1)]),_:1},8,["isOpen"]),e.modalExamine?(a(),p(f,{key:0,title:"",activeModal:e.modalExamine,"onEvent:closeModal":t[6]||(t[6]=i=>e.modalExamine=!1),label:"",labelClass:"btn-outline-dark",sizeClass:"w-full max-w-[700px]",centered:""},{default:l(()=>[s("div",ve,[s("div",he,[o(x,{icon:"icon-park-solid:protect",class:"text-5xl text-green-500"})]),be,ye,ke,s("div",Ce,[o(c,{text:"ไปหน้ารายการ",btnClass:"btn-outline-dark w-32 mx-2",onClick:t[5]||(t[5]=i=>r.$router.push("/app/issue/examine"))}),o(c,{text:"ปิด",btnClass:"btn-primary w-32 mx-2",onClick:u.onClose},null,8,["onClick"])])])]),_:1},8,["activeModal"])):d("",!0),e.modalReturn?(a(),p(f,{key:1,title:"แบบฟอร์มคืนเรื่อง",activeModal:e.modalReturn,"onEvent:closeModal":t[10]||(t[10]=i=>e.modalReturn=!1),label:"",labelClass:"btn-outline-dark",sizeClass:"w-full max-w-[700px]",centered:""},{default:l(()=>[s("div",Me,[ge,s("div",Ee,[o(F,{placeholder:"",name:"detail",classInput:e.returned_reason_error?"border border-red-500 text_area_bg p-3":"border border-gray-400 text_area_bg p-3",rows:4,modelValue:e.returned_reason,"onUpdate:modelValue":t[7]||(t[7]=i=>e.returned_reason=i)},null,8,["classInput","modelValue"]),o(j,{valid:e.returned_reason_error},null,8,["valid"])]),we,s("div",Se,[o(c,{text:"บันทึก",btnClass:"btn-primary w-32 mx-2",onOnClick:t[8]||(t[8]=i=>u.onReturn())}),o(c,{text:"ยกเลิก",btnClass:"btn-outline-dark w-32 mx-2",onOnClick:t[9]||(t[9]=i=>e.modalReturn=!1)})])])]),_:1},8,["activeModal"])):d("",!0),e.isOpen?(a(),p(f,{key:2,title:"ดูรายละเอียดเอกสาร",labelClass:"btn-outline-dark",sizeClass:"w-3/4",label:"",centered:"",activeModal:e.isOpen,"onEvent:closeModal":t[11]||(t[11]=i=>e.isOpen=!1)},{default:l(()=>[s("div",null,[s("iframe",{class:"w-full h-[1000px] mt-4",src:"data:application/pdf;base64, "+e.pdfPath,frameborder:"0"},null,8,De)])]),_:1},8,["activeModal"])):d("",!0)])}const nt=te(ne,[["render",Re]]);export{nt as default};
