import{aA as n,ay as z,al as ae,o as _,x as r,bj as c,m as A,n as C,aF as d,as as u,p as a,aT as B,w as D,F as oe,aD as le,bo as se}from"./preload-helper-f37a9bec.js";import{u as ne,a as Q}from"./vee-validate.esm-bf91438b.js";import{c as re,a as ie,g as de}from"./array-6ac4c54d.js";import{d as ce}from"./dayjs.min-472eb357.js";import{_ as ue,a as b}from"./index-f91482a0.js";import{D as me,S as ve}from"./index-976a2577.js";import{C as pe}from"./index-cb5a08aa.js";import{I as fe}from"./index-8d30ace7.js";import{B as ge}from"./index-c2d6eb9c.js";import{I as _e}from"./index-2198f2cf.js";import{P as be}from"./index-5ddbaceb.js";import{V as xe,C as he}from"./VueSelect-403231fd.js";import{S as we}from"./index-ca598517.js";import{M as Se}from"./Modal-b54f1b5f.js";import{T as ye}from"./index-3e8503e7.js";import{C as Me}from"./index-4d060206.js";import{C as Ce}from"./index-1653d012.js";import{M as De}from"./index-8e7d66d6.js";import{M as ke}from"./index-3891a0e1.js";import{R as Ee}from"./index-e163c14d.js";import"./dom-b10fc197.js";import"./focus-management-94a631f4.js";import"./open-closed-75edfb8a.js";import"./use-resolve-button-type-d7bee841.js";import"./use-outside-click-156e41c1.js";import"./iconify-2baafea4.js";import"./vue-cleave.min-df5c8cc9.js";import"./index-a56f86b1.js";import"./transition-be7c09bc.js";import"./hidden-800255f5.js";import"./micro-task-89dcd6af.js";import"./index-b704274e.js";const Ve={components:{Pagination:be,InputGroup:_e,Dropdown:me,Icon:fe,Button:ge,Card:pe,MenuItem:ve,VueSelect:xe,vSelect:he,Switch:we,Modal:Se,Radio:Ee,Textinput:ye,ChangeStatus:Me,ConfirmDelete:Ce,ModalSuccess:De,ModalError:ke},setup(){const m=n(null),o=n(!1),F=n(!1),e=n(!1),O=n(!1),k=n(!1),v=n(!1),E=n(!1),V=n(""),f=z({total:1,current_page:1,perpage:10,pageRange:5}),g=n(""),p=n(""),x=n(""),h=n(!0),w=n(null),R=n(""),G=n([{id:"",title:"สถานะทั้งหมด"},{id:!0,title:"เปิดการใช้งาน"},{id:!1,title:"ปิดการใช้งาน"}]),j=z({status:"",keyword:""}),N=n([{name:"view",icon:"heroicons-outline:eye"},{name:"edit",icon:"heroicons:pencil-square"},{name:"delete",icon:"heroicons-outline:trash"}]),Y=n([{value:!0,label:"เปิดใช้งาน",activeClass:"ring-primary-500 border-primary-500"},{value:!1,label:"ปิดใช้งาน",activeClass:"ring-primary-500 border-primary-500"}]),P=n([{label:"วัตถุประสงค์",field:"name",width:"230px",tdClass:"text_left",thClass:"text_left"},{label:"วันที่สร้าง",field:"created_at",width:"155px",tdClass:"text_left",thClass:"text_left"},{label:"วันที่แก้ไข",field:"updated_at",width:"155px",tdClass:"text_left",thClass:"text_left"},{label:"สถานะการใช้งาน",field:"enabled",width:"100px",tdClass:"text_left",thClass:"text_left"},{label:"จัดการ",field:"action",width:"50px"}]),S=n([]),q=re({name:ie().required("กรุณาระบุชื่อวัตถุประสงค์"),enabled:de().required("กรุณาเลือกการใช้งาน")}),{handleSubmit:t}=ne({validationSchema:q});ae(async()=>{y.value=!0,await i(1)});const i=async l=>{const s=await b("objectiveStore","get",{payload:{page:l,...j}});console.log("res",s),s.status===200&&(S.value=s.data.result.data,f.total=s.data.result.total_page*s.data.result.per_page,f.current_page=s.data.result.current_page,f.perpage=s.data.result.per_page,console.log("this.paginate.perpage",f.perpage))},L=(l,s)=>{O.value=!0,m.value=l,o.value=s},{value:I,errorMessage:J}=Q("name"),{value:y,errorMessage:K}=Q("enabled"),W=t(async()=>{let l={name:I.value,enabled:y.value};console.log("formID",w),w.value==null?(console.log("create submit"),(await b("objectiveStore","store",{payload:{data:l}})).status===200&&(e.value=!1,p.value="บันทึกข้อมูลวัตถุประสงค์",x.value="บันทึกข้อมูลวัตถุประสงค์",v.value=!0,H(),i(1))):(console.log("update submit"),(await b("objectiveStore","update",{payload:{id:w,data:l}})).status===200&&(e.value=!1,p.value="บันทึกการแก้ไขข้อมูลวัตถุประสงค์",x.value="บันทึกการแก้ไขข้อมูลวัตถุประสงค์",v.value=!0,i(1)))}),X=async l=>{const s=await b("objectiveStore","objectiveChangStatus",{payload:{id:l.id,enabled:l.status}});s.status==200?(console.log("switch 200"),F.value=!0,U()):(console.log("error: ",s),passwordError.value=s.data.message),U()},Z=()=>{S.value=S.map(l=>(l.id===m&&(l.status=!!l.status),l)),U()},$=l=>{k.value=!0,m.value=l},ee=async l=>{console.log("id delte",l),k.value=!1;const s=await b("objectiveStore","delete",{payload:l});console.log("res",s),s.status==200?(p.value="ยืนยันการลบข้อมูล",x.value="ลบข้อมูลวัตถุประสงค์",v.value=!0,i(1)):(console.log("error: ",s),E.value=!0,V.value=s.data.message)},U=()=>{O.value=!1,k.value=!1,v.value=!1,E.value=!1,e.value=!1,V.value="",m.value=null},te=async l=>{f.current_page=l,await i(l)},H=()=>{I.value="",y.value=!0};return{name:I,nameError:J,enabled:y,enabledError:K,modalId:m,modalStatus:o,isSuccess:F,isShowModalDetail:e,isShowDialogSwitch:O,isShowModalDelete:k,modalSuccessTitle:p,modalSuccessDetail:x,isModalSuccess:v,isModalDeleteError:E,errorMessage:V,paginate:f,modalTitle:g,formStatus:h,searchTerm:R,optionList:G,filter:j,actions:N,radioOptions:Y,columns:P,advancedTable:S,getData:i,onUpdateSwitch:L,onAcceptSwitch:X,onCloseSwitch:Z,openModalDelete:$,onDelete:ee,clearModal:U,changePage:te,closeModal:()=>{H(),e.value=!1},openModalAction:async(l,s=void 0)=>{if(l=="edit"){const T=await b("objectiveStore","edit",{payload:s});if(T.status===200){g.value="แบบฟอร์มแก้ไขวัตถุประสงค์";const M=T.data.result;w.value=M.id,I.value=M.name,y.value=M.enabled,m.value=s,h.value=!0,e.value=!0}}else if(l=="view"){const T=await b("objectiveStore","show",{payload:s});if(T.status===200){g.value="รายละเอียดวัตถุประสงค์";const M=T.data.result;I.value=M.name,y.value=M.enabled,m.value=s,h.value=!1,e.value=!0}}else l=="create"&&(m.value=s,h.value=!0,e.value=!0,g.value="แบบฟอร์มเพิ่มวัตถุประสงค์")},onSubmit:W,formatDateTh:l=>ce(l).locale("th").add(543,"year").format("DD MMM YYYY เวลา HH:mm น.")}}},Ie={class:"role_managment"},Te={class:"md:flex justify-between pb-6 md:space-y-0 space-y-3 items-center"},Oe={class:"basis-2/5"},je={class:"basis-1/2 flex gap-3"},Pe={class:"basis-1/2"},Ue={class:"basis-1/2"},Ae=a("div",{class:"text-center"},[a("div",{class:"text-gray-400"},"ไม่พบข้อมูล")],-1),Be={key:0},Fe={key:1},Re={key:2},Ge={key:3},Ne={class:"w-full"},Ye=["onClick"],qe=["onClick"],Le=["onClick"],He={class:"py-4 px-3"},ze={class:"list space-y-8 list-odd"},Qe={class:"flex py-2"},Je={class:"flex-1 flex gap-5 items-center"},Ke=a("div",{class:"text-sm font-medium text-slate-900 dark:text-slate-200 layout-flex text-end min-w-[35%] max-w-[35%]"},[D(" ชื่อวัตถุประสงค์ "),a("span",{class:"text-red-600"},"*")],-1),We={class:"text-slate-600 dark:text-slate-400 mb-1"},Xe={class:"flex py-2"},Ze={class:"flex-1 flex gap-5 items-center"},$e=a("div",{class:"text-sm font-medium text-slate-900 dark:text-slate-200 layout-flex text-end min-w-[35%] max-w-[35%]"}," การใช้งาน ",-1),et={class:"text-slate-600 dark:text-slate-400 mb-1 flex space-x-5"},tt=a("hr",{class:"mt-5 border"},null,-1),at={class:"text-center mt-4 flex justify-center w-full"},ot=a("h4",{class:"text-lg text-slate-900"},[D(" เปิด/ปิดใช้งานวัตถุประสงค์"),a("span",{class:"text-green-500"},"สำเร็จ")],-1),lt={class:"text-lg text-slate-900"},st=a("span",{class:"text-green-500"},"สำเร็จ",-1),nt={class:"text-lg text-slate-900"};function rt(m,o,F,e,O,k){const v=d("Button"),E=d("vSelect"),V=d("VueSelect"),f=d("InputGroup"),g=d("Switch"),p=d("Icon"),x=d("Dropdown"),h=d("Pagination"),w=d("vue-good-table"),R=d("Card"),G=d("Textinput"),j=d("Radio"),N=d("Modal"),Y=d("ChangeStatus"),P=d("ModalSuccess"),S=d("ConfirmDelete"),q=d("ModalError");return u(),_("div",Ie,[r(R,{noborder:""},{default:c(()=>[a("div",Te,[a("div",Oe,[r(v,{icon:"ic:baseline-plus",text:"เพิ่มวัตถุประสงค์",btnClass:"btn-primary rounded-md",onClick:o[0]||(o[0]=t=>e.openModalAction("create"))})]),a("div",je,[a("div",Pe,[r(V,null,{default:c(()=>[r(E,{placeholder:"เลือกสถานะ",modelValue:e.filter.status,"onUpdate:modelValue":o[1]||(o[1]=t=>e.filter.status=t),label:"title",class:"border rounded",reduce:t=>t.id,options:e.optionList,"onOption:selected":o[2]||(o[2]=t=>e.getData(1))},null,8,["modelValue","reduce","options"])]),_:1})]),a("div",Ue,[r(f,{modelValue:e.filter.keyword,"onUpdate:modelValue":o[3]||(o[3]=t=>e.filter.keyword=t),placeholder:"Search",classInputGroup:"border-gray-200",type:"text",prependIcon:"heroicons-outline:search",merged:"",inputEnter:"","onEvent:inputEnter":o[4]||(o[4]=t=>e.getData(1))},null,8,["modelValue"])])])]),r(w,{columns:e.columns,styleClass:" vgt-table bordered centered",rows:e.advancedTable,"pagination-options":{enabled:!0,perPage:e.paginate.perpage},"search-options":{enabled:!0,externalQuery:e.searchTerm},"sort-options":{enabled:!1}},{emptystate:c(()=>[Ae]),"table-row":c(t=>[t.column.field=="created_at"?(u(),_("span",Be,B(e.formatDateTh(t.row.created_at)),1)):C("",!0),t.column.field=="updated_at"?(u(),_("span",Fe,B(e.formatDateTh(t.row.updated_at)),1)):C("",!0),t.column.field=="enabled"?(u(),_("span",Re,[t.row.enabled?(u(),A(g,{key:0,label:"เปิดใช้งาน",activeClass:"bg-primary-500",active:!0,modelValue:t.row.enabled,"onUpdate:modelValue":i=>{t.row.enabled=i,e.modalId=t.row.id,e.onUpdateSwitch(t.row.id,i)}},null,8,["modelValue","onUpdate:modelValue"])):(u(),A(g,{key:1,label:"ปิดใช้งาน",activeClass:"bg-primary-500",active:!1,modelValue:t.row.enabled,"onUpdate:modelValue":i=>{t.row.enabled=i,e.modalId=t.row.id,e.onUpdateSwitch(t.row.id,i)}},null,8,["modelValue","onUpdate:modelValue"]))])):C("",!0),t.column.field=="action"?(u(),_("span",Ge,[r(x,{classMenuItems:"right-full  w-[220px] top-[110%] "},{menus:c(()=>[a("ul",Ne,[a("li",null,[a("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer",onClick:i=>e.openModalAction("edit",t.row.id)},[r(p,{icon:"bx:edit",class:"text-xl mr-2"}),D(" แก้ไข ")],8,Ye)]),a("li",null,[a("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer",onClick:i=>e.openModalAction("view",t.row.id)},[r(p,{icon:"grommet-icons:document-text",class:"text-xl mr-2"}),D(" ดูรายละเอียด ")],8,qe)]),a("li",null,[a("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer border-t text-red-500",onClick:i=>e.openModalDelete(t.row.id)},[r(p,{icon:"material-symbols:delete",class:"text-xl mr-2"}),D(" ลบ ")],8,Le)])])]),default:c(()=>[r(p,{icon:"pepicons-pencil:dots-x",class:"text-gray-400 text-4xl"})]),_:2},1024)])):C("",!0)]),"pagination-bottom":c(t=>[a("div",He,[r(h,{total:e.paginate.total,current:e.paginate.current_page,"per-page":e.paginate.perpage,pageRange:e.paginate.pageRange,onPageChanged:o[5]||(o[5]=i=>e.changePage(i)),pageChanged:t.pageChanged,perPageChanged:t.perPageChanged,textAfterInput:"ไปที่หน้า",enableSearch:"",enableInput:""},null,8,["total","current","per-page","pageRange","pageChanged","perPageChanged"])])]),_:1},8,["columns","rows","pagination-options","search-options"])]),_:1}),e.isShowModalDetail?(u(),A(N,{key:0,title:e.modalTitle,activeModal:e.isShowModalDetail,"onEvent:closeModal":o[10]||(o[10]=t=>e.isShowModalDetail=!1),label:"",labelClass:"btn-outline-dark",sizeClass:"w-2/4",centered:""},{default:c(()=>[a("form",{onSubmit:o[9]||(o[9]=se((...t)=>e.onSubmit&&e.onSubmit(...t),["prevent"])),class:"px-0 sm:px-12"},[a("div",ze,[a("div",Qe,[a("div",Je,[Ke,a("div",We,[r(G,{disabled:!e.formStatus,modelValue:e.name,"onUpdate:modelValue":o[6]||(o[6]=t=>e.name=t),error:e.nameError,classInput:"border border-gray-400 w-[275px]"},null,8,["disabled","modelValue","error"])])])]),a("div",Xe,[a("div",Ze,[$e,a("div",et,[(u(!0),_(oe,null,le(e.radioOptions,(t,i)=>(u(),_("div",{key:i},[r(j,{label:t.label,class:"mb-5",modelValue:e.enabled,"onUpdate:modelValue":o[7]||(o[7]=L=>e.enabled=L),error:e.enabledError,activeClass:t.activeClass,value:t.value,disabled:!e.formStatus},null,8,["label","modelValue","error","activeClass","value","disabled"])]))),128))])])])]),tt,a("div",at,[e.formStatus?(u(),A(v,{key:0,type:"submit",text:"บันทึก",btnClass:"btn-primary w-32 mx-2"})):C("",!0),r(v,{text:e.formStatus?"ยกเลิก":"ปิด",btnClass:"btn-outline-dark w-32 mx-2",onOnClick:o[8]||(o[8]=t=>e.closeModal())},null,8,["text"])])],32)]),_:1},8,["title","activeModal"])):C("",!0),r(Y,{title:"ยืนยันการเปิด/ปิดใช้งานวัตถุประสงค์",isOpen:e.isShowDialogSwitch,modalId:e.modalId,status:e.modalStatus,"onEvent:close":e.onCloseSwitch,"onEvent:success":e.onAcceptSwitch},null,8,["isOpen","modalId","status","onEvent:close","onEvent:success"]),r(P,{title:"เปิด/ปิดใช้งานวัตถุประสงค์",isOpen:e.isSuccess,"onEvent:closeModal":o[11]||(o[11]=t=>e.isSuccess=!1)},{default:c(()=>[ot]),_:1},8,["isOpen"]),r(S,{title:"ยืนยันการลบข้อมูล",isOpen:e.isShowModalDelete,modalId:e.modalId,errorMessage:e.errorMessage,"onEvent:delete":e.onDelete,"onEvent:close":e.clearModal,"onEvent:success":e.clearModal},null,8,["isOpen","modalId","errorMessage","onEvent:delete","onEvent:close","onEvent:success"]),r(P,{title:e.modalSuccessTitle,isOpen:e.isModalSuccess,"onEvent:closeModal":o[12]||(o[12]=t=>e.isModalSuccess=!1)},{default:c(()=>[a("h4",lt,[D(B(e.modalSuccessDetail)+" ",1),st])]),_:1},8,["title","isOpen"]),r(q,{title:"ลบข้อมูล",isOpen:e.isModalDeleteError,"onEvent:closeModal":o[13]||(o[13]=t=>e.isModalDeleteError=!1)},{default:c(()=>[a("h4",nt,B(e.errorMessage),1)]),_:1},8,["isOpen"])])}const qt=ue(Ve,[["render",rt]]);export{qt as default};
