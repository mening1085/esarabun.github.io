import{C as A}from"./index-cb5a08aa.js";import{I as M}from"./index-8d30ace7.js";import{B as O}from"./index-c2d6eb9c.js";import{V as W,C as X}from"./VueSelect-403231fd.js";import{M as P}from"./Modal-b54f1b5f.js";import{M as H}from"./index-8e7d66d6.js";import{R as z}from"./index-e163c14d.js";import{D as Y}from"./index-43a31f90.js";import{D as J}from"./index-976a2577.js";import{M as K}from"./index-28033082.js";import{_ as q,a as D,b as Q,t as I}from"./index-f91482a0.js";import{b as Z}from"./appex-chart-e4d84b07.js";import $ from"./colors-b4acbf58.js";import{I as ee}from"./index-2198f2cf.js";import{T as te}from"./index-3e8503e7.js";import{C as le}from"./index-325a54cb.js";import{E as F}from"./exceljs.min-7d2227ea.js";import{r as N,w as U}from"./xlsx-92a51129.js";import{C as oe}from"./index-8ecfca6d.js";import{o as f,x as p,bj as y,aF as v,as as c,p as s,aT as k,m as b,n as E,F as w,aD as x,w as B}from"./preload-helper-f37a9bec.js";import"./iconify-2baafea4.js";import"./transition-be7c09bc.js";import"./dom-b10fc197.js";import"./hidden-800255f5.js";import"./focus-management-94a631f4.js";import"./micro-task-89dcd6af.js";import"./open-closed-75edfb8a.js";import"./use-outside-click-156e41c1.js";import"./index-b704274e.js";import"./index-f2da45ff.js";import"./use-resolve-button-type-d7bee841.js";import"./vue-cleave.min-df5c8cc9.js";import"./ck-white-3501111f.js";const se={computed:{basicBar(){return Z}},components:{CFlatPickr:oe,Checkbox:le,Textinput:te,InputGroup:ee,ModalGraph:K,Dropdown:J,DatePickerRange:Y,Radio:z,Icon:M,Button:O,Card:A,VueSelect:W,vSelect:X,Modal:P,ModalSuccess:H},data(){return{filter:{dateType:"1",date:[],agency:null},item:{},dataTable:{},dataGraph:[],agencyItem:[],viewColumnName:[],dataRaw:[],showingGraph:!0,advenceSearch:!1,optionFormat:[{name:"หนังสือภายนอก"},{name:"หนังสือภายใน"},{name:"หนังสือประทับตรา"},{name:"หนังสือสั่งการ"},{name:"หนังสือประชาสัมพันธ์"},{name:"หนังสืออื่นๆ"}],optionSpeed:[{name:"ทั้งหมด"},{name:"ปกติ"},{name:"ด่วน"},{name:"ด่วนมาก"},{name:"ด่วนที่สุด"}],optionSecret:[{name:"ทั้งหมด"},{name:"ปกติ"},{name:"ลับ"},{name:"ลับมาก"},{name:"ลับที่สุด"}],optionStatus:[{name:"ทั้งหมด"},{name:"รอรับ"},{name:"บันทึกฉบับร่าง"},{name:"รอเสนอแนะ"},{name:"รอตรวจสอบ"},{name:"รอสั่งการ"},{name:"รอลงนาม"},{name:"สั่งการเสร็จสิ้น"},{name:"ลงนามเสร็จสิ้น"},{name:"ปฏิบัติงานเสร็จ"},{name:"ยกเลิก"},{name:"คืนเรื่อง"},{name:"ดึงกลับ"}],exportLists:[{id:1,label:"Microsoft Word",icon:"ant-design:file-word-filled"},{id:2,label:"Microsoft Excel",icon:"ant-design:file-excel-filled"},{id:3,label:"PDF",icon:"ant-design:file-pdf-filled"},{id:4,label:"RTF",icon:"grommet-icons:document-rtf"},{id:5,label:"HTML",icon:"bxs:file-html"}],filterDocTypeNormal:!1,filterDocTypeElec:!1,filterDocTypeEmail:!1,filterBookTypeCheckAll:!1,filterBookTypeCheckIn:!1,filterBookTypeCheckOut:!1,editMode:!0,advenceFilter:{word:"",year:null,no:null,book_type:null,doc_type:null,rev_no:null,date:null,from:null,to:null,doc_format:null,speed:null,secret:null,status:null},changeYear:!1,changeBookFormat:!1,changeBookType:!1,changeBookDate:!1,changeNo:!1,changeDocType:!1,changeFrom:!1,changeTo:!1,changeSpeed:!1}},watch:{},async created(){await this.getData()},methods:{changeTypeToThai(l){return l==="inside"?"ภายใน":l==="outside"?"ภายนอก":l},async searchAdvance(){var d,i,e,n,r,a;this.advenceFilter.book_type=`${this.filterBookTypeCheckAll},${this.filterBookTypeCheckIn},${this.filterBookTypeCheckOut}`,this.advenceFilter.doc_type=`${this.filterDocTypeNormal},${this.filterDocTypeElec},${this.filterDocTypeEmail}`,this.advenceFilter.doc_format=(d=this.advenceFilter.doc_format)==null?void 0:d.name,this.advenceFilter.secret=(i=this.advenceFilter.secret)==null?void 0:i.name,this.advenceFilter.speed=(e=this.advenceFilter.speed)==null?void 0:e.name,this.advenceFilter.status=(n=this.advenceFilter.status)==null?void 0:n.name;let l={...this.item,...this.advenceFilter};l.year&&(l.filter_year=l.year),l.doc_format&&(l.filter_book_format=l.doc_format),(this.filterBookTypeCheckAll||this.filterBookTypeCheckIn||this.filterBookTypeCheckOut)&&(l.filter_book_type=l.book_type),l.date&&(l.filter_date_type="วันที่ลง",l.filter_date_start=l.date,l.filter_date_end=null),l.rev_no&&(l.filter_no_start=l.rev_no,l.filter_no_type="ระบุเลข"),l.no&&(l.document_number=l.no),l.doc_type&&(l.filter_doc_type=l.doc_type);const t=await D("reportImportStore","search",{payload:l});this.dataRaw=(a=(r=t.data)==null?void 0:r.result)==null?void 0:a.data},clearFilter(){this.filterDocTypeNormal=!1,this.filterDocTypeElec=!1,this.filterDocTypeEmail=!1,this.advenceFilter={word:"",year:null,no:null,doc_type:null,rev_no:null,date:null,from:null,to:null,doc_format:null,speed:null,secret:null,status:null},this.searchAdvance()},setChange(l){l=l.split(","),this.changeYear=l[0]!=="true",this.changeBookFormat=l[1]!=="true",this.changeBookType=l[2]!=="true",this.changeBookDate=l[3]!=="true",this.changeNo=l[4]!=="true",this.changeDocType=l[5]!=="true",this.changeFrom=l[6]!=="true",this.changeTo=l[7]!=="true",this.changeSpeed=l[8]!=="true"},goCreate(){},goEdit(l){},async onDelete(l){},async onFilter(){var t,d,i,e,n,r,a,u,m,g;let l={id:this.$router.currentRoute.value.params.id,date:null,agency:null};if(this.filter.date&&this.filter.date.length>0&&(l.date=this.filter.date),this.filter.agency&&(l.agency=this.filter.agency),l.date||l.agency){const h=await D("reportImportStore","get",{payload:l});(t=h.data)!=null&&t.result&&(this.item=(i=(d=h.data)==null?void 0:d.result)==null?void 0:i.data,this.dataRaw=(n=(e=h.data)==null?void 0:e.result)==null?void 0:n.dataRaw,this.dataTable=(a=(r=h.data)==null?void 0:r.result)==null?void 0:a.dataGraph.dataTable,this.viewColumnName=JSON.parse((u=this.item)==null?void 0:u.view_column_field),this.dataGraph=[],this.dataGraph.push(this.generateGraph((g=(m=h.data)==null?void 0:m.result)==null?void 0:g.dataGraph)),this.showingGraph=this.item.view_show==="แสดง")}},async getData(){var d,i,e,n,r,a,u,m,g,h,C;let l={id:this.$router.currentRoute.value.params.id,date:null,date_type:this.filter.dateType,agency:null};const t=await D("reportImportStore","get",{payload:l});(i=(d=t.data)==null?void 0:d.result)!=null&&i.data&&(this.item=(n=(e=t.data)==null?void 0:e.result)==null?void 0:n.data,this.setChange(this.item.changes),this.dataRaw=(a=(r=t.data)==null?void 0:r.result)==null?void 0:a.dataRaw,this.dataTable=(m=(u=t.data)==null?void 0:u.result)==null?void 0:m.dataGraph.dataTable,this.viewColumnName=JSON.parse((g=this.item)==null?void 0:g.view_column_field),this.dataGraph.push(this.generateGraph((C=(h=t.data)==null?void 0:h.result)==null?void 0:C.dataGraph)),this.showingGraph=this.item.view_show==="แสดง")},generateGraph(l){const t=l.id,d=l.name,i=l.chartType;let e;l.chartType==="donut"?e=l.data:e=[{data:l.data}];const n={chart:{id:"custom_chart_0",type:l.chartType,toolbar:{show:!1}},dataLabels:{enabled:l.showLabel},stroke:{curve:"straight"},markers:{size:l.markers?4:0,colors:"#fff",strokeColors:$.primary,strokeWidth:2,shape:"circle",radius:2,hover:{sizeOffset:1}},labels:l.dataLabel,legend:{itemMargin:{vertical:5},width:200,offsetX:10,offsetY:60,formatter:function(r,a){let u=parseFloat(a.w.globals.series[a.seriesIndex]/a.w.globals.series.reduce((m,g)=>m+g,0)*100).toFixed(2)+"%";return r+" "+u}},yaxis:[{min:0,tickAmount:10}],xaxis:{labels:{rotate:300}},plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!1},value:{show:!0,fontSize:"40px",offsetY:15,formatter:function(r){return r}},total:{show:!0,label:"",color:"#373d3f",formatter:function(r){return r.globals.series.reduce((a,u)=>a+u,0)}}}}}},noData:{text:"No data",align:"center",verticalAlign:"middle",offsetX:0,offsetY:0,style:{fontSize:"40px"}}};return{id:t,name:d,series:e,options:n,chartType:i}},async handleExport(l){let t=[],d=[];if(this.showingGraph){for(const e in this.dataTable)t.push({date:this.dataTable[e].monthTh+"-"+(this.dataTable[e].year+543),count:this.dataTable[e].count});d=["เดือน-ปี","จำนวน"]}else{for(const e in this.viewColumnName)if(this.viewColumnName[e].name!=="กลุ่ม (แสดง 2 บรรทัด)")d.push(this.viewColumnName[e].name);else{let n=[];for(let r=0;r<this.viewColumnName[e].children.length;r++)n.push(this.viewColumnName[e].children[r].name);d.push(n.join("/"))}for(const e in this.dataRaw){let n=[];for(let r=0;r<this.viewColumnName.length;r++)if(this.viewColumnName[r].children){let a=[];for(const u in this.viewColumnName[r].children)a.push(this.changeTypeToThai(this.dataRaw[e][this.viewColumnName[r].children[u].field]));n.push(a.join("/"))}else n.push(this.changeTypeToThai(this.dataRaw[e][this.viewColumnName[r].field]));t.push(n)}}let i;this.showingGraph&&(i=await this.saveToArchive("custom_chart_0")),l.id==1?this.exportToWord(t,(i==null?void 0:i.imgURI)??"",d):l.id==2?this.exportToExcel(t,(i==null?void 0:i.imgURI)??"",d):l.id==3?this.exportToPdf(t,(i==null?void 0:i.imgURI)??"",d):l.id==4?this.exportToRtf(t,"",d):l.id==5&&this.exportToHtml(t,"",d)},async saveToArchive(l){return await window.ApexCharts.getChartByID(l).dataURI()},async sendToServer(l,t,d){try{const i=new FormData;i.append("excelFile",l,"downloaded-file.xlsx"),t&&i.append("base64Image",t);const e=await Q.post(I+"/fix/convert-to-"+d,i);d==="pdf"?window.open(`${I}/public/tempFile/${e.data.result.data.fileName}.${d}`,"_blank"):window.open(`${I}/public/tempFile/${e.data.result.data.fileName}.${d}`,"_parent","download")}catch(i){console.error("Error sending file to server:",i)}},async exportToExcel(l,t,d){const i=new F.Workbook,e=i.addWorksheet("Sheet1");if(t){const n=i.addImage({base64:t,extension:"png"});e.addImage(n,{tl:{col:0,row:0},ext:{width:1200,height:380}})}e.getRow(t?12:1).values=d;for(const n of l)this.showingGraph?e.addRow([n.date,n.count]):e.addRow([...n]);this.adjustColumnWidth(e),this.setTextCenter(e),i.xlsx.writeBuffer().then(n=>{const r=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a="exported_data.xlsx",u=document.createElement("a");u.href=URL.createObjectURL(r),u.download=a,document.body.appendChild(u),u.click(),document.body.removeChild(u)})},async exportToWord(l,t,d){const i=new F.Workbook,e=i.addWorksheet("Sheet1");if(t){const a=i.addImage({base64:t,extension:"png"});e.addImage(a,{tl:{col:0,row:0},ext:{width:1600,height:380}})}e.getRow(t?12:1).values=d;for(const a of l)e.addRow([a.name,a.type,a.number]);this.adjustColumnWidth(e),this.setTextCenter(e);const n=await i.xlsx.writeBuffer(),r=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});await this.sendToServer(r,t,"docx")},async exportToPdf(l,t,d){const i=new F.Workbook,e=i.addWorksheet("Sheet1");if(e.pageSetup={orientation:"landscape"},t){const a=i.addImage({base64:t,extension:"png"});e.addImage(a,{tl:{col:0,row:0},ext:{width:600,height:300}})}e.getRow(t?12:1).values=d;for(const a of l)e.addRow([a.name,a.type,a.number]);this.adjustColumnWidth(e),this.setTextCenter(e,!0);const n=await i.xlsx.writeBuffer(),r=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});await this.sendToServer(r,null,"pdf")},async convertXLSXToRTF(l){const t=new ArrayBuffer(l.length);new Uint8Array(t).set(l);const i=N(t);return U(i,{sheet:0,bookType:"rtf",type:"buffer"})},async convertXLSXToHTML(l){console.log("convertXLSXToHTML");const t=new ArrayBuffer(l.length);new Uint8Array(t).set(l);const i=N(t),e={sheet:0,bookType:"html",type:"buffer"};return console.log("convertXLSXToHTML end"),U(i,e)},async exportToRtf(l,t,d){const i=new F.Workbook,e=i.addWorksheet("Sheet1");if(e.pageSetup={orientation:"landscape"},t){const m=i.addImage({base64:t,extension:"png"});e.addImage(m,{tl:{col:0,row:0},ext:{width:600,height:300}})}e.getRow(t?12:1).values=d;for(const m of l)e.addRow([m.name,m.type,m.number]);this.adjustColumnWidth(e),this.setTextCenter(e,!0);const n=await i.xlsx.writeBuffer();let r=await this.convertXLSXToRTF(n);const a=new Blob([r],{type:"application/rtf"}),u=document.createElement("a");u.href=window.URL.createObjectURL(a),u.download="rtf_report.rtf",u.click()},async exportToHtml(l,t,d){const i=new F.Workbook,e=i.addWorksheet("Sheet1");if(e.pageSetup={orientation:"landscape"},t){const m=i.addImage({base64:t,extension:"png"});e.addImage(m,{tl:{col:0,row:0},ext:{width:600,height:300}})}e.getRow(t?12:1).values=d;for(const m of l)e.addRow([m.name,m.type,m.number]);this.adjustColumnWidth(e),this.setTextCenter(e,!0);const n=await i.xlsx.writeBuffer();let r=await this.convertXLSXToHTML(n);const a=new Blob([r],{type:"application/html"}),u=document.createElement("a");u.href=window.URL.createObjectURL(a),u.download="html_report.html",u.click()},adjustColumnWidth(l){l.columns.forEach(t=>{const d=t.values.map(e=>e.toString().length),i=Math.max(...d.filter(e=>typeof e=="number"));t.width=i*.7})},setTextCenter(l,t=!1){const e=l.lastRow.number;for(let n=0;n<=e;n++){const r=l.getRow(n);r.height=30,r.eachCell({includeEmpty:!0},a=>{t&&(a.font={size:10}),a.alignment={wrapText:!0},a.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}}}},ie={class:"report-management"},ne={class:"md:flex justify-between pb-6 md:space-y-0 space-y-3 items-center"},ae={key:0,class:"flex flex-row-reverse"},re={class:"basis-1/5 ml-5"},de={class:"basis-2/5 ml-5"},ce=s("div",{class:"basis-2/12 flex justify-end items-center"},[s("div",null,"กำหนดช่วงเวลา")],-1),pe={class:"basis-1/5"},ue={class:"flex items-center"},me=s("span",{class:"px-2"},"Export",-1),fe={key:1,class:"flex flex-row-reverse"},he={class:"basis-2/5 inline-flex"},ye={class:"basis-full"},be=s("div",{class:"basis-2/5"},null,-1),_e={class:"basis-1/5"},ve={class:"flex items-center"},we=s("span",{class:"px-2"},"Export",-1),ge={key:2,class:"flex flex-wrap advance-search"},ke={class:"basis-full inline-flex"},xe=s("div",{class:"basis-1/6 pt-2 pr-4 flex justify-end"}," คำค้นจากแหล่งข้อมูล ",-1),Te={class:"basis-5/6"},Ce={class:"basis-full inline-flex mt-2"},Ve=s("div",{class:"basis-2/12 pt-2 pr-4 flex justify-end"},"ปี",-1),Fe={class:"basis-4/12"},Be=s("div",{class:"basis-2/12 pt-2 pr-4 flex justify-end"},"เลขหนังสือ",-1),De={class:"basis-4/12"},Ie={class:"basis-full inline-flex mt-2"},Re={class:"basis-full flex flex-wrap"},Se=s("div",{class:"basis-2/12 pr-4 flex justify-end"},"ประเภทหนังสือ",-1),Ne={class:"flex align-items-center mr-10"},Ue={class:"flex align-items-center mr-10"},Ee={class:"flex align-items-center"},je={class:"basis-full inline-flex mt-2"},Ge={class:"basis-full flex flex-wrap"},Le=s("div",{class:"basis-2/12 pr-4 flex justify-end"},"ประเภทเอกสาร",-1),Ae={class:"flex align-items-center mr-10"},Me={class:"flex align-items-center mr-10"},Oe={class:"flex align-items-center"},We={class:"basis-full inline-flex mt-2"},Xe=s("div",{class:"basis-2/12 pt-2 pr-4 flex justify-end"},"เลขรับหนังสือ",-1),Pe={class:"basis-4/12"},He=s("div",{class:"basis-2/12 pt-2 pr-4 flex justify-end"},"วันที่หนังสือ",-1),ze={class:"basis-4/12"},Ye={class:"basis-full inline-flex mt-2"},Je=s("div",{class:"basis-2/12 pt-2 pr-4 flex justify-end"},"จาก",-1),Ke={class:"basis-4/12"},qe=s("div",{class:"basis-2/12 pt-2 pr-4 flex justify-end"},"ถึง",-1),Qe={class:"basis-4/12"},Ze={class:"basis-full inline-flex mt-2"},$e=s("div",{class:"basis-2/12 pt-2 pr-4 flex justify-end"},"รูปแบบหนังสือ",-1),et={class:"basis-4/12"},tt=s("div",{class:"basis-2/12 pt-2 pr-4 flex justify-end"},"ชั้นความเร็ว",-1),lt={class:"basis-4/12"},ot={class:"basis-full inline-flex mt-2"},st=s("div",{class:"basis-2/12 pt-2 pr-4 flex justify-end"},"ชั้นความลับ",-1),it={class:"basis-4/12"},nt=s("div",{class:"basis-2/12 pt-2 pr-4 flex justify-end"},"สถานะ",-1),at={class:"basis-4/12"},rt={class:"basis-full inline-flex mt-2"},dt={class:"basis-full pt-2 pr-4 flex justify-end"},ct={key:3,class:"my-5"},pt={key:0,class:"w-full border-collapse border-none text-center"},ut=s("tr",null,[s("th",null,"เดือน-ปี"),s("th",null,"จำนวน")],-1),mt={key:1,width:"100%",class:"mt-5"},ft={class:"text-left"},ht={class:"text-left"},yt=s("br",null,null,-1);function bt(l,t,d,i,e,n){const r=v("vSelect"),a=v("VueSelect"),u=v("CFlatPickr"),m=v("DatePickerRange"),g=v("Icon"),h=v("Button"),C=v("Dropdown"),j=v("InputGroup"),T=v("Textinput"),_=v("Checkbox"),G=v("apexchart"),R=v("Card");return c(),f("div",ie,[p(R,{noborder:""},{default:y(()=>[s("div",ne,[s("div",null,[s("span",null,k(e.item.report_name),1)])]),e.showingGraph?(c(),f("div",ae,[s("div",re,[p(a,{classInput:"input_color"},{default:y(()=>[p(r,{modelValue:e.filter.agency,"onUpdate:modelValue":t[0]||(t[0]=o=>e.filter.agency=o),placeholder:"หน่วยงานทั้งหมด",label:"organization_name",class:"input_color border rounded",reduce:o=>o.id,options:e.agencyItem,"onOption:selected":n.onFilter},null,8,["modelValue","reduce","options","onOption:selected"])]),_:1})]),s("div",de,[p(m,null,{default:y(()=>[p(u,{class:"w-full",placeholder:"เลือกวันที่",config:{mode:"range"},modelValue:e.filter.date,"onUpdate:modelValue":t[1]||(t[1]=o=>e.filter.date=o),onInput:t[2]||(t[2]=o=>n.onFilter())},null,8,["modelValue"])]),_:1})]),ce,s("div",pe,[p(C,{classMenuItems:"left-0  w-[220px] top-[110%]",items:e.exportLists,onOnClickItem:n.handleExport},{default:y(()=>[p(h,{btnClass:"btn-primary text-slate-50",div:"",iconClass:"text-lg"},{default:y(()=>[s("div",ue,[p(g,{icon:"ic:baseline-cloud-download",class:"handle text-[20px]"}),me])]),_:1})]),_:1},8,["items","onOnClickItem"])])])):(c(),f("div",fe,[s("div",he,[s("div",ye,[p(j,{modelValue:e.filter.search,"onUpdate:modelValue":t[3]||(t[3]=o=>e.filter.search=o),placeholder:"ค้นหา",type:"text",prependIcon:"heroicons-outline:search",merged:"",inputEnter:!0,"onEvent:inputEnter":t[4]||(t[4]=o=>n.onFilter())},null,8,["modelValue"])]),p(h,{icon:"icons8:download-2",text:"ค้นหาขั้นสูง",btnClass:"btn-primary rounded-md ml-3",onClick:t[5]||(t[5]=o=>e.advenceSearch=!e.advenceSearch)})]),be,s("div",_e,[p(C,{classMenuItems:"left-0  w-[220px] top-[110%]",items:e.exportLists,onOnClickItem:n.handleExport},{default:y(()=>[p(h,{btnClass:"btn-primary text-slate-50",div:"",iconClass:"text-lg"},{default:y(()=>[s("div",ve,[p(g,{icon:"ic:baseline-cloud-download",class:"handle text-[20px]"}),we])]),_:1})]),_:1},8,["items","onOnClickItem"])])])),e.advenceSearch?(c(),f("div",ge,[s("div",ke,[xe,s("div",Te,[p(T,{classInput:"border border-gray-400",placeholder:"ป้อนคำที่ตรงกับส่วนหนึ่งของชื่อไฟล์",modelValue:e.advenceFilter.word,"onUpdate:modelValue":t[6]||(t[6]=o=>e.advenceFilter.word=o)},null,8,["modelValue"])])]),s("div",Ce,[Ve,s("div",Fe,[p(T,{classInput:"border border-gray-400",placeholder:"",disabled:e.changeYear,readonly:"",modelValue:e.advenceFilter.year,"onUpdate:modelValue":t[7]||(t[7]=o=>e.advenceFilter.year=o)},null,8,["disabled","modelValue"])]),Be,s("div",De,[p(T,{classInput:"border border-gray-400",placeholder:"",modelValue:e.advenceFilter.no,disabled:e.changeNo,"onUpdate:modelValue":t[8]||(t[8]=o=>e.advenceFilter.no=o)},null,8,["modelValue","disabled"])])]),s("div",Ie,[s("div",Re,[Se,s("div",Ne,[e.filterBookTypeCheckAll&&e.editMode?(c(),b(_,{key:0,label:"ทั้งหมด",modelValue:e.filterBookTypeCheckAll,"onUpdate:modelValue":t[9]||(t[9]=o=>e.filterBookTypeCheckAll=o),disabled:e.changeBookType,checked:"",activeClass:"ring-primary-500 bg-primary-500"},null,8,["modelValue","disabled"])):(c(),b(_,{key:1,label:"ทั้งหมด",disabled:e.changeBookType,modelValue:e.filterBookTypeCheckAll,"onUpdate:modelValue":t[10]||(t[10]=o=>e.filterBookTypeCheckAll=o),activeClass:"ring-primary-500 bg-primary-500"},null,8,["disabled","modelValue"]))]),s("div",Ue,[e.filterBookTypeCheckIn&&e.editMode?(c(),b(_,{key:0,label:"หนังสือรับภายใน",modelValue:e.filterBookTypeCheckIn,"onUpdate:modelValue":t[11]||(t[11]=o=>e.filterBookTypeCheckIn=o),disabled:e.changeBookType,checked:"",activeClass:"ring-primary-500 bg-primary-500"},null,8,["modelValue","disabled"])):(c(),b(_,{key:1,label:"หนังสือรับภายใน",disabled:e.changeBookType,modelValue:e.filterBookTypeCheckIn,"onUpdate:modelValue":t[12]||(t[12]=o=>e.filterBookTypeCheckIn=o),activeClass:"ring-primary-500 bg-primary-500"},null,8,["disabled","modelValue"]))]),s("div",Ee,[e.filterBookTypeCheckOut&&e.editMode?(c(),b(_,{key:0,label:"หนังสือรับภายนอก",modelValue:e.filterBookTypeCheckOut,"onUpdate:modelValue":t[13]||(t[13]=o=>e.filterBookTypeCheckOut=o),checked:"",disabled:e.changeBookType,activeClass:"ring-primary-500 bg-primary-500"},null,8,["modelValue","disabled"])):(c(),b(_,{key:1,label:"หนังสือรับภายนอก",disabled:e.changeBookType,modelValue:e.filterBookTypeCheckOut,"onUpdate:modelValue":t[14]||(t[14]=o=>e.filterBookTypeCheckOut=o),activeClass:"ring-primary-500 bg-primary-500"},null,8,["disabled","modelValue"]))])])]),s("div",je,[s("div",Ge,[Le,s("div",Ae,[e.filterDocTypeNormal&&e.editMode?(c(),b(_,{key:0,label:"เอกสารทั่วไป (ส่งฉบับจริง)",modelValue:e.filterDocTypeNormal,"onUpdate:modelValue":t[15]||(t[15]=o=>e.filterDocTypeNormal=o),disabled:e.changeDocType,checked:"",activeClass:"ring-primary-500 bg-primary-500"},null,8,["modelValue","disabled"])):(c(),b(_,{key:1,label:"เอกสารทั่วไป (ส่งฉบับจริง)",disabled:e.changeDocType,modelValue:e.filterDocTypeNormal,"onUpdate:modelValue":t[16]||(t[16]=o=>e.filterDocTypeNormal=o),activeClass:"ring-primary-500 bg-primary-500"},null,8,["disabled","modelValue"]))]),s("div",Me,[e.filterDocTypeElec&&e.editMode?(c(),b(_,{key:0,label:"เอกสารอิเล็กทรอนิกส์",modelValue:e.filterDocTypeElec,"onUpdate:modelValue":t[17]||(t[17]=o=>e.filterDocTypeElec=o),disabled:e.changeDocType,checked:"",activeClass:"ring-primary-500 bg-primary-500"},null,8,["modelValue","disabled"])):(c(),b(_,{key:1,label:"เอกสารอิเล็กทรอนิกส์",disabled:e.changeDocType,modelValue:e.filterDocTypeElec,"onUpdate:modelValue":t[18]||(t[18]=o=>e.filterDocTypeElec=o),activeClass:"ring-primary-500 bg-primary-500"},null,8,["disabled","modelValue"]))]),s("div",Oe,[e.filterDocTypeEmail&&e.editMode?(c(),b(_,{key:0,label:"รับจากอีเมล",modelValue:e.filterDocTypeEmail,"onUpdate:modelValue":t[19]||(t[19]=o=>e.filterDocTypeEmail=o),disabled:e.changeDocType,checked:"",activeClass:"ring-primary-500 bg-primary-500"},null,8,["modelValue","disabled"])):(c(),b(_,{key:1,label:"หนังสือรับจากอีเมล",disabled:e.changeDocType,modelValue:e.filterDocTypeEmail,"onUpdate:modelValue":t[20]||(t[20]=o=>e.filterDocTypeEmail=o),activeClass:"ring-primary-500 bg-primary-500"},null,8,["disabled","modelValue"]))])])]),s("div",We,[Xe,s("div",Pe,[p(T,{classInput:"border border-gray-400",placeholder:"",modelValue:e.advenceFilter.rev_no,"onUpdate:modelValue":t[21]||(t[21]=o=>e.advenceFilter.rev_no=o)},null,8,["modelValue"])]),He,s("div",ze,[p(m,null,{default:y(()=>[p(u,{modelValue:e.advenceFilter.date,"onUpdate:modelValue":t[22]||(t[22]=o=>e.advenceFilter.date=o),disabled:e.changeBookDate,class:"w-full",placeholder:"เลือกวันที่"},null,8,["modelValue","disabled"])]),_:1})])]),s("div",Ye,[Je,s("div",Ke,[p(T,{classInput:"border border-gray-400",placeholder:"",modelValue:e.advenceFilter.from,disabled:e.changeFrom,"onUpdate:modelValue":t[23]||(t[23]=o=>e.advenceFilter.from=o)},null,8,["modelValue","disabled"])]),qe,s("div",Qe,[p(T,{classInput:"border border-gray-400",placeholder:"",modelValue:e.advenceFilter.to,disabled:e.changeTo,"onUpdate:modelValue":t[24]||(t[24]=o=>e.advenceFilter.to=o)},null,8,["modelValue","disabled"])])]),s("div",Ze,[$e,s("div",et,[p(a,{classInput:"input_color"},{default:y(()=>[p(r,{placeholder:"เลือก",label:"name",disabled:e.changeBookFormat,class:"input_color border rounded",modelValue:e.advenceFilter.doc_format,"onUpdate:modelValue":t[25]||(t[25]=o=>e.advenceFilter.doc_format=o),options:e.optionFormat},null,8,["disabled","modelValue","options"])]),_:1})]),tt,s("div",lt,[p(a,{classInput:"input_color"},{default:y(()=>[p(r,{placeholder:"เลือก",label:"name",class:"input_color border rounded",disabled:e.changeSpeed,modelValue:e.advenceFilter.speed,"onUpdate:modelValue":t[26]||(t[26]=o=>e.advenceFilter.speed=o),options:e.optionSpeed},null,8,["disabled","modelValue","options"])]),_:1})])]),s("div",ot,[st,s("div",it,[p(a,{classInput:"input_color"},{default:y(()=>[p(r,{placeholder:"เลือก",label:"name",class:"input_color border rounded",modelValue:e.advenceFilter.secret,"onUpdate:modelValue":t[27]||(t[27]=o=>e.advenceFilter.secret=o),options:e.optionSecret},null,8,["modelValue","options"])]),_:1})]),nt,s("div",at,[p(a,{classInput:"input_color"},{default:y(()=>[p(r,{placeholder:"เลือก",label:"name",class:"input_color border rounded",modelValue:e.advenceFilter.status,"onUpdate:modelValue":t[28]||(t[28]=o=>e.advenceFilter.status=o),options:e.optionStatus},null,8,["modelValue","options"])]),_:1})])]),s("div",rt,[s("div",dt,[p(h,{icon:"material-symbols-light:search",text:"ค้นหา",btnClass:"btn-primary rounded-md mr-5",onClick:n.searchAdvance},null,8,["onClick"]),p(h,{icon:"system-uicons:cross",text:"ล้างข้อมูล",btnClass:"btn-danger rounded-md",onClick:n.clearFilter},null,8,["onClick"])])])])):E("",!0),e.showingGraph?(c(),f("div",ct,[p(R,null,{default:y(()=>[(c(!0),f(w,null,x(e.dataGraph,o=>(c(),b(G,{type:o.chartType,height:"360",width:"100%",options:o.options,series:o.series},null,8,["type","options","series"]))),256))]),_:1})])):E("",!0),s("div",null,[e.showingGraph?(c(),f("table",pt,[ut,(c(!0),f(w,null,x(e.dataTable,o=>(c(),f("tr",null,[s("td",null,k(o.monthTh+"-"+(o.year+543)),1),s("td",null,k(o.count),1)]))),256))])):(c(),f("table",mt,[s("tr",null,[(c(!0),f(w,null,x(e.viewColumnName,o=>(c(),f("th",ft,[o.name!=="กลุ่ม (แสดง 2 บรรทัด)"?(c(),f(w,{key:0},[B(k(o.name),1)],64)):(c(!0),f(w,{key:1},x(o.children,(S,V)=>(c(),f(w,null,[B(k(S.name)+" "+k(V!=o.children.length-1?"/":""),1)],64))),256))]))),256))]),(c(!0),f(w,null,x(e.dataRaw,(o,S)=>(c(),f("tr",null,[(c(!0),f(w,null,x(e.viewColumnName.length,V=>(c(),f("td",ht,[e.viewColumnName[V-1].children?(c(!0),f(w,{key:0},x(e.viewColumnName[V-1].children,L=>(c(),f(w,null,[B(k(n.changeTypeToThai(o[L.field]))+" ",1),yt],64))),256)):(c(),f(w,{key:1},[B(k(n.changeTypeToThai(o[e.viewColumnName[V-1].field])),1)],64))]))),256))]))),256))]))])]),_:1})])}const Qt=q(se,[["render",bt]]);export{Qt as default};
