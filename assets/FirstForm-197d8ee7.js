import{E as se}from"./index-1c6333b5.js";import{B as U}from"./index-441935dc.js";import{I as R}from"./index-72ee420c.js";import{T as oe}from"./TextValid-100be459.js";import{C as ne,V as le}from"./VueSelect-4c8519b3.js";import{T as A}from"./index-31d1a8ca.js";import{aA as a,be as y,aF as g,as as k,o as O,m as ie,bj as V,p as n,x as u,F as ce,aD as de,aT as F,n as B,al as re,bo as ue}from"./preload-helper-9e0646ca.js";import{M as me}from"./index-1b218db3.js";import{C as N}from"./index-8994827d.js";import{R as ve}from"./index-3069c0b6.js";import{a as G,_ as P,u as _e}from"./index-e058a960.js";import{l as fe,a as be,n as pe,r as ge,u as xe}from"./tabs-aa384b53.js";import{M as Ie}from"./index-96a9bfa7.js";const ye={name:"ModalOrganizeIn",components:{Modal:me,Button:U,Icon:R,TabGroup:fe,TabList:be,Tab:pe,TabPanels:ge,TabPanel:xe,Checkbox:N,TextInput:A,Radio:ve},props:["tabIndex","title","isOpen","organizeList","userList","checkedID","checkedItemRadio","customList"],setup(l,{emit:o,expose:v}){console.log("props",l.tabIndex);const t=a(null),z=a(l.title||""),h=a(l.isOpen||!1),f=a(l.organizeList||[]),b=a(l.checkedID||""),x=a(l.checkedItemRadio||{}),p=a(l.customList||[]),m=a(l.userList||[]),i=a(null),_=a([]),d=a({}),S=a([{title:"หน่วยงานภายใน"},{title:"บุคคล"},{title:"กำหนดเอง"}]),E=a(0),T=a(l.tabIndex),I=a([]),C=a([]),D=a(""),M=a({});y(()=>l.tabIndex,e=>{T.value=e||""}),y(()=>l.title,e=>{z.value=e||""}),y(()=>l.isOpen,e=>{h.value=e||!1}),y(()=>l.organizeList,e=>{f.value=e}),y(()=>l.userList,e=>{m.value=e}),y(()=>l.customList,e=>{p.value=e}),y(()=>l.checkedID,e=>{b.value=e||""}),y(()=>l.checkedItemRadio,e=>{x.value=e});const j=e=>{T.value=e,e!=2&&(_.value=[])},c=()=>{t.value="",i.value=null},L=e=>{console.log(e);const s=i.value.find(r=>r.data_id===e.id&&r.data_type=="users");s?w(s):q(e)},q=e=>{I.value.push(e),i.value.push({icon:"mingcute:user-4-fill",data_id:e.id,name:e.full_name,email:e.email,data_type:"users"}),I.value.sort((s,r)=>s-r)},w=e=>{I.value=I.value.filter(r=>r.id!=e.data_id);let s=i.value.findIndex(r=>r.data_id===e.data_id&&r.data_type==="users");s!==-1&&i.value.splice(s,1)},H=e=>{i.value={data_id:e.id,organization_name:e.organization_name,emails:e.organization_emails.map(s=>({email:s.email})),email:""}},J=e=>{console.log("val",e),C.value=C.value.filter(r=>r.id!=e.data_id);let s=i.value.findIndex(r=>r.data_id===e.data_id&&r.data_type==="organizations");s!==-1&&i.value.splice(s,1)},K=e=>{},Q=(e,s)=>{s?X(e):W(e)},W=e=>{_.value=_.value.filter(s=>s.id!=e.id)},X=e=>{e.group_data.forEach(s=>{console.log("baby dont hurt",s),_.value.push({id:e.id,icon:s.icon,data_id:s.id,name:s.name,emails:s.emails?s.emails:[],email:s.email?s.email:"",data_type:s.data_type})})},Y=e=>!!C.value.find(r=>r.id===e.id),Z=e=>!!I.value.find(r=>r.id===e.id),$=async()=>{M.value={name:D.value,group_data:i.value},console.log("groupItem",M.value);const{data:e,status:s}=await G("customGroupStore","store",{payload:M.value});s==200&&(console.log("data",e),p.value.push(e.result))},ee=()=>{t.value=null,D.value="",C.value=[],I.value=[],i.value=[],h.value=!1},te=async()=>{o("event:accept",i.value),_.value=[]},ae=()=>{console.log("closeModal"),ee(),o("event:close")};return v({removeItemgroupObject:c}),{title:z,isOpen:h,buttons:S,selected:E,organizeList:f,organizations:C,groupItems:M,group_name:D,selectedTab:T,groupObject:i,users:I,customArray:_,radioItem:t,checkedID:b,checkedItemRadio:x,changeTab:j,selectedItems:H,removeItem:J,selectedItemUser:L,removeItemUser:w,checkedItem:Y,onSave:$,onAcceptSwitch:te,closeModal:ae,removeItemgroupObject:c,checkedItemUser:Z,checkedItemCustom:K,selectedItemsCustom:Q,objectTest:d}}},he={class:"flex"},ke={class:"basis-2/3 border-r py-3"},Ce={class:"flex text-lg space-x-3"},Le={key:0,class:"basis-1/3 py-3"},Oe={class:"pl-3"},ze={class:"flex justify-between items-center border bg-gray-100 p-2 my-3 rounded"},Me={class:"flex text-sm"},Te={class:"ell-1 px-2"},De={class:"text-center my-4 flex justify-center w-full"};function Ve(l,o,v,t,z,h){const f=g("Radio"),b=g("Icon"),x=g("Button"),p=g("Modal");return k(),O("div",null,[t.isOpen?(k(),ie(p,{key:0,title:t.title,label:"",labelClass:"btn-outline-dark",sizeClass:"w-full max-w-[700px]",centered:"",ref:"modalDialog",activeModal:t.isOpen,"onEvent:closeModal":o[4]||(o[4]=m=>t.closeModal())},{footer:V(()=>[n("div",De,[u(x,{text:"ยืนยัน",btnClass:"btn-primary w-32 mx-2",onOnClick:o[2]||(o[2]=m=>t.onAcceptSwitch())}),u(x,{text:"ยกเลิก",btnClass:"btn-outline-dark w-32 mx-2",onOnClick:o[3]||(o[3]=m=>t.closeModal())})])]),default:V(()=>{var m;return[n("div",he,[n("div",ke,[(k(!0),O(ce,null,de(t.organizeList,(i,_)=>(k(),O("div",{class:"text-slate-600 dark:text-slate-400 text-sm font-normal my-2",key:_},[n("div",Ce,[n("div",null,[u(f,{svg:"",value:i.id,modelValue:t.radioItem,"onUpdate:modelValue":o[0]||(o[0]=d=>t.radioItem=d),onChange:d=>t.selectedItems(i)},null,8,["value","modelValue","onChange"])]),n("div",null,F(i.organization_name),1)])]))),128))]),t.groupObject?(k(),O("div",Le,[n("div",Oe,[n("div",ze,[n("div",Me,[u(b,{icon:"grommet-icons:tree"}),n("div",Te,F((m=t.groupObject)==null?void 0:m.organization_name),1)]),u(b,{onClick:o[1]||(o[1]=i=>t.removeItemgroupObject()),icon:"fa6-solid:trash-can",class:"text-red-500"})])])])):B("",!0)])]}),_:1},8,["title","activeModal"])):B("",!0)])}const Se=P(ye,[["render",Ve]]),Ee={name:"SendToOrg",props:["activeTab","tabIndex","title","isOpen","organizeList","userList","checkedID","checkedItemRadio","customList"],components:{Checkbox:N,ModalDrive:Ie,ModalOrganizeFirst:Se,Expansion:se,Button:U,Icon:R,vSelect:ne,VueSelect:le,TextValid:oe,Textinput:A},emits:["event:submit"],setup(l,o){y(()=>l.checkedItemRadio,c=>{console.log("dsadasdsadasdasdasdas"),t.value={name:c.organization_name,id:c.id,emails:c==null?void 0:c.emails,email:c==null?void 0:c.email}}),console.log("props",l);const v=a({}),t=a(l.checkedItemRadio||{}),z=_e(),h=a(""),f=a(""),b=a([]),x=a(null),p=a(!1),m=a(!1),i=a([]),_=a([{label:"ประเภท",field:"type",width:"100px"},{label:"ชื่อหน่วยงาน/บุคคล",field:"officer",width:"500px"},{label:"อีเมล",field:"email",width:"330px"},{label:"จัดการ",field:"action",width:"80px",class:"text-center"}]),d=a([]),S=a(""),E=a([{label:"นาที"},{label:"ชั่วโมง"},{label:"วัน"},{label:"ปี"}]),T=a([{label:"การแจ้งเตือน"},{label:"อีเมล"}]),I=c=>{c=="org"?p.value=!0:c=="drive"&&(m.value=!0)},C=()=>{m.value=!1,p.value=!1,i.value=[]},D=(c,L)=>{c=="org"?(t.value=L,p.value=!1):c=="drive"&&(m.value=!1,f.value=L,console.log("drive selected: ",L))},M=()=>{t.value=null};return re(async()=>{const{data:c,status:L}=await G("driveStore","get");L==200&&(console.log("DriveData",c.result),b.value=c.result)}),{submit:async()=>{v.value={id:t.value.data_id?t.value.data_id:t.value.id,email:t.value.email},o.emit("event:submit",{id:z.currentRoute.value.params.id,is_send_mail:!!h.value,receive_organization:v.value})},data:t,driveID:f,notiList:d,deadlineDate:S,dateType:E,notiType:T,advancedTable:i,columns:_,isOpen:p,isOpenDrive:m,openModal:I,closeModal:C,accept:D,ModalOrganizeFirst:x,deleteOfficer:M,driveList:b,notiEmail:h}}},Fe={class:"space-y-2"},je={class:"pt-5"},we={class:"space-y-1"},Be=n("div",{class:"flex gap-3 items-center text-[13px] font-semibold my-2 p-2"},[n("div",{class:"basis-1/12"},"ประเภท"),n("div",{class:"basis-7/12"},"ชื่อหน่วยงาน/บุคคล"),n("div",{class:"basis-3/12"},"อีเมล"),n("div",{class:"basis-1/12"},"จัดการ")],-1),Ue={key:0,class:"flex space-y-2"},Re={class:"flex-shirk-0 basis-1/12 px-5"},Ae={class:"basis-7/12"},Ne={class:"basis-3/12"},Ge={class:"basis-1/12"},Pe={class:"flex-shirk-0"},qe={key:1,class:"text-center"},He={class:"px-5 py-4"},Je={class:"text-center mt-20 mb-10 flex justify-center"};function Ke(l,o,v,t,z,h){const f=g("Button"),b=g("Icon"),x=g("vSelect"),p=g("VueSelect"),m=g("Checkbox"),i=g("ModalOrganizeFirst"),_=g("Expansion");return k(),O("div",null,[u(_,{parentClass:"space-y-5 mb-6",title:"ส่งหนังสือต่อให้หน่วยงาน",activeItem:v.activeTab},{default:V(()=>[n("div",Fe,[n("div",je,[u(f,{onClick:o[0]||(o[0]=d=>t.openModal("org")),icon:"grommet-icons:tree",text:"เลือกหน่วยงาน",btnClass:"btn-primary rounded-md"})]),n("div",we,[Be,t.data?(k(),O("div",Ue,[n("div",Re,[n("div",null,[u(b,{class:"text-2xl text-blue-500",icon:"grommet-icons:tree"})])]),n("div",Ae,F(t.data.organization_name),1),n("div",Ne,[n("div",Ge,[u(p,{classInput:"input_color"},{default:V(()=>[u(x,{label:"email",class:"input_color bg-gray-100 rounded w-[280px]",reduce:d=>d.email,options:t.data.emails,modelValue:t.data.email,"onUpdate:modelValue":o[1]||(o[1]=d=>t.data.email=d)},null,8,["reduce","options","modelValue"])]),_:1})])]),n("div",Pe,[u(b,{icon:"fa6-solid:trash-can",class:"text-gray-500 cursor-pointer",onClick:o[2]||(o[2]=d=>t.deleteOfficer())})])])):(k(),O("div",qe,"No data..")),n("div",He,[u(m,{label:"แจ้งเตือนผู้รับทางอีเมล",activeClass:"bg-primary-500",modelValue:t.notiEmail,"onUpdate:modelValue":o[3]||(o[3]=d=>t.notiEmail=d)},null,8,["modelValue"])])])]),u(i,{ref:"ModalOrganizeFirst",title:"เลือกหน่วยงาน",isOpen:t.isOpen,organizeList:v.organizeList,userList:v.userList,customList:v.customList,checkedID:v.checkedID,checkedItemRadio:v.checkedItemRadio,"onEvent:close":t.closeModal,"onEvent:accept":o[4]||(o[4]=d=>t.accept("org",d))},null,8,["isOpen","organizeList","userList","customList","checkedID","checkedItemRadio","onEvent:close"])]),_:1},8,["activeItem"]),n("form",{onSubmit:o[5]||(o[5]=ue((...d)=>t.submit&&t.submit(...d),["prevent"])),class:"px-0 sm:px-12"},[n("div",Je,[u(f,{type:"submit",text:"ส่งหนังสือ",btnClass:"btn-primary w-32 font-medium mx-2"}),u(f,{text:"ยกเลิก",btnClass:"btn-outline-dark w-32 mx-2",link:"/app/issue/order"})])],32)])}const it=P(Ee,[["render",Ke]]);export{it as F};
