import{C as N}from"./index-263882d1.js";import{I as T}from"./index-72ee420c.js";import{B as Y}from"./index-441935dc.js";import{E as H}from"./index-1c6333b5.js";import{D as z}from"./index-090a8953.js";import{C as q,B as G,A as J,a as K,b as L,R as Q}from"./RouteDetail-b3469ae3.js";import{M as U}from"./index-7dc8252b.js";import{T as W}from"./index-ce9a51c5.js";import{M as X}from"./index-ee40f0ab.js";import{_ as Z,t as B,a as m}from"./index-e058a960.js";import{d as $}from"./dayjs.min-72c81edc.js";import{M as ee}from"./index-2a7f4259.js";import{M as te}from"./Modal-19eb68c4.js";import{o as d,x as s,bj as l,m as _,n as p,aF as n,as as a,p as i,aT as f,w as oe}from"./preload-helper-9e0646ca.js";import"./iconify-4e42c13d.js";import"./dom-891ac6c3.js";import"./focus-management-e6c5d1fd.js";import"./open-closed-486d85f0.js";import"./use-resolve-button-type-38f1f99a.js";import"./use-outside-click-a758fdce.js";import"./index-1b218db3.js";import"./transition-39b574f4.js";import"./hidden-11a9ab9d.js";import"./micro-task-89dcd6af.js";import"./index-cc7a2b4b.js";const se={name:"ReceiveView",components:{Card:N,Icon:T,Button:Y,Expansion:H,Dropdown:z,CoverSheet:q,BookDetail:G,AttachedFile:J,BookReference:K,Activity:L,RouteDetail:Q,ModalSuccess:U,ModalError:ee,Modal:te,Textarea:W,ModalPullback:X},data(){return{isOpen:!1,pdfPath:"",urlSarabun:B,item:null,isSuccess:!1,isError:!1,errorMessage:"",modalPullback:!1}},created(){this.fetchData()},methods:{async pdfHistory(){const{data:o,status:t}=await m("documentStore","PDFHistory",{payload:this.$route.params.id});t==200&&(console.log("data pdf",o.result),this.pdfPath=o.result,this.isOpen=!0)},async fetchData(){console.log("fetchData");const{data:o,status:t}=await m("documentSendStore","show",{payload:this.$route.params.id});t===200&&(this.item=await o.result)},convertDate(o){return o?$(o).locale("th").add(543,"year").format("DD/MM/YYYY"):"-"},async handleReceiveBook(){console.log("handleReceiveBook");const{data:o,status:t}=await m("documentStore","acceptDocument",{payload:this.$route.params.id});t===200&&(this.isSuccess=!0,this.fetchData())},async onCancel(){console.log("onCancel");const{data:o,status:t}=await m("documentSendStore","delete",{payload:[{id:this.$route.params.id}]});t===200?this.$router.push("/app/issue/pending"):(this.isError=!0,this.errorMessage=o.message)},onReturn(){console.log("onReturn")},onPrinter(){console.log("onPrinter")},downloadFileDocument(o){console.log(o)},downloadFile(o){const t=B+o;window.open(t,"_blank")},async pullBack(o){const{data:t,status:h}=await m("pullbackStore","store",{payload:{id:this.$route.params.id,returned_reason:o}});h===200?this.$router.push("/app/issue/pending"):(this.isError=!0,this.errorMessage=t.message)},async confirm(){const{data:o,status:t}=await m("pendingStore","confirmSend",{payload:this.$route.params.id});t===200?this.$router.push("/app/issue/pending"):(this.isError=!0,this.errorMessage=o.message)}}},ne={class:"flex justify-between items-center"},ie={class:"basis-1/2"},re={class:"flex items-center gap-3"},le={class:"shrink w-[145px]"},ae=i("div",null,"กลับไปหน้ารายการ",-1),ce={key:0,class:"flex items-center border-x gap-3 border-gray-300 px-4"},me={key:0,class:"pt-4"},pe={key:1,class:"flex justify-center mt-4 py-4 bg-gray-100"},ue={class:"text-2xl font-medium my-6"},de=i("h4",{class:"text-lg text-slate-900"},[oe(" รับหนังสือ "),i("span",{class:"text-green-500"},"สำเร็จ")],-1),fe={class:"text-lg text-slate-900"},_e=["src"];function he(o,t,h,ke,e,r){const k=n("Icon"),v=n("router-link"),u=n("Button"),x=n("Card"),D=n("CoverSheet"),S=n("BookDetail"),E=n("BookDraftRef"),R=n("AttachedFile"),P=n("BookReference"),O=n("Activity"),F=n("RouteDetail"),A=n("ModalSuccess"),j=n("ModalError"),V=n("ModalPullback"),I=n("Modal");return a(),d("div",null,[s(x,null,{default:l(()=>{var c,y,b,g,C,M,w;return[i("div",ne,[i("div",ie,[i("div",re,[i("div",le,[s(v,{to:"/app/issue/pending",class:"flex items-center text-primary-600"},{default:l(()=>[s(k,{icon:"mdi:chevron-left",class:"text-xl"}),ae]),_:1})]),e.item?(a(),d("div",ce,[e.item&&((c=e.item)==null?void 0:c.status)=="รอดำเนินการ"?(a(),_(v,{key:0,to:"/app/issue/pending/wait-to-send/edit/"+((y=e.item)==null?void 0:y.id)},{default:l(()=>[s(u,{text:"แก้ไข",btnClass:"btn-primary h-[40px] flex items-center"})]),_:1},8,["to"])):p("",!0),s(u,{onClick:t[0]||(t[0]=ve=>e.modalPullback=!0),text:"ดึงกลับ",btnClass:"btn-warning h-[40px] flex items-center"}),s(u,{onClick:r.onCancel,text:"ยกเลิกหนังสือ",btnClass:"btn-danger h-[40px] flex items-center"},null,8,["onClick"])])):p("",!0),e.item?(a(),_(k,{key:1,onClick:r.onPrinter,icon:"mdi:printer",class:"text-3xl cursor-pointer"},null,8,["onClick"])):p("",!0)])])]),e.item&&((b=e.item)==null?void 0:b.status)=="รอดำเนินการ"?(a(),d("div",me,[s(x,{bodyClass:"bg-gray-100 h-[95px] flex items-center space-y-10 py-6"},{default:l(()=>[i("div",null,[s(u,{onClick:r.confirm,text:"ยืนยันดำเนินการต่อ"},null,8,["onClick"])])]),_:1})])):p("",!0),((g=e.item)==null?void 0:g.status)=="รอรับ"?(a(),d("div",pe,[s(u,{onClick:r.handleReceiveBook,text:"รับหนังสือ",btnClass:"btn-primary h-[40px] flex items-center"},null,8,["onClick"])])):p("",!0),i("div",ue," วันที่ "+f(r.convertDate((C=e.item)==null?void 0:C.document_date))+" "+f((M=e.item)==null?void 0:M.subject)+" พ.ศ. "+f((w=e.item)==null?void 0:w.year),1),s(D,{item:e.item},null,8,["item"]),s(S,{item:e.item},null,8,["item"]),s(E,{item:e.item},null,8,["item"]),s(R,{item:e.item},null,8,["item"]),s(P,{item:e.item},null,8,["item"]),s(O,{item:e.item,"onEvent:onClick":r.pdfHistory},null,8,["item","onEvent:onClick"]),s(F,{item:e.item},null,8,["item"])]}),_:1}),s(A,{title:"รับหนังสือ",isOpen:e.isSuccess,"onEvent:closeModal":t[1]||(t[1]=c=>e.isSuccess=!1)},{default:l(()=>[de]),_:1},8,["isOpen"]),s(j,{title:"",isOpen:e.isError,"onEvent:closeModal":t[2]||(t[2]=c=>e.isError=!1)},{default:l(()=>[i("h4",fe,f(e.errorMessage),1)]),_:1},8,["isOpen"]),s(V,{isOpen:e.modalPullback,"onEvent:close":t[3]||(t[3]=c=>e.modalPullback=!1),"onEvent:submit":r.pullBack},null,8,["isOpen","onEvent:submit"]),e.isOpen?(a(),_(I,{key:0,title:"ดูรายละเอียดเอกสาร",labelClass:"btn-outline-dark",sizeClass:"w-3/4",label:"",centered:"",activeModal:e.isOpen,"onEvent:closeModal":t[4]||(t[4]=c=>e.isOpen=!1)},{default:l(()=>[i("div",null,[i("iframe",{class:"w-full h-[1000px] mt-4",src:"data:application/pdf;base64, "+e.pdfPath,frameborder:"0"},null,8,_e)])]),_:1},8,["activeModal"])):p("",!0)])}const Ge=Z(se,[["render",he]]);export{Ge as default};
