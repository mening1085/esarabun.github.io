import{aA as n,ay as Z,al as de,o as m,x as d,bj as v,m as g,n as y,aF as c,as as r,p as a,w as b,aT as k,bo as ie}from"./preload-helper-9e0646ca.js";import{u as ce,a as q}from"./vee-validate.esm-0c282d04.js";import{c as ue,a as F}from"./array-e684e252.js";import{D as me,S as ve}from"./index-090a8953.js";import{C as _e}from"./index-263882d1.js";import{I as pe}from"./index-72ee420c.js";import{B as fe}from"./index-441935dc.js";import{I as ge}from"./index-a60d9262.js";import{P as xe}from"./index-bb139ada.js";import{V as be,C as he}from"./VueSelect-4c8519b3.js";import{S as Se}from"./index-a15147cf.js";import{M as we}from"./Modal-19eb68c4.js";import{T as ye}from"./index-31d1a8ca.js";import{_ as ke,a as M}from"./index-e058a960.js";import{C as Me}from"./index-559355a7.js";import{C as Ce}from"./index-3f3a6812.js";import{M as Ve}from"./index-7dc8252b.js";import{M as Ee}from"./index-2a7f4259.js";import{R as De}from"./index-3069c0b6.js";import{T as Ie}from"./index-ce9a51c5.js";import"./dom-891ac6c3.js";import"./focus-management-e6c5d1fd.js";import"./open-closed-486d85f0.js";import"./use-resolve-button-type-38f1f99a.js";import"./use-outside-click-a758fdce.js";import"./iconify-4e42c13d.js";import"./vue-cleave.min-9e1201c2.js";import"./index-7e9b1d19.js";import"./transition-39b574f4.js";import"./hidden-11a9ab9d.js";import"./micro-task-89dcd6af.js";import"./index-1b218db3.js";const Oe={components:{Pagination:xe,InputGroup:ge,Dropdown:me,Icon:pe,Button:fe,Card:_e,MenuItem:ve,VueSelect:be,vSelect:he,Switch:Se,Modal:we,Radio:De,Textarea:Ie,Textinput:ye,ChangeStatus:Me,ConfirmDelete:Ce,ModalSuccess:Ve,ModalError:Ee},setup(){const _=n(null),o=n(!1),G=n(!1),e=n(!1),z=n(!1),I=n(!1),p=n(!1),O=n(!1),T=n(""),h=Z({total:50,current_page:1,perpage:10,pageRange:5}),S=n(""),f=n(""),C=n(""),V=n(!0),j=n(""),L=n([{id:"",title:"สถานะทั้งหมด"},{id:!0,title:"เปิดการใช้งาน"},{id:!1,title:"ปิดการใช้งาน"}]),w=Z({status:"",search:""}),Q=n([{label:"ชื่อหน่วยงานภายนอก",field:"name",width:"210px",tdClass:"text_left",thClass:"text_left"},{label:"หนังสือนำเรียน",field:"guide_book",width:"210px",tdClass:"text_left",thClass:"text_left"},{label:"สถานะการใช้งาน",field:"enabled",width:"100px",tdClass:"text_left",thClass:"text_left"},{label:"จัดการ",field:"action",width:"50px"}]),E=n([]),D=n(null),x=n(""),H=n(""),J=ue({name:F().required("กรุณาระบุชื่อหน่วยงานภายนอก"),guideBook:F().required("กรุณาระบุหนังสือนำเรียน"),address:F().required("กรุณาระบุที่อยู่"),phoneNumber:F().nullable().required("กรุณาระบุเบอร์โทรศัพท์")}),{handleSubmit:t}=ce({validationSchema:J});de(async()=>{i(1)});const i=async l=>{const s=await M("outSideOrganizationStore","get",{payload:{page:l,...w}});s.status===200&&(E.value=s.data.result.data,h.total=s.data.result.total_page*s.data.result.per_page,h.current_page=s.data.result.current_page,h.perpage=s.data.result.per_page)},{value:B,errorMessage:W}=q("name"),{value:U,errorMessage:X}=q("guideBook"),{value:N,errorMessage:Y}=q("address"),{value:P,errorMessage:$}=q("phoneNumber"),ee=t(async()=>{let l={name:B.value,guide_book:U.value,address:N.value,phone_number:P.value,email:x.value};console.log("formID",D),D.value==null?(console.log("create submit"),(await M("outSideOrganizationStore","store",{payload:{data:l}})).status===200&&(e.value=!1,f.value="บันทึกข้อมูลหน่วยงานภายนอก",C.value="บันทึกข้อมูลหน่วยงานภายนอก",p.value=!0,K(),i(1))):(console.log("update submit"),(await M("outSideOrganizationStore","update",{payload:{id:D,data:l}})).status===200&&(e.value=!1,f.value="บันทึกการแก้ไขข้อมูลหน่วยงานภายนอก",C.value="บันทึกการแก้ไขข้อมูลหน่วยงานภายนอก",p.value=!0,K(),i(1)))}),te=(l,s)=>{z.value=!0,_.value=l,o.value=s},ae=async l=>{const s=await M("outSideOrganizationStore","outSideOrganizationChangStatus",{payload:{id:l.id,enabled:l.status}});s.status==200?(console.log("switch 200"),G.value=!0,R()):(console.log("error: ",s),passwordError.value=s.data.message),R()},oe=()=>{E.value=E.value.map(l=>(l.id===_.value&&(l.status=!!l.status),l)),R()},le=async l=>{I.value=!0,_.value=l},se=async l=>{I.value=!1;const s=await M("outSideOrganizationStore","delete",{payload:l});s.status==200?(f.value="ยืนยันการลบข้อมูล",C.value="ลบข้อมูลหน่วยงานภายนอก",p.value=!0,i(1)):(O.value=!0,T.value=s.data.message)},R=()=>{z.value=!1,I.value=!1,p.value=!1,O.value=!1,e.value=!1,T.value="",_.value=null},ne=async l=>{h.current_page=l,await i(l)},re=()=>{B.value="",U.value="",N.value="",W.value="",X.value="",Y.value="",P.value="",x.value=""},K=()=>{re(),e.value=!1};return{name:B,nameError:W,guideBook:U,guideBookError:X,address:N,addressError:Y,phoneNumber:P,phoneNumberError:$,email:x,emailError:H,modalId:_,modalStatus:o,isSuccess:G,isShowModalDetail:e,modalSuccessTitle:f,modalSuccessDetail:C,isShowDialogSwitch:z,isShowModalDelete:I,isModalSuccess:p,isModalDeleteError:O,errorMessage:T,paginate:h,modalTitle:S,formStatus:V,searchTerm:j,optionList:L,filter:w,columns:Q,advancedTable:E,getData:i,onUpdateSwitch:te,onAcceptSwitch:ae,onCloseSwitch:oe,openModalDelete:le,onDelete:se,clearModal:R,changePage:ne,closeModal:K,openModalAction:async(l,s=void 0)=>{if(l=="edit"){const A=await M("outSideOrganizationStore","edit",{payload:s});if(A.status===200){S.value="แบบฟอร์มแก้ไขหน่วยงานภายนอก";const u=A.data.result;D.value=u.id,B.value=u.name,U.value=u.guide_book,N.value=u.address,P.value=u.phone_number,x.value=u.email,_.value=s,V.value=!0,e.value=!0}}else if(l=="view"){const A=await M("outSideOrganizationStore","edit",{payload:s});if(A.status===200){S.value="รายละเอียดหน่วยงานภายนอก";const u=A.data.result;B.value=u.name,U.value=u.guide_book,N.value=u.address,P.value=u.phone_number,x.value=u.email,_.value=s,V.value=!1,e.value=!0}}else l=="create"&&(_.value=s,V.value=!0,e.value=!0,S.value="แบบฟอร์มเพิ่มหน่วยงานภายนอก")},handleSubmit:t,onSubmit:ee}}},Te={class:"role_managment"},Be={class:"md:flex justify-between pb-6 md:space-y-0 space-y-3 items-center"},Ue={class:"basis-2/5"},Ne={class:"basis-1/2 flex gap-3"},Pe={class:"basis-1/2"},Ae={class:"basis-1/2"},ze=a("div",{class:"text-center"},[a("div",{class:"text-gray-400"},"ไม่พบข้อมูล")],-1),Re={key:0},qe={key:1},Fe={class:"w-full"},Ge=["onClick"],je=["onClick"],Le=["onClick"],Qe={class:"py-4 px-3"},He={class:"list space-y-2 px-5 list-odd"},Je={class:"flex py-2"},Ke={class:"flex-1 flex gap-5 items-center"},We={class:"text-sm font-medium text-slate-900 dark:text-slate-200 layout-flex text-end min-w-[35%] max-w-[35%]"},Xe={key:0,class:"text-red-600"},Ye={class:"text-slate-600 dark:text-slate-400 mb-1"},Ze={key:1},$e={class:"flex py-2"},et={class:"flex-1 flex gap-5 items-center"},tt={class:"text-sm font-medium text-slate-900 dark:text-slate-200 layout-flex text-end min-w-[35%] max-w-[35%]"},at={key:0,class:"text-red-600"},ot={class:"text-slate-600 dark:text-slate-400 mb-1"},lt={key:1},st={class:"flex py-2"},nt={class:"flex-1 flex gap-5"},rt={class:"text-sm font-medium text-slate-900 dark:text-slate-200 layout-flex text-end min-w-[35%] max-w-[35%]"},dt={key:0,class:"text-red-600"},it={class:"text-slate-600 dark:text-slate-400 mb-1"},ct={key:1},ut={class:"flex py-2"},mt={class:"flex-1 flex gap-5 items-center"},vt=a("div",{class:"text-sm font-medium text-slate-900 dark:text-slate-200 layout-flex text-end min-w-[35%] max-w-[35%]"}," โทรศัพท์ ",-1),_t={class:"text-slate-600 dark:text-slate-400 mb-1"},pt={key:1},ft={class:"flex py-2"},gt={class:"flex-1 flex gap-5 items-center"},xt=a("div",{class:"text-sm font-medium text-slate-900 dark:text-slate-200 layout-flex text-end min-w-[35%] max-w-[35%]"}," Email Address ",-1),bt={class:"text-slate-600 dark:text-slate-400 mb-1"},ht={key:1},St=a("hr",{class:"mt-5 border"},null,-1),wt={class:"text-center mt-4 flex justify-center w-full"},yt=a("h4",{class:"text-lg text-slate-900"},[b(" เปิด/ปิดใช้งานหน่วยงานภายนอก"),a("span",{class:"text-green-500"},"สำเร็จ")],-1),kt={class:"text-lg text-slate-900"},Mt=a("span",{class:"text-green-500"},"สำเร็จ",-1),Ct={class:"text-lg text-slate-900"};function Vt(_,o,G,e,z,I){const p=c("Button"),O=c("vSelect"),T=c("VueSelect"),h=c("InputGroup"),S=c("Switch"),f=c("Icon"),C=c("Dropdown"),V=c("Pagination"),j=c("vue-good-table"),L=c("Card"),w=c("Textinput"),Q=c("Textarea"),E=c("Modal"),D=c("ChangeStatus"),x=c("ModalSuccess"),H=c("ConfirmDelete"),J=c("ModalError");return r(),m("div",Te,[d(L,{noborder:""},{default:v(()=>[a("div",Be,[a("div",Ue,[d(p,{icon:"ic:baseline-plus",text:"เพิ่มหน่วยงานภายนอก",btnClass:"btn-primary rounded-md",onClick:o[0]||(o[0]=t=>e.openModalAction("create"))})]),a("div",Ne,[a("div",Pe,[d(T,null,{default:v(()=>[d(O,{placeholder:"เลือกสถานะ",modelValue:e.filter.status,"onUpdate:modelValue":o[1]||(o[1]=t=>e.filter.status=t),label:"title",class:"border rounded",reduce:t=>t.id,options:e.optionList,"onOption:selected":o[2]||(o[2]=t=>e.getData(1))},null,8,["modelValue","reduce","options"])]),_:1})]),a("div",Ae,[d(h,{modelValue:e.filter.keyword,"onUpdate:modelValue":o[3]||(o[3]=t=>e.filter.keyword=t),placeholder:"Search",classInputGroup:"border-gray-200",type:"text",prependIcon:"heroicons-outline:search",merged:"",inputEnter:"","onEvent:inputEnter":o[4]||(o[4]=t=>e.getData(1))},null,8,["modelValue"])])])]),d(j,{columns:e.columns,styleClass:" vgt-table bordered centered",rows:e.advancedTable,"pagination-options":{enabled:!0,perPage:e.paginate.perpage},"search-options":{enabled:!0,externalQuery:e.searchTerm},"sort-options":{enabled:!1}},{emptystate:v(()=>[ze]),"table-row":v(t=>[t.column.field=="enabled"?(r(),m("span",Re,[t.row.enabled?(r(),g(S,{key:0,label:"เปิดใช้งาน",activeClass:"bg-primary-500",active:!0,modelValue:t.row.enabled,"onUpdate:modelValue":i=>{t.row.enabled=i,e.modalId=t.row.id,e.onUpdateSwitch(t.row.id,i)}},null,8,["modelValue","onUpdate:modelValue"])):(r(),g(S,{key:1,label:"ปิดใช้งาน",activeClass:"bg-primary-500",active:!1,modelValue:t.row.enabled,"onUpdate:modelValue":i=>{t.row.enabled=i,e.modalId=t.row.id,e.onUpdateSwitch(t.row.id,i)}},null,8,["modelValue","onUpdate:modelValue"]))])):y("",!0),t.column.field=="action"?(r(),m("span",qe,[d(C,{classMenuItems:"right-full  w-[220px] top-[110%] "},{menus:v(()=>[a("ul",Fe,[a("li",null,[a("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer",onClick:i=>e.openModalAction("edit",t.row.id)},[d(f,{icon:"bx:edit",class:"text-xl mr-2"}),b(" แก้ไข ")],8,Ge)]),a("li",null,[a("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer",onClick:i=>e.openModalAction("view",t.row.id)},[d(f,{icon:"grommet-icons:document-text",class:"text-xl mr-2"}),b(" ดูรายละเอียด ")],8,je)]),a("li",null,[a("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer border-t text-red-500",onClick:i=>e.openModalDelete(t.row.id)},[d(f,{icon:"material-symbols:delete",class:"text-xl mr-2"}),b(" ลบ ")],8,Le)])])]),default:v(()=>[d(f,{icon:"pepicons-pencil:dots-x",class:"text-gray-400 text-4xl"})]),_:2},1024)])):y("",!0)]),"pagination-bottom":v(t=>[a("div",Qe,[d(V,{total:e.paginate.total,current:e.paginate.current_page,"per-page":e.paginate.perpage,pageRange:e.paginate.pageRange,onPageChanged:o[5]||(o[5]=i=>e.changePage(i)),pageChanged:t.pageChanged,perPageChanged:t.perPageChanged,textAfterInput:"ไปที่หน้า",enableSearch:"",enableInput:""},null,8,["total","current","per-page","pageRange","pageChanged","perPageChanged"])])]),_:1},8,["columns","rows","pagination-options","search-options"])]),_:1}),e.isShowModalDetail?(r(),g(E,{key:0,title:e.modalTitle,activeModal:e.isShowModalDetail,"onEvent:closeModal":o[13]||(o[13]=t=>e.isShowModalDetail=!1),label:"",labelClass:"btn-outline-dark",sizeClass:"max-w-[900px]",centered:""},{default:v(()=>[a("form",{onSubmit:o[12]||(o[12]=ie((...t)=>e.onSubmit&&e.onSubmit(...t),["prevent"])),class:"px-0 sm:px-12"},[a("div",He,[a("div",Je,[a("div",Ke,[a("div",We,[b(" ชื่อหน่วยงานภายนอก "),e.formStatus?(r(),m("span",Xe,"*")):y("",!0)]),a("div",Ye,[e.formStatus?(r(),g(w,{key:0,modelValue:e.name,"onUpdate:modelValue":o[6]||(o[6]=t=>e.name=t),error:e.nameError,classInput:"border border-gray-400 w-[275px]"},null,8,["modelValue","error"])):(r(),m("div",Ze,k(e.name),1))])])]),a("div",$e,[a("div",et,[a("div",tt,[b(" หนังสือนำเรียน "),e.formStatus?(r(),m("span",at,"*")):y("",!0)]),a("div",ot,[e.formStatus?(r(),g(w,{key:0,modelValue:e.guideBook,"onUpdate:modelValue":o[7]||(o[7]=t=>e.guideBook=t),error:e.guideBookError,classInput:"border border-gray-400 w-[275px]"},null,8,["modelValue","error"])):(r(),m("div",lt,k(e.guideBook),1))])])]),a("div",st,[a("div",nt,[a("div",rt,[b(" ที่อยู่ "),e.formStatus?(r(),m("span",dt,"*")):y("",!0)]),a("div",it,[e.formStatus?(r(),g(Q,{key:0,modelValue:e.address,"onUpdate:modelValue":o[8]||(o[8]=t=>e.address=t),error:e.addressError,classInput:"border border-gray-400 w-[275px] text_area_bg",placeholder:""},null,8,["modelValue","error"])):(r(),m("div",ct,k(e.address),1))])])]),a("div",ut,[a("div",mt,[vt,a("div",_t,[e.formStatus?(r(),g(w,{key:0,modelValue:e.phoneNumber,"onUpdate:modelValue":o[9]||(o[9]=t=>e.phoneNumber=t),error:e.phoneNumberError,classInput:"border border-gray-400 w-[275px]"},null,8,["modelValue","error"])):(r(),m("div",pt,k(e.phoneNumber),1))])])]),a("div",ft,[a("div",gt,[xt,a("div",bt,[e.formStatus?(r(),g(w,{key:0,modelValue:e.email,"onUpdate:modelValue":o[10]||(o[10]=t=>e.email=t),error:e.emailError,classInput:"border border-gray-400 w-[275px]"},null,8,["modelValue","error"])):(r(),m("div",ht,k(e.email),1))])])])]),St,a("div",wt,[e.formStatus?(r(),g(p,{key:0,type:"submit",text:"บันทึก",btnClass:"btn-primary w-32 mx-2"})):y("",!0),d(p,{text:e.formStatus?"ยกเลิก":"ปิด",btnClass:"btn-outline-dark w-32 mx-2",onClick:o[11]||(o[11]=t=>e.closeModal())},null,8,["text"])])],32)]),_:1},8,["title","activeModal"])):y("",!0),d(D,{title:"ยืนยันการเปิด/ปิดใช้งานหน่วยงานภายนอก",isOpen:e.isShowDialogSwitch,modalId:e.modalId,status:e.modalStatus,"onEvent:close":e.onCloseSwitch,"onEvent:success":e.onAcceptSwitch},null,8,["isOpen","modalId","status","onEvent:close","onEvent:success"]),d(x,{title:"เปิด/ปิดใช้งานหน่วยงานภายนอก",isOpen:e.isSuccess,"onEvent:closeModal":o[14]||(o[14]=t=>e.isSuccess=!1)},{default:v(()=>[yt]),_:1},8,["isOpen"]),d(H,{title:"ยืนยันการลบข้อมูล",isOpen:e.isShowModalDelete,modalId:e.modalId,errorMessage:e.errorMessage,"onEvent:delete":e.onDelete,"onEvent:close":e.clearModal,"onEvent:success":e.clearModal},null,8,["isOpen","modalId","errorMessage","onEvent:delete","onEvent:close","onEvent:success"]),d(x,{title:e.modalSuccessTitle,isOpen:e.isModalSuccess,"onEvent:closeModal":o[15]||(o[15]=t=>e.isModalSuccess=!1)},{default:v(()=>[a("h4",kt,[b(k(e.modalSuccessDetail)+" ",1),Mt])]),_:1},8,["title","isOpen"]),d(J,{title:"ลบข้อมูล",isOpen:e.isModalDeleteError,"onEvent:closeModal":o[16]||(o[16]=t=>e.isModalDeleteError=!1)},{default:v(()=>[a("h4",Ct,k(e.errorMessage),1)]),_:1},8,["isOpen"])])}const ra=ke(Oe,[["render",Vt]]);export{ra as default};
