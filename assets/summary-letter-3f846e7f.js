import{C as D}from"./index-cb5a08aa.js";import{I as M}from"./index-8d30ace7.js";import{B as S}from"./index-c2d6eb9c.js";import{V,C as F}from"./VueSelect-403231fd.js";import{M as j}from"./Modal-b54f1b5f.js";import{M as P}from"./index-8e7d66d6.js";import{R as E}from"./index-e163c14d.js";import{D as L}from"./index-43a31f90.js";import{D as O}from"./index-976a2577.js";import{M as T}from"./index-28033082.js";import{_ as z,a as w}from"./index-f91482a0.js";import{c as R}from"./appex-chart-e4d84b07.js";import B from"./colors-b4acbf58.js";import{I as N}from"./index-2198f2cf.js";import{T as U}from"./index-3e8503e7.js";import{C as A}from"./index-325a54cb.js";import{C as Y}from"./index-8ecfca6d.js";import{C as J}from"./index-multiple-c799ba8f.js";import{o as v,x as a,bj as h,aF as i,as as b,p as e,F as X,aD as q,aT as W,w as y}from"./preload-helper-f37a9bec.js";import"./iconify-2baafea4.js";import"./transition-be7c09bc.js";import"./dom-b10fc197.js";import"./hidden-800255f5.js";import"./focus-management-94a631f4.js";import"./micro-task-89dcd6af.js";import"./open-closed-75edfb8a.js";import"./use-outside-click-156e41c1.js";import"./index-b704274e.js";import"./index-f2da45ff.js";import"./use-resolve-button-type-d7bee841.js";import"./vue-cleave.min-df5c8cc9.js";import"./ck-white-3501111f.js";const H={computed:{columnChart(){return R}},components:{CFlatPickrMulti:J,CFlatPickr:Y,Checkbox:A,Textinput:U,InputGroup:N,ModalGraph:T,Dropdown:O,DatePickerRange:L,Radio:E,Icon:M,Button:S,Card:D,VueSelect:V,vSelect:F,Modal:j,ModalSuccess:P},data(){return{filter:{keyword:"",agency:null},item:{},dataGraph:[],agencyItem:[{id:1,title:"asdq"}],dateMulti:[],pie_rev_letter:[],pie_send_letter:[],bar_rev_letter:[],bar_send_letter:[],bar_count_view_letter:[],bar_count_all_letter:[],isOpen:!1}},watch:{dateMulti:{handler:function(s){typeof s=="object"&&this.getData()},deep:!0}},async created(){await this.getData()},methods:{openModalGraph(s){this.isOpen=!0,this.item=this.dataGraph[s]},async getData(){var m,l,o;this.dateMulti.length>0&&(this.filter.date_start=this.dateMulti[0],this.filter.date_end=this.dateMulti[1]);const s=await w("reportFixStore","summaryLetter",{payload:this.filter}),t=await w("reportDashboardStore","getCommonData");this.dataGraph=[],(m=t==null?void 0:t.data.result)!=null&&m.dropdown&&(this.agencyItem=(l=t==null?void 0:t.data.result)==null?void 0:l.dropdown),(o=s.data)!=null&&o.result&&s.data.result.data.forEach((n,u)=>{this.dataGraph.push(this.generateGraph(n.dataGraph,u))})},generateGraph(s,t){const m=s.id,l=s.name,o=s.chartType;let n;n=s.data;const u={chart:{id:"custom_chart_"+t,type:s.chartType,toolbar:{show:!1}},dataLabels:{enabled:s.showLabel},stroke:{curve:"straight"},markers:{size:s.markers?4:0,colors:"#fff",strokeColors:B.primary,strokeWidth:2,shape:"circle",radius:2,hover:{sizeOffset:1}},labels:s.dataLabel,colors:s.colors,yaxis:[{min:0,tickAmount:10}],plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!1},value:{show:!0,fontSize:"40px",offsetY:15,formatter:function(c){return c}},total:{show:!0,label:"",color:"#373d3f",formatter:function(c){return c.globals.series.reduce((d,f)=>d+f,0)}}}}}},noData:{text:"No data",align:"center",verticalAlign:"middle",offsetX:0,offsetY:0,style:{fontSize:"40px"}}};return o=="donut"&&(u.legend={itemMargin:{vertical:5},width:250,offsetX:10,offsetY:60,formatter:function(c,d){let f=parseFloat(d.w.globals.series[d.seriesIndex]/d.w.globals.series.reduce((g,p)=>g+p,0)*100).toFixed(2)+"%";return"<div style='position: absolute;bottom: 3px;left: 0;width: 210px'><div class='flex justify-between'><div>"+c+"</div><div>"+f+"</div></div></div>"}}),{id:m,name:l,series:n,options:u,chartType:o}},async downloadSVG(s="custom_chart_0",t){const l=await window.Apex._chartInstances.find(n=>n.id===s).chart.dataURI(),o=document.createElement("a");o.href=l.imgURI,o.download="image."+t,document.body.appendChild(o),o.click(),document.body.removeChild(o)},onFilter(){console.log("this.filter",this.filter)}}},K={class:"report-management"},Q=e("div",{class:"md:flex justify-between p-6 md:space-y-0 space-y-3 items-center border-b-2"},[e("div",null,[e("span",null,"รายงานสถิติสรุปหนังสือเวียน")])],-1),Z={class:"flex flex-row-between p-6"},$=e("div",{class:"flex basis-1/12"},null,-1),ee={class:"flex basis-11/12 gap-5 items-center"},te=e("div",{class:"basis-1/12 flex justify-end"},"กำหนดช่วงเวลา",-1),oe={class:"basis-5/12"},se={class:"mt-5 flex align-items-center"},re={class:"basis-2/12"},ae={class:"basis-2/12"},ne={class:"main-layout flex flex-wrap justify-between p-6"},ie={class:"w-full pt-2 pl-7 flex"},le={class:"basis-6/12"},ce={class:"basis-6/12 flex justify-end pr-7"},de={class:"border rounded-md flex align-items-center px-2 max-h-10"},pe={class:"w-full"},me=["onClick"],ue=["onClick"],fe=["onClick"],_e={class:"basis-1/1 px-3 w-full"},he=e("th",null,null,-1);function ge(s,t,m,l,o,n){const u=i("CFlatPickr"),c=i("DatePickerRange"),d=i("InputGroup"),f=i("vSelect"),g=i("VueSelect"),p=i("Icon"),C=i("Dropdown"),k=i("apexchart"),G=i("Card"),I=i("modal-graph");return b(),v("div",K,[a(G,{noborder:"",bodyClass:"two-side-card"},{default:h(()=>[Q,e("div",Z,[$,e("div",ee,[te,e("div",oe,[e("div",se,[a(c,null,{default:h(()=>[a(u,{config:{mode:"range"},onOnChange:t[0]||(t[0]=r=>o.dateMulti=r)})]),_:1})])]),e("div",re,[a(d,{modelValue:o.filter.keyword,"onUpdate:modelValue":t[1]||(t[1]=r=>o.filter.keyword=r),placeholder:"ค้นหา",type:"text",prependIcon:"heroicons-outline:search",merged:"",inputEnter:!0,"onEvent:inputEnter":t[2]||(t[2]=r=>n.getData(1))},null,8,["modelValue"])]),e("div",ae,[a(g,{classInput:"input_color"},{default:h(()=>[a(f,{modelValue:o.filter.agency,"onUpdate:modelValue":t[3]||(t[3]=r=>o.filter.agency=r),placeholder:"หน่วยงานทั้งหมด",label:"organization_name",class:"input_color border rounded",reduce:r=>r.id,options:o.agencyItem,"onOption:selected":t[4]||(t[4]=r=>n.getData(1))},null,8,["modelValue","reduce","options"])]),_:1})])])]),e("div",ne,[(b(!0),v(X,null,q(o.dataGraph,(r,_)=>(b(),v("div",{key:_,class:"w-[49%] flex flex-wrap border-layout mt-5"},[e("div",ie,[e("div",le,W(r.name),1),e("div",ce,[e("div",de,[a(p,{style:{fontSize:"24px"},class:"text-gray-500 cursor-pointer mr-2 hover:bg-gray-100 rounded-md",onClick:x=>n.openModalGraph(_),icon:"material-symbols:pan-zoom"},null,8,["onClick"]),a(C,{classMenuItems:"right-full w-[220px] top-[110%]"},{menus:h(()=>[e("ul",pe,[e("li",null,[e("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer",onClick:x=>n.downloadSVG("custom_chart_"+_,"png")},[a(p,{icon:"bxs:file-png",class:"text-xl mr-2 text-blue-500"}),y(" ดาวน์โหลด (.PNG) ")],8,me)]),e("li",null,[e("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer",onClick:x=>n.downloadSVG("custom_chart_"+_,"jpg")},[a(p,{icon:"bxs:file-jpg",class:"text-xl mr-2 text-blue-500"}),y(" ดาวน์โหลด (.JPG) ")],8,ue)]),e("li",null,[e("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer",onClick:x=>n.downloadSVG("custom_chart_"+_,"jpeg")},[a(p,{icon:"simple-icons:jpeg",class:"text-xl mr-2 text-blue-500"}),y(" ดาวน์โหลด (.JPEG) ")],8,fe)])])]),default:h(()=>[a(p,{icon:"pepicons-pencil:dots-x",class:"text-gray-400 text-4xl"})]),_:2},1024)])])]),e("div",_e,[a(k,{type:r.chartType,height:"300",width:"100%",options:r.options,series:r.series},null,8,["type","options","series"])])]))),128))]),he]),_:1}),a(I,{"is-open":o.isOpen,title:"",graph:o.item,"onEvent:close":t[5]||(t[5]=r=>o.isOpen=!1)},null,8,["is-open","graph"])])}const Ke=z(H,[["render",ge]]);export{Ke as default};
