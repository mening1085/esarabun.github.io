import{aA as h,al as L,k as V,be as w,aF as n,as as r,o as b,m as F,bj as u,p as e,x as a,n as v,F as O,aD as D,ac as G,aT as B,bo as q}from"./preload-helper-f37a9bec.js";import{B as U}from"./index-c2d6eb9c.js";import{M as A}from"./Modal-b54f1b5f.js";import{T as H}from"./index-3e8503e7.js";import{T as J}from"./index-78f015fc.js";import{I as K}from"./index-8d30ace7.js";import{P as Q}from"./index-e68945de.js";import{u as R,a as N}from"./vee-validate.esm-bf91438b.js";import{T as W}from"./TextValid-d1c607fc.js";import{c as X,a as z}from"./array-6ac4c54d.js";import{B as Y,E,c as g,_ as Z,g as $,t as ee}from"./index-f91482a0.js";import{l as te,a as se,n as ae,r as oe,u as ne}from"./tabs-cf3e0d3b.js";const le={name:"Success",props:{title:{type:String,default:""},isOpen:{type:Boolean,default:!1},item:{type:Object,default:{}},pinError:{type:String,default:""}},components:{Modal:A,Button:U,Textinput:H,Icon:K,PinInput:Q,Textarea:J,TextValid:W,VueSignaturePad:Y,TabGroup:te,TabList:se,Tab:ae,TabPanels:oe,TabPanel:ne},data:()=>({options:{penColor:"#c0f"}}),methods:{undo(){this.$refs.signaturePad.undoSignature()},save(){const{isEmpty:y,data:l}=this.$refs.signaturePad.saveSignature();E().handleSignature(l)},remove(){E().clearSignature(),this.$refs.signaturePad.clearSignature()},closeModal(){this.$emit("event:closeModal")}},emits:["event:submit","event:closeModal","event:pincode"],setup(y,l){const d=h({}),t=h(0),T=h(!1),c=h([{title:"ใบรับรองอิเล็กทรอนิกส์"},{title:"วาดลายมือชื่อ"}]);L(()=>{d.value=g().userInfo,x.value||(t.value=1)});const M=X({signature:z().nullable().required("กรุณาใส่ลายเซ็น"),pincode:z().nullable().required("กรุณากรอกรหัส PIN Code ของใบอนุญาติอิเล็กทรอนิกส์")}),{handleSubmit:C,resetForm:j}=R({validationSchema:M}),{value:i,errorMessage:m}=N("signature"),{value:_,errorMessage:S}=N("pincode"),I=s=>{console.log("updatePin",s),_.value=s},p=V(()=>$().isMobile),P=V(()=>E().signature),x=V(()=>{var s,o;return(s=g().userInfo)!=null&&s.signature_path?ee+((o=g().userInfo)==null?void 0:o.signature_path):""});w(()=>_.value,s=>{l.emit("event:pincode",s)}),w(()=>P.value,s=>{i.value=s,s&&(T.value=!0)}),w(()=>t.value,s=>{var o;s==0&&(i.value=(o=g().userInfo)==null?void 0:o.signature_path)},{immediate:!0});const k=s=>{var o;t.value=s,i.value="",s==0&&(i.value=(o=g().userInfo)==null?void 0:o.signature_path),console.log("tabtab",s)},f=C(async()=>{l.emit("event:submit",{id:y.item.id,signature:i.value,pincode:_.value})});return{selected:t,pincode:_,pincodeError:S,tabMenu:c,signature:i,signatureError:m,updatePin:I,submit:f,changeTab:k,signatureImage:x,isSaveSignature:T,userInfo:d,isMobile:p}}},ie={class:"md:px-20 space-y-4 md:mb-12 mb-6"},re={class:"list"},de={key:0,class:"-mt-4"},ce=e("div",{class:"text-gray-500 text-[20px] mb-2 mt-4"}," ลงนามในหนังสือ ",-1),ue={class:"text-slate-600 text-sm font-normal flex space-x-3 items-center"},me=["src"],_e=e("div",{class:"text-gray-500 text-[16px] basis-1/4"}," วาดลายมือชื่อ (ภาษาไทย) ",-1),be={class:"text-slate-600 text-sm font-normal"},pe={class:"border-2"},xe={class:"container p-2 space-y-2"},fe={class:"flex justify-between items-center gap-3"},ve=e("div",{class:"md:text-[12px] text-[10px]"}," วาดลายมือชื่อ ",-1),ge={class:"flex gap-2"},he={class:"p-2 border-t"},ye={key:0,class:"flex justify-end"},Te={class:"text-[16px] basis-1/4"},Me={class:"mt-3 flex flex-wrap"},Ce=e("div",{class:"text-gray-500 md:text-[16px] text-[14px] md:basis-1/4 basis-full"}," รหัส PIN Code ",-1),Se={class:"basis-3/4 justify-start space-y-1"},Ie={class:"text-[16px] basis-1/4"},Pe={key:0,class:"flex space-x-5"},ke=e("div",{class:"text-end basis-1/3 font-bold"},"ผู้ลงนาม:",-1),Ve={class:"basis-2/3 justify-start"},we={key:1,class:"flex space-x-5"},Be=e("div",{class:"text-end basis-1/3 font-bold"},"ตำแหน่ง:",-1),Ee={class:"basis-2/3 justify-start"},je=e("hr",{class:"my-2"},null,-1),Fe={class:"flex justify-center w-full mt-6"};function Ne(y,l,d,t,T,c){const M=n("Textinput"),C=n("Tab"),j=n("TabList"),i=n("TabPanel"),m=n("Icon"),_=n("VueSignaturePad"),S=n("TabPanels"),I=n("TabGroup"),p=n("TextValid"),P=n("PinInput"),x=n("Button"),k=n("Modal");return r(),b("div",null,[d.isOpen?(r(),F(k,{key:0,title:d.title,label:"",labelClass:"btn-outline-dark",sizeClass:"md:w-3/5 w-full md:h-[800px] h-[650px] z-[1]",ref:"modalDialog",centered:"",activeModal:d.isOpen,"onEvent:closeModal":l[2]||(l[2]=f=>c.closeModal())},{default:u(()=>{var f;return[e("form",{onSubmit:l[1]||(l[1]=q((...s)=>t.submit&&t.submit(...s),["prevent"]))},[e("div",ie,[e("div",re,[t.isMobile?(r(),b("div",de,[a(M,{modelValue:(f=t.userInfo)==null?void 0:f.position,label:"ตำแหน่ง",labelClass:"text-gray-500 text-[16px]",inputClass:"text-[16px] border border-gray-400",disabled:""},null,8,["modelValue"])])):v("",!0),ce,a(I,{selectedIndex:t.selected,onChange:t.changeTab},{default:u(()=>[a(j,{class:"flex"},{default:u(()=>[(r(!0),b(O,null,D(t.tabMenu,(s,o)=>(r(),F(C,{as:"template",disabled:!t.signatureImage&&o==0,key:o,class:"basis-1/2"},{default:u(()=>[e("button",{class:G([[t.selected==o?"text-primary-500 before:w-full border-b-2 border-primary-500":"text-slate-500 before:w-0 border-b-2 border-gray-200"],"text-sm font-medium mb-2 capitalize bg-gray-200 py-2"])},B(s.title),3)]),_:2},1032,["disabled"]))),128))]),_:1}),a(S,null,{default:u(()=>[a(i,null,{default:u(()=>[e("div",ue,[e("img",{src:t.signatureImage,class:"h-[80px] w-[150px] object-cover border"},null,8,me),_e])]),_:1}),a(i,null,{default:u(()=>[e("div",be,[e("div",pe,[e("div",xe,[e("div",fe,[ve,e("div",ge,[a(m,{icon:"material-symbols:save",class:"text-green-500 text-2xl pr-2 border-r",onClick:c.save},null,8,["onClick"]),a(m,{icon:"dashicons:undo",class:"text-gray-500 text-2xl",onClick:c.undo},null,8,["onClick"]),a(m,{icon:"material-symbols:delete",class:"text-red-500 text-2xl",onClick:c.remove},null,8,["onClick"])])]),e("div",he,[a(_,{id:"signature",ref:"signaturePad"},null,512)]),t.isSaveSignature&&t.signature?(r(),b("div",ye,[a(m,{icon:"gg:check-o",class:"text-2xl text-green-500"})])):v("",!0)])])])]),_:1})]),_:1})]),_:1},8,["selectedIndex","onChange"]),e("div",Te,[a(p,{valid:t.signatureError},null,8,["valid"])])]),e("div",Me,[Ce,e("div",Se,[a(P,{"onUpdate:modelValue":t.updatePin,classInput:"border border-gray-400",placeholder:"กรอกรหัส Pin Code"},null,8,["onUpdate:modelValue"]),e("div",Ie,[a(p,{valid:t.pincodeError},null,8,["valid"]),a(p,{valid:d.pinError},null,8,["valid"])])])]),t.isMobile?v("",!0):(r(),b("div",Pe,[ke,e("div",Ve,B(t.userInfo.full_name),1)])),t.isMobile?v("",!0):(r(),b("div",we,[Be,e("div",Ee,B(t.userInfo.position),1)]))]),je,e("div",Fe,[a(x,{text:"ยืนยัน",type:"submit",btnClass:"btn-primary w-32 mx-2"}),a(x,{text:"ยกเลิก",btnClass:"btn-outline-dark w-32 mx-2",onClick:l[0]||(l[0]=s=>c.closeModal())})])],32)]}),_:1},8,["title","activeModal"])):v("",!0)])}const Re=Z(le,[["render",Ne]]);export{Re as M};
