import{f as R}from"./global-funcs-ef1510cf.js";import{T as A}from"./index-b52aeb81.js";import{D as F,S as L}from"./index-976a2577.js";import{C as G}from"./index-cb5a08aa.js";import{I as N}from"./index-8d30ace7.js";import{B as q}from"./index-c2d6eb9c.js";import{I as H}from"./index-2198f2cf.js";import{P as Q}from"./index-5ddbaceb.js";import{C as Y}from"./user-bf972f70.js";import{V as J,C as K}from"./VueSelect-403231fd.js";import{S as W}from"./index-ca598517.js";import{M as X}from"./Modal-b54f1b5f.js";import{T as Z}from"./index-3e8503e7.js";import{A as $}from"./index-6ecf5774.js";import{_ as ee,a as S}from"./index-f91482a0.js";import{C as te}from"./index-4d060206.js";import{M as se}from"./index-8e7d66d6.js";import{o as m,x as n,bj as d,m as y,n as _,aF as c,as as r,p as t,aT as u,w as b,F as D,aD as k}from"./preload-helper-f37a9bec.js";import"./dom-b10fc197.js";import"./focus-management-94a631f4.js";import"./open-closed-75edfb8a.js";import"./use-resolve-button-type-d7bee841.js";import"./use-outside-click-156e41c1.js";import"./iconify-2baafea4.js";import"./vue-cleave.min-df5c8cc9.js";import"./index-a56f86b1.js";import"./transition-be7c09bc.js";import"./hidden-800255f5.js";import"./micro-task-89dcd6af.js";import"./index-b704274e.js";const oe={components:{Tooltip:A,Pagination:Q,InputGroup:H,Dropdown:F,Icon:N,Button:q,Card:G,MenuItem:L,VueSelect:J,vSelect:K,Switch:W,Modal:X,Textinput:Z,ConfirmDelete:Y,ChangeStatus:te,ModalSuccess:se,Avatar:$},data(){return{findTreeDir:R,isShowModalDelete:!1,modalId:null,isShowDialog:!1,isSuccess:!1,modalStatus:!1,isShowDialogSwitch:!1,password:"",passwordError:0,paginate:{total:50,current:1,perpage:10,pageRange:5},searchTerm:"",roleList:[{id:1,title:"หัวหน้าฝ่ายสารบรรณ"},{id:2,title:"ผู้อำนวยการส่วนการเจ้าหน้าที่"},{id:3,title:"ข้าราชการส่วนการเจ้าหน้าที่"},{id:4,title:"จ้างเหมาบริการงานด้านเจ้าหน้าที่"},{id:5,title:"พนักงานราชการส่วนการเจ้าหน้าที่"}],organizeList:[],organization_id:"",keyword:"",actions:[{name:"view",icon:"heroicons-outline:eye"},{name:"edit",icon:"heroicons:pencil-square"},{name:"delete",icon:"heroicons-outline:trash"}],columns:[{label:"ชื่อผู้ใช้งาน",field:"full_name",width:"10%",tdClass:"text_left",thClass:"text_left"},{label:"บทบาท",field:"user_sarabun_roles",width:"100px",tdClass:"text_left",thClass:"text_left"},{label:"หน่วยงาน",field:"organization",width:"150px",tdClass:"text_left",thClass:"text_left"},{label:"เข้าใช้งานล่าสุด",field:"sign_in_at",width:"120px",tdClass:"text_left",thClass:"text_left"},{label:"สถานะการใช้งาน",field:"enabled",width:"130px",tdClass:"text_left",thClass:"text_left"},{label:"จัดการ",field:"action",width:"50px"}],test:{},advancedTable:[]}},watch:{password:{handler(){this.password&&(this.passwordError=0)}},organization_id:{handler(){this.organization_id||this.getData()}}},async created(){this.getData(1)},methods:{async getData(a){var g,o,l,f,p,w;const{data:e,status:h}=await S("usersStore","get",{payload:{page:a,organization_id:this.organization_id,keyword:this.keyword}});h==200&&(console.log("data",e),this.organizeList=(g=e==null?void 0:e.result)==null?void 0:g.organizations_list,this.advancedTable=(o=e==null?void 0:e.result)==null?void 0:o.data,this.paginate.total=((l=e==null?void 0:e.result)==null?void 0:l.total_page)*((f=e==null?void 0:e.result)==null?void 0:f.per_page),this.paginate.current=(p=e==null?void 0:e.result)==null?void 0:p.current_page,this.paginate.perpage=(w=e==null?void 0:e.result)==null?void 0:w.per_page)},formatDate(a){if(a){const e=new Date(a),h=e.getDate().toString().padStart(2,"0"),g=(e.getMonth()+1).toString().padStart(2,"0"),o=e.getFullYear()+543,l=e.getHours().toString().padStart(2,"0"),f=e.getMinutes().toString().padStart(2,"0");return`${h}/${g}/${o} ${l}:${f}`}else return null},async showDetail(a){this.modalId=a,this.isShowDialog=!0;const{data:e,status:h}=await S("usersStore","show",{payload:a});this.test=e.result,console.log("modal show detail status",h),console.log("modal show detail data",e.result)},onUpdateSwitch(a,e){this.isShowDialogSwitch=!0,this.modalId=a,this.modalStatus=e},async onAcceptSwitch(a){console.log("payload",a);const e=await S("usersStore","userChangStatus",{payload:{id:a.id,status:a.status}});e.status==200?(this.clearModal(),setTimeout(()=>{this.isSuccess=!0},10)):(console.log("error: ",e),this.passwordError=e.data.message)},onCloseSwitch(){this.advancedTable=this.advancedTable.map(a=>(console.log(this.modalId),a.id===this.modalId&&(a.enabled=!!a.enabled),a)),this.clearModalSwitch(),this.clearModal()},clearModalSwitch(){this.isShowDialogSwitch=!1,this.modalId=null,this.subModalId=null,this.password="",this.passwordError=0},onClose(){this.test=[],this.isShowDialog=!1},getOrganization(a){if(!a)return"";let e="";return a.parent_organization&&(e+=this.getOrganization(a.parent_organization)),e+(e?" > ":"")+a.organization_name},addRole(a){let e="",h=!1;return a.forEach(g=>{e+=(h?" , ":"")+g.sarabun_role.name,h=!0}),e},onDelete(a){this.isShowModalDelete=!0,this.modalId=a},clearModal(){this.isShowDialogSwitch=!1,this.isShowModalDelete=!1,this.modalId=null,this.getData(1)},async changePage(a){this.paginate.current=a,await this.getData(a)}}},ae={class:"user-management"},le={class:"flex gap-5 pt-4 px-4 pb-8"},ne={class:"basis-1/2"},ie={class:"basis-1/2 flex gap-3"},re={class:"basis-1/2"},de={class:"basis-1/2"},ce=t("div",{class:"text-center"},[t("div",{class:"text-gray-400"},"ไม่พบข้อมูล")],-1),ue={key:0},me={class:"w-full ell-1"},_e={key:1},he={class:"w-full ell-1"},ge={key:2},fe={key:3},pe={key:4},be={key:5},we={class:"flex items-center gap-3"},xe={class:"h-8 w-8"},ve={class:"lowercase"},ye={class:"text-slate-900 dark:text-slate-200"},Se={key:6},Ce={key:7},De={class:"w-full"},ke=["onClick"],Ie=["onClick"],ze={class:"py-4 px-3"},Me={class:"flex flex-wrap items-center bg-gray-100 py-2 lowercase"},Ve=t("div",{class:"sm:basis-1/3 basis-full pr-5 flex sm:justify-end justify-start mb-1 sm:mb-0"}," ชื่อ-นามสกุล ",-1),Ee={class:"sm:basis-1/3 basis-full"},je={class:"flex flex-wrap items-center py-2"},Te=t("div",{class:"sm:basis-1/3 basis-full pr-5 flex sm:justify-end justify-start mb-1 sm:mb-0"}," อีเมล ",-1),Oe={class:"sm:basis-1/3 basis-full lowercase"},Pe={class:"flex flex-wrap items-center bg-gray-100 py-2"},Ue=t("div",{class:"sm:basis-1/3 basis-full pr-5 flex sm:justify-end justify-start mb-1 sm:mb-0"}," เบอร์โทรศัพท์ ",-1),Be={class:"sm:basis-1/3 basis-full"},Re={class:"flex flex-wrap items-center py-2"},Ae=t("div",{class:"sm:basis-1/3 basis-full pr-5 flex sm:justify-end justify-start mb-1 sm:mb-0"}," ตำแหน่ง ",-1),Fe={class:"sm:basis-1/3 basis-full"},Le={class:"flex flex-wrap items-center bg-gray-100 py-2"},Ge=t("div",{class:"sm:basis-1/3 basis-full pr-5 flex sm:justify-end justify-start mb-1 sm:mb-0"}," ภายใต้หน่วยงาน ",-1),Ne={class:"sm:basis-1/3 basis-full"},qe={class:"flex flex-wrap py-2"},He=t("div",{class:"sm:basis-1/3 basis-full pr-5 flex sm:justify-end justify-start mb-1 sm:mb-0"}," บทบาท ",-1),Qe={class:"sm:basis-1/3 basis-full space-y-2"},Ye={class:"text-slate-900 dark:text-slate-200"},Je={class:"flex flex-wrap bg-gray-100 py-2"},Ke=t("div",{class:"sm:basis-1/3 basis-full pr-5 pt-3 flex sm:justify-end justify-start mb-1 sm:mb-0"}," เจ้าหน้าที่ปฏิบัติราชการแทนได้ ",-1),We={class:"sm:basis-1/3 basis-full space-y-1"},Xe={class:"flex-none"},Ze={class:"h-8 w-8 md:ml-0 md:mr-0 ml-auto mr-auto md:mb-0 mb-4 rounded-full"},$e=["src"],et={key:1,class:"m-1 mr-2 w-8 h-8 relative flex justify-center items-center rounded-full bg-orange-500 text-xl text-white uppercase"},tt={class:"lowercase"},st={class:"text-slate-900 dark:text-slate-200"},ot={class:"text-center mt-4 flex justify-center w-full"},at=t("h4",{class:"text-lg text-slate-900"},[b(" เปิด/ปิดใช้งานบทบาทผู้ใช้งาน"),t("span",{class:"text-green-500"},"สำเร็จ")],-1);function lt(a,e,h,g,o,l){const f=c("Button"),p=c("router-link"),w=c("vSelect"),I=c("VueSelect"),z=c("InputGroup"),x=c("Tooltip"),M=c("Avatar"),C=c("Switch"),v=c("Icon"),V=c("Dropdown"),E=c("Pagination"),j=c("vue-good-table"),T=c("Card"),O=c("Modal"),P=c("ChangeStatus"),U=c("ModalSuccess"),B=c("ConfirmDelete");return r(),m("div",ae,[n(T,{noborder:""},{default:d(()=>[t("div",le,[t("div",ne,[n(p,{to:"user-management/create"},{default:d(()=>[n(f,{icon:"ic:baseline-plus",text:"เพิ่มผู้ใช้งาน",btnClass:"btn-primary rounded-md"})]),_:1})]),t("div",ie,[t("div",re,[n(I,null,{default:d(()=>[n(w,{placeholder:"เลือกหน่วยงาน",modelValue:o.organization_id,"onUpdate:modelValue":e[0]||(e[0]=s=>o.organization_id=s),label:"organization_name",class:"border rounded",reduce:s=>s.id,options:o.organizeList,"onOption:selected":e[1]||(e[1]=s=>l.getData(1))},null,8,["modelValue","reduce","options"])]),_:1})]),t("div",de,[n(z,{modelValue:o.keyword,"onUpdate:modelValue":e[2]||(e[2]=s=>o.keyword=s),placeholder:"Search",classInputGroup:"border-gray-200",type:"text",prependIcon:"heroicons-outline:search",merged:"",inputEnter:"","onEvent:inputEnter":e[3]||(e[3]=s=>l.getData(1))},null,8,["modelValue"])])])]),n(j,{columns:o.columns,styleClass:" vgt-table bordered centered",rows:o.advancedTable,"pagination-options":{enabled:!0,perPage:o.paginate.perpage},"search-options":{enabled:!0,externalQuery:o.searchTerm},"sort-options":{enabled:!1}},{emptystate:d(()=>[ce]),"table-row":d(s=>[s.column.field=="user_sarabun_roles"?(r(),m("span",ue,[n(x,null,{base:d(()=>[t("div",me,u(l.addRole(s.row.user_sarabun_roles)),1)]),default:d(()=>[t("div",null,u(l.addRole(s.row.user_sarabun_roles)),1)]),_:2},1024)])):_("",!0),s.column.field=="organization"?(r(),m("span",_e,[n(x,null,{base:d(()=>[t("div",he,u(l.getOrganization(s.row.organization)),1)]),default:d(()=>[t("div",null,u(l.getOrganization(s.row.organization)),1)]),_:2},1024)])):_("",!0),s.column.field=="sign_in_at"?(r(),m("span",ge,u(l.formatDate(s.row.sign_in_at?s.row.sign_in_at:null)),1)):_("",!0),s.column.field=="role_name"?(r(),m("span",fe,[n(x,{title:s.row.role_name,content:s.row.role_name,placement:"bottom",arrow:"",theme:"light",btnClass:"truncate w-[200px] p-0 text-left"},null,8,["title","content"])])):_("",!0),s.column.field=="organize_name"?(r(),m("span",pe,[n(x,{title:s.row.organize_name,content:s.row.organize_name,placement:"bottom",arrow:"",theme:"light",btnClass:"truncate w-[200px] p-0 text-left"},null,8,["title","content"])])):_("",!0),s.column.field=="full_name"?(r(),m("span",be,[t("div",we,[t("div",xe,[n(M,{image:s.row.profile_image?s.row.profile_image:"profile-1"},null,8,["image"])]),t("div",ve,[t("div",ye,u(s.row.full_name),1),t("div",null,u(s.row.email),1)])])])):_("",!0),s.column.field=="enabled"?(r(),m("span",Se,[s.row.enabled?(r(),y(C,{key:0,label:"เปิดใช้งาน",activeClass:"bg-primary-500",active:!0,modelValue:s.row.enabled,"onUpdate:modelValue":i=>{s.row.enabled=i,o.modalId=s.row.id,l.onUpdateSwitch(s.row.id,i)}},null,8,["modelValue","onUpdate:modelValue"])):(r(),y(C,{key:1,label:"ปิดใช้งาน",activeClass:"bg-primary-500",active:!1,modelValue:s.row.enabled,"onUpdate:modelValue":i=>{s.row.enabled=i,o.modalId=s.row.id,l.onUpdateSwitch(s.row.id,i)}},null,8,["modelValue","onUpdate:modelValue"]))])):_("",!0),s.column.field=="action"?(r(),m("span",Ce,[n(V,{classMenuItems:"right-full  w-[220px] top-[110%] "},{menus:d(()=>[t("ul",De,[t("li",null,[n(p,{class:"p-2 flex items-center hover:bg-gray-50",to:`user-management/edit/${s.row.id}`},{default:d(()=>[n(v,{icon:"bx:edit",class:"text-xl mr-2"}),b(" แก้ไข ")]),_:2},1032,["to"])]),t("li",null,[t("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer",onClick:i=>l.showDetail(s.row.id)},[n(v,{icon:"grommet-icons:document-text",class:"text-xl mr-2"}),b(" ดูรายละเอียด ")],8,ke)]),t("li",null,[t("div",{class:"p-2 flex items-center hover:bg-gray-50 cursor-pointer border-t text-red-500",onClick:i=>l.onDelete(s.row.id)},[n(v,{icon:"fa6-solid:trash-can",class:"text-xl mr-2"}),b(" ลบ ")],8,Ie)])])]),default:d(()=>[n(v,{icon:"pepicons-pencil:dots-x",class:"text-gray-400 text-4xl"})]),_:2},1024)])):_("",!0)]),"pagination-bottom":d(s=>[t("div",ze,[n(E,{total:o.paginate.total,current:o.paginate.current,"per-page":o.paginate.perpage,pageRange:o.paginate.pageRange,onPageChanged:e[4]||(e[4]=i=>l.changePage(i)),pageChanged:s.pageChanged,perPageChanged:s.perPageChanged,textAfterInput:"ไปที่หน้า",enableSearch:"",enableInput:""},null,8,["total","current","per-page","pageRange","pageChanged","perPageChanged"])])]),_:1},8,["columns","rows","pagination-options","search-options"])]),_:1}),o.isShowDialog?(r(),y(O,{key:0,title:"รายละเอียดหน่วยงาน",label:"",labelClass:"btn-outline-dark",sizeClass:"max-w-[900px]",ref:"modalDialog",centered:"",activeModal:o.isShowDialog,"onEvent:closeModal":e[6]||(e[6]=s=>l.onClose())},{footer:d(()=>[t("div",ot,[n(p,{class:"btn btn-primary w-32 font-medium mx-2",to:`/app/user-role/user-management/edit/${o.modalId}`},{default:d(()=>[b(" แก้ไขหน่วยงาน ")]),_:1},8,["to"]),n(f,{text:"ยกเลิก",btnClass:"btn-outline-dark w-32 mx-2",onOnClick:e[5]||(e[5]=s=>l.onClose())})])]),default:d(()=>{var s;return[t("div",Me,[Ve,t("div",Ee,u(o.test.full_name),1)]),t("div",je,[Te,t("div",Oe,u(o.test.email),1)]),t("div",Pe,[Ue,t("div",Be,u(o.test.mobile_phone),1)]),t("div",Re,[Ae,t("div",Fe,u(o.test.position),1)]),t("div",Le,[Ge,t("div",Ne,u((s=o.test.organization)==null?void 0:s.organization_name),1)]),t("div",qe,[He,t("div",Qe,[(r(!0),m(D,null,k(o.test.user_sarabun_roles,i=>(r(),m("div",{key:i.id},[t("div",Ye,u(i.sarabun_role.organization.organization_name),1),t("div",null,u("บทบาท: "+i.sarabun_role.name),1)]))),128))])]),t("div",Je,[Ke,t("div",We,[(r(!0),m(D,null,k(o.test.user_represent_permissions,i=>(r(),m("div",{key:i.id,class:"md:flex items-center md:space-x-6 rtl:space-x-reverse"},[t("div",Xe,[t("div",Ze,[i.represent_user.image?(r(),m("img",{key:0,src:i.represent_user.image,alt:"",class:"w-full h-full object-cover rounded-full"},null,8,$e)):(r(),m("div",et,[t("span",null,u(i.represent_user.full_name?i.represent_user.full_name[0]:""),1)]))])]),t("div",tt,[t("div",st,u(i.represent_user.full_name),1),t("div",null,u(i.represent_user.email),1)])]))),128))])])]}),_:1},8,["activeModal"])):_("",!0),n(P,{title:"ยืนยันการเปิด/ปิดผู้ใช้งาน",isOpen:o.isShowDialogSwitch,modalId:o.modalId,status:o.modalStatus,"onEvent:close":l.onCloseSwitch,"onEvent:success":l.onAcceptSwitch},null,8,["isOpen","modalId","status","onEvent:close","onEvent:success"]),o.isSuccess?(r(),y(U,{key:1,title:"ยืนยันการเปิด/ปิดผู้ใช้งาน",isOpen:o.isSuccess,"onEvent:closeModal":e[7]||(e[7]=s=>o.isSuccess=!1)},{default:d(()=>[at]),_:1},8,["isOpen"])):_("",!0),n(B,{title:"ยืนยันการลบข้อมูล",successMessage:"ลบข้อมูล",isOpen:o.isShowModalDelete,modalId:o.modalId,"onEvent:close":l.clearModal,"onEvent:success":l.clearModal},null,8,["isOpen","modalId","onEvent:close","onEvent:success"])])}const Ut=ee(oe,[["render",lt]]);export{Ut as default};
