import{I as y}from"./index-8d30ace7.js";import{_ as g,a as d,c as b}from"./index-f91482a0.js";import{M as k}from"./Modal-b54f1b5f.js";import{B as w}from"./index-c2d6eb9c.js";import{o as n,p as e,n as l,F as u,aD as m,x as p,aT as x,m as M,bj as P,aF as h,as as s,w as j}from"./preload-helper-f37a9bec.js";import"./iconify-2baafea4.js";import"./transition-be7c09bc.js";import"./dom-b10fc197.js";import"./hidden-800255f5.js";import"./focus-management-94a631f4.js";import"./micro-task-89dcd6af.js";import"./open-closed-75edfb8a.js";import"./use-outside-click-156e41c1.js";const C={components:{Icon:y,Modal:k,Button:w},data(){return{showModal:!1,errorMessage:"",pins:[{active:!1},{active:!1},{active:!1},{active:!1},{active:!1},{active:!1}],step:0,pin:"",form:{current_pin:"",pin:"",confirmPin:""}}},watch:{pin:{async handler(){if(this.pin.length===6)if(this.step===0){const{status:t}=await this.checkCurrentPin(this.pin);console.log("status",t),t===200?(this.form.current_pin=this.pin,this.pin="",this.step=1,this.errorMessage=""):(this.pin="",this.errorMessage="รหัส PIN ปัจจุบันไม่ถูกต้อง")}else this.step===1?(this.form.pin=this.pin,this.pin="",this.step=2,this.errorMessage=""):(this.form.confirmPin=this.pin,console.log("form",this.form),this.form.pin===this.form.confirmPin?this.changePin():(this.pin="",this.form.pin="",this.form.confirmPin="",this.step=1,this.errorMessage="รหัส PIN ไม่ตรงกัน"))}}},created(){this.$store.themeSettingsStore.navbarType="staticky"},methods:{async getMenuRole(){await d("generalStore","getMenu",{payload:{system_type:"e-sarabun"}})},async checkCurrentPin(t){return await d("authStore","checkPin",{payload:{pin_code:t,user_id:b().userInfo.id}})},async changePin(){console.log("this.form.pin",this.form.pin);const{status:t}=await d("authStore","savePin",{payload:{pin_code:this.form.pin}});t==200?this.showModal=!0:this.errorMessage="เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้ง"},addPin(t){this.pin.length<6&&(this.pin+=t.toString(),this.pins[this.pin.length-1].active=!0)},removePin(){this.pin.length>0&&(this.pin=this.pin.slice(0,-1),this.pins[this.pin.length].active=!1)},logout(){localStorage.removeItem("activeUser"),localStorage.removeItem("AuthStore"),localStorage.removeItem("GeneralStore"),this.$router.push("/")}}},I={class:"bg-red-200"},S={class:"flex justify-between flex-col con_pin"},N={class:"basis-1/2 flex flex-col justify-center items-center"},B={key:0,class:"text-center"},F={key:1,class:"text-center"},V={key:2,class:"text-center"},E={class:"flex justify-center mt-8"},T={class:"flex justify-between w-[200px]"},A=["onClick"],D={key:0,class:"w-[20px] h-[18px] border border-solid border-gray-900 rounded-full bg-gray-900"},z={class:"basis-1/2 bg-white rounded-t-xl w-full pb-14"},G={class:"flex justify-center flex-wrap p-12 text-black-500"},L=["onClick"],O=e("div",{class:"basis-1/3 flex items-center justify-center"},[e("div",{class:"flex items-center rounded-full justify-center w-[70px] h-[70px] text-2xl"})],-1),R={class:"basis-1/3 flex items-center justify-center"},U={class:"basis-1/3 flex items-center justify-center gap-3"},q={class:"text-center text-red-500 h-[20px]"},H={key:0},J={class:"h-36 flex items-center justify-center"},K={class:"text-center flex flex-row flex-wrap justify-center"},Q={class:"basis-full flex justify-center mb-5"},W=e("h4",{class:"text-lg text-slate-900"},[j(" ตั้งรหัส PIN Application "),e("span",{class:"text-green-500"},"สำเร็จ")],-1),X={class:"flex justify-center"};function Y(t,r,Z,$,i,c){const f=h("Icon"),_=h("Button"),v=h("Modal");return s(),n("div",I,[e("div",S,[e("div",N,[i.step==0?(s(),n("div",B,"กรอกรหัส PIN ปัจจุบัน")):l("",!0),i.step==1?(s(),n("div",F,"สร้างรหัส PIN ใหม่")):l("",!0),i.step==2?(s(),n("div",V,"ยืนยันรหัส PIN ใหม่")):l("",!0),e("div",E,[e("div",T,[(s(!0),n(u,null,m(i.pins,(o,a)=>(s(),n("div",{key:a,class:"flex justify-center items-center w-[20px] h-[20px] border border-solid border-gray-300 rounded-full",onClick:ee=>o.active=!o.active},[i.pin.length>a?(s(),n("div",D)):l("",!0)],8,A))),128))])])]),e("div",z,[e("div",G,[(s(),n(u,null,m(9,o=>e("div",{key:o,class:"basis-1/3 flex items-center justify-center mb-4"},[e("button",{onClick:a=>c.addPin(o),class:"flex items-center rounded-full justify-center w-[70px] h-[70px] text-2xl border border-solid border-gray-300"},x(o),9,L)])),64)),O,e("div",R,[e("button",{onClick:r[0]||(r[0]=o=>c.addPin(0)),class:"flex items-center rounded-full justify-center w-[70px] h-[70px] text-2xl border border-solid border-gray-300"}," 0 ")]),e("div",U,[e("button",{onClick:r[1]||(r[1]=o=>c.removePin()),class:"flex items-center justify-center w-[70px] h-[70px]"},[p(f,{class:"text-4xl text-gray-500",icon:"cil:delete"})])])]),e("div",q,[i.errorMessage?(s(),n("p",H,x(i.errorMessage),1)):l("",!0)]),i.step==0?(s(),n("div",{key:0,class:"text-center text-black-500 pb-14 pt-8",onClick:r[2]||(r[2]=o=>t.$router.push("/change-pin"))}," ลืมรหัส PIN ")):l("",!0)])]),i.showModal?(s(),M(v,{key:0,title:"",activeModal:i.showModal,"onEvent:closeModal":c.logout,label:"",labelClass:"btn-outline-dark",sizeClass:"w-full",centered:""},{default:P(()=>[e("div",J,[e("div",K,[e("div",Q,[p(f,{icon:"icon-park-solid:protect",class:"text-5xl text-green-500"})]),W])]),e("div",X,[e("div",null,[p(_,{text:"ไปหน้าโปรไฟล์",btnClass:"btn-primary w-32 font-medium mx-2",onOnClick:r[3]||(r[3]=o=>t.$router.back())})])])]),_:1},8,["activeModal","onEvent:closeModal"])):l("",!0)])}const ue=g(C,[["render",Y]]);export{ue as default};
